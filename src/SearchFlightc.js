import React, { useEffect, useState, useRef } from 'react';
import axios from 'axios';
import { Link, useLocation, useNavigate } from 'react-router-dom';
import { parseString } from 'xml2js';
import { Nav, Modal, Button } from 'react-bootstrap';
import './styles.css';
import CryptoJS from 'crypto-js';
import DatePicker from 'react-datepicker';
import 'react-datepicker/dist/react-datepicker.css';
import { format, parse, parseISO, isValid } from 'date-fns';
import Slider from 'rc-slider';
import "rc-slider/assets/index.css";
import Swal from 'sweetalert2';
import Cookies from 'js-cookie';
import '@fortawesome/fontawesome-free/css/all.min.css';
import CONFIG from "./config";

const FlightInfoOrigin = ({ origin, onFlightOriginChange }) => {
  useEffect(() => {
    const newOrigin = origin;
    onFlightOriginChange(newOrigin);
  }, []);
  return <span>{origin}</span>;
};


const FlightInfoDestination = ({ Destination, onFlightDestinationChange }) => {
  useEffect(() => {
    const newDestination = Destination;
    onFlightDestinationChange(newDestination);
  }, []);
  return <span>{Destination}</span>;
};

const FlightInfoDepartureDate = ({ DepartureDate, onFlightDepartureDateChange }) => {
  useEffect(() => {
    const newDepartureDate = DepartureDate;
    onFlightDepartureDateChange(newDepartureDate);
  }, []);
  return <span>{DepartureDate}</span>;
};


const SearchFlight = () => {
  const [loadingg, setLoadingg] = useState(false);
  const [loading, setLoading] = useState(true);
  const location = useLocation();
  const [formtaxivaxi, setFormtaxivaxi] = useState([]);
  let storedFormData = sessionStorage.getItem('formtaxivaxiData');
  useEffect(() => {
    if (storedFormData) {
      let formtaxivaxiData1 = JSON.parse(storedFormData);
      setFormtaxivaxi(formtaxivaxiData1);

    }
  }, []);


  const [flightorigins, setflightOrigin] = useState('');
  const [flightdestinations, setflightDestination] = useState('');
  const [flightDepartureDates, setflightDepartureDate] = useState('');
  const [show, setShow] = useState(false);
  const [flightOptions, setFlightOptions] = useState([]);
  const [BrandList, setBrandlist] = useState([]);
  // console.log('flightOptions', flightOptions);
  const [flightairoption, setFlightAirOptions] = useState([]);
  const [flightairoptionarray, setFlightAirOptionsArray] = useState([]);
  // console.log('flightairoptionarray', flightairoptionarray);
  const [flightDetails, setFlightDetails] = useState([]);
  const [actualFlightDetails, setActualFlightDetails] = useState([]);
  
  const [flightErrors, setFlighterrors] = useState([]);
  const [Passengerarray, setPassengerkeys] = useState([]);
  const [Passengerxml, setPassengerxml] = useState([]);
  const [SegmentList, setSegment] = useState([]);
  const [HostList, setHostlist] = useState([]);
  const [FareList, setFarelist] = useState([]);
  const [TaxList, setTaxlist] = useState([]);
  const [htmlContent, setHtmlContent] = useState("");
  const [showModal, setShowModal] = useState(false);
  const [newpayload, setPayload] = useState("");
  const contentRef = useRef(null);
  const Targetbranch = 'P4451438';
  // console.log('TaxList', TaxList);

  const getFareDetails = (brandName) => {
    setFareInfoDetails(null);
    if (!BrandList || BrandList.length === 0) return ['NA'];

    let fareDetails = [];

    BrandList.forEach((brand) => {
      if (brand['$']?.Name === brandName) {
        brand['air:Text'].forEach((text) => {

          fareDetails.push(text['_']);
        });
      }
    });
    // console.log('fareDetails', fareDetails);
    // setFareInfoDetails(fareDetails);
    setFareInfoDetails(fareDetails.length > 0 ? fareDetails : null);
    setVisibleDetails(true);

    // return fareDetails.length > 0 ? fareDetails : ['NA'];
  };

  const [Airlines, setAirlineOptions] = useState([]);
  const [Airports, setAirportOptions] = useState([]);

  const handleFlightOriginChange = (newOrigin) => {
    setflightOrigin(newOrigin);
  };

  const handleFlightDestinationChange = (newDestination) => {
    setflightDestination(newDestination);
  };

  const handleFlightDepartureDateChange = (newDepartureDate) => {
    setflightDepartureDate(newDepartureDate);
  };
  // let dataFound = false;


  const [airlines, setAirlines] = useState(location.state?.responseData?.airlinedata || null);
  // console.log('airlines', airlines);
  useEffect(() => {
    if (!airlines) {
      const fetchAirlines = async () => {
        setLoading(true);

        try {
          const airlineRequest = `<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:util="http://www.travelport.com/schema/util_v50_0" xmlns:com="http://www.travelport.com/schema/common_v50_0">
              <soapenv:Header/>
              <soapenv:Body>
                  <util:ReferenceDataRetrieveReq AuthorizedBy="TAXIVAXI" TargetBranch="${Targetbranch}" TraceId="AR45JHJ" TypeCode="AirAndRailSupplierType">
                      <com:BillingPointOfSaleInfo OriginApplication="UAPI"/>
                      <util:ReferenceDataSearchModifiers MaxResults="99999" StartFromResult="0"/>
                  </util:ReferenceDataRetrieveReq>
              </soapenv:Body>
          </soapenv:Envelope>`;

          const response = await axios.post(
            `${CONFIG.DEV_API}/reactSelfBookingApi/v1/makeFlightRequest`,
            airlineRequest,
            { headers: { "Content-Type": "text/xml" } }
          );

          setAirlines(response.data); // Update airlines after API response
        } catch (error) {
          console.error("Error fetching airlines:", error);
        } finally {
          setLoading(false);
        }
      };

      fetchAirlines();
    }
  }, []); // âœ… Runs only on mount

  // Wait for airlines data and parse it
  useEffect(() => {
    if (airlines) {
      parseString(airlines, { explicitArray: false }, (errs, airlineresult) => {
        if (errs) {
          console.error("Error parsing XML:", errs);
          return;
        }
        const airlinelist = airlineresult["SOAP:Envelope"]["SOAP:Body"]["util:ReferenceDataRetrieveRsp"]["util:ReferenceDataItem"];
        setAirlineOptions(airlinelist);
      });
    }
  }, [airlines]);

  const [airports, setAirports] = useState(location.state?.responseData?.airportData || null);
  useEffect(() => {
    if (!airports) {
      const fetchAirports = async () => {
        setLoading(true);
        try {
          const airportRequest = `<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:util="http://www.travelport.com/schema/util_v50_0" xmlns:com="http://www.travelport.com/schema/common_v50_0">
            <soapenv:Header/>
            <soapenv:Body>
              <util:ReferenceDataRetrieveReq AuthorizedBy="TAXIVAXI" TargetBranch="${Targetbranch}" TraceId="AV145ER" TypeCode="CityAirport">
                <com:BillingPointOfSaleInfo OriginApplication="UAPI"/>
                <util:ReferenceDataSearchModifiers MaxResults="99999" StartFromResult="0"/>
              </util:ReferenceDataRetrieveReq>
            </soapenv:Body>
          </soapenv:Envelope>`;

          const response = await axios.post(
            `${CONFIG.DEV_API}/reactSelfBookingApi/v1/makeFlightRequest`,
            airportRequest,
            { headers: { 'Content-Type': 'text/xml' } }
          );

          setAirports(response.data);
        } catch (error) {
          console.error("Error fetching airports:", error);
        } finally {
          setLoading(false);
        }
      };

      fetchAirports();
    }
  }, [airports]);

  useEffect(() => {
    if (airports) {
      parseString(airports, { explicitArray: false }, (errs, airportresult) => {
        if (errs) {
          console.error('Error parsing XML:', errs);
          return;
        }
        const airportlist = airportresult['SOAP:Envelope']['SOAP:Body']['util:ReferenceDataRetrieveRsp']['util:ReferenceDataItem'];
        setAirportOptions(airportlist);

        const tempAirportCodes = {};
        airportlist.forEach((airport) => {
          tempAirportCodes[airport.$.Code] = airport.$.Name;
        });

        setAirportOriginCodes(tempAirportCodes);
        setAllAirportsOrigin(airportlist);
        setAirportDestinationCodes(tempAirportCodes);
        setAllAirportsDestination(airportlist);
      });
    }
  }, [airports]);

  function convertDateFormat(dateStr) {
    const [day, month, year] = dateStr.split("/").map(Number);
    const date = new Date(Date.UTC(year, month - 1, day)); // Create date in UTC
    return `${year}-${String(month).padStart(2, "0")}-${String(day).padStart(2, "0")}T00:00:00.000+05:30`;
  }

  // const airlines = location.state && location.state.responseData.airlinedata;
  const apiairports = location.state && location.state.responseData.apiairportsdata;
  // const airports = location.state && location.state.responseData.airportData;
  const response = location.state && location.state.responseData.responsedata;
  const adult = location.state && location.state.responseData.selectadult;
  const child = location.state && location.state.responseData.selectchild;
  const infant = location.state && location.state.responseData.selectinfant;
  const cabinclass = location.state && location.state.responseData.selectclass;
  const previousdepdate = location.state && location.state.responseData.previousdepdate;
  const universal_locator_code = location.state && location.state.responseData.universal_locator_code;
  // const requesttype = location.state && location.state.responseData?.requesttype;
  // const spocemail = location.state && location.state.responseData?.spocemail;
  // const additionalemail = location.state && location.state.responseData?.additionalemail;
  // const ccmail = location.state && location.state.responseData?.ccmail;
  // const clientname = location.state && location.state.responseData?.clientname;
  // const admin_id = location.state && location.state.responseData?.admin_id;
  // const spocname = location.state && location.state.responseData?.spocname;
  const markupdata = location.state && location.state.responseData?.markupdata;
  // const agent_id = location.state && location.state.responseData?.agent_id;
  const global = location.state && location.state.responseData?.global;

  // console.log('markupdata',markupdata);
  const bookingid = location.state && location.state.responseData?.bookingid;
  // const is_approved = location.state && location.state.responseData?.isapproved;
  const searchdeparturedate = convertDateFormat(location.state && location.state.responseData?.searchdeparture);
  // alert(searchdeparturedate);
  // console.log('searchdeparturedate', searchdeparturedate);
  const searchreturnd = location.state && location.state.responseData?.searchreturnd;
  let no_of_seats = location.state && location.state.responseData?.no_of_seats;
  // const request_id = location.state && location.state.responseData?.request_id;
  // const clientid = location.state && location.state.responseData?.clientid;
  // const is_gst_benefit = location.state && location.state.responseData?.is_gst_benefit;
  const flight_type = location.state && location.state.responseData?.flighttype;
  const access_token = location.state && location.state.responseData?.accessToken;

  const adultCounts = parseInt(adult, 10) || 0;
  const childCounts = parseInt(child, 10) || 0;
  const infantCounts = parseInt(infant, 10) || 0;
  const [adultCount, setAdultCount] = useState(adultCounts);
  const [childCount, setChildCount] = useState(childCounts);
  const [infantCount, setInfantCount] = useState(infantCounts);

  if (no_of_seats === '' || no_of_seats === 'NULL' || no_of_seats === 'undefined' || no_of_seats == null) {
    no_of_seats = adultCount + childCount + infantCount;
  }

  const request = location.state?.responseData || {};
  const [SearchFinalResponse, setSearchFinalResponse] = useState(response);
  const [isOpen, setIsOpen] = useState(false);
  const [isdepOpen, setdepIsOpen] = useState(false);
  const [isretOpen, setretIsOpen] = useState(false);

  const [cabinClass, setCabinClass] = useState(cabinclass);
  const [inputOrigin, setInputOrigin] = useState(request.searchfromcity);
  const [showOriginDropdown, setShowOriginDropdown] = useState(false);

  const [ismodify, setismodify] = useState(true);
  const [origin, setOrigin] = useState([]);
  const [allAirportsOrigin, setAllAirportsOrigin] = useState([]);
  const [airportOriginCodes, setAirportOriginCodes] = useState(null);

  const [inputDestination, setInputDestination] = useState(request.searchtocity);
  const [showDestinationDropdown, setShowDestinationDropdown] = useState(false);
  const [destination, setDestination] = useState([]);
  const [allAirportsDestination, setAllAirportsDestination] = useState([]);
  const [airportDestinationCodes, setAirportDestinationCodes] = useState(null);
  const [lastActionWasSwap, setLastActionWasSwap] = useState(false);
  const [pricesegment, setpricesegment] = useState([]);
  const [loadingIndex, setLoadingIndex] = useState(null);
  const [fareInfoRefsState, setFareInfoRefsState] = useState([]);
  // console.log('fareInfoRefsState', fareInfoRefsState);
  const [allSegmentKeys, setAllSegmentKeys] = useState([]);
  const [isbookingpage, setBookingpage] = useState(false);

  const taxesRef = useRef(null);
  // console.log('taxesRef', taxesRef);

  const handleSegmentKeyMatch = (segmentKey) => {
    console.log('segmentKey', segmentKey);
    setFareInfoRefsState([]);
    const segmentKeys = Array.isArray(segmentKey) ? segmentKey : [segmentKey];
    const matchedBookingInfo = flightairoptionarray.filter((option) => {
      const bookingInfos = option["air:BookingInfo"];
      const normalizedBookingInfos = Array.isArray(bookingInfos) ? bookingInfos : [bookingInfos];
  
      // Must match length
      if (normalizedBookingInfos.length !== segmentKeys.length) return false;
  
      const segmentRefsInOption = normalizedBookingInfos.map(
        (b) => b?.["$"]?.SegmentRef
      );
  
      // Must contain exactly the same SegmentRefs as the segmentKeys (unordered match)
      const isExactMatch =
        segmentRefsInOption.every((ref) => segmentKeys.includes(ref)) &&
        segmentKeys.every((ref) => segmentRefsInOption.includes(ref));
  
      return isExactMatch;
    });
    // console.log('matchedBookingInfo', matchedBookingInfo);
    const firstBookingInfos = matchedBookingInfo.map((item) => {
      const bookingInfos = item["air:BookingInfo"];
      const normalizedBookingInfos = Array.isArray(bookingInfos) ? bookingInfos : [bookingInfos];
      return normalizedBookingInfos[0]?.["$"] || {}; // Flatten the $
    });
    setFareInfoRefsState([...firstBookingInfos]);
  };
  // console.log('hello');

  

  const handleScrollToTop = () => {
    window.scrollTo({
      top: 0,
      behavior: 'smooth'
    });
  };

  const calculateFinalPrice = (totalPrice, markup, seatType, fareName, airline, flighttype) => {
    // console.log('totalPrice', totalPrice);
    // Ensure totalPrice is numeric for calculations
    // const numericPrice = parseFloat(totalPrice.replace("INR", "").trim());
    const numericPrice = String(totalPrice).includes("INR")
      ? parseFloat(totalPrice.replace("INR", "").trim())
      : parseFloat(totalPrice);

    if (!Array.isArray(markup) || markup.length === 0) {
      return numericPrice; // Return the original price if no markup exists
    }

    const { markup_value, markup_type } = markup[0]; // Extract the first markup object

    // Calculate the final price based on markup type
    const markupValue = parseFloat(markup_value);

    if (markup_type === "Fixed") {
      return numericPrice + markupValue; // Add fixed value
    } else if (markup_type === "Percentage") {
      return numericPrice + (numericPrice * markupValue) / 100; // Add percentage markup
    }

    // console.log('numericPrice', numericPrice);
    return numericPrice


  };
  const calculateFinalMarkup = (totalPrice, markup) => {
    // Parse markup if it's a JSON string
    console.log('totalPrice for markup', totalPrice)

    const numericPrice = String(totalPrice).includes("INR")
      ? parseFloat(totalPrice.replace("INR", "").trim())
      : parseFloat(totalPrice);

    if (!Array.isArray(markup) || markup.length === 0) {
      return 0; // No markup available
    }

    const { markup_value, markup_type } = markup[0]; // Extract the first markup object
    const markupValue = parseFloat(markup_value);

    if (markup_type === "Fixed") {
      return markupValue; // Return fixed markup
    } else if (markup_type === "Percentage") {
      return (numericPrice * markupValue) / 100; // Return calculated percentage markup
    }

    return 0; // Default to 0 if no valid markup type
  };

  const swapOriginAndDestination = () => {
    if (lastActionWasSwap) {
      setInputOrigin(inputDestination);
      setInputDestination(inputOrigin);
    } else {
      const temp = inputOrigin;
      setInputOrigin(inputDestination);
      setInputDestination(temp);
    }
    setismodify(false);
    setLastActionWasSwap(!lastActionWasSwap);
  };

  useEffect(() => {
    console.log('hello');
    if (SearchFinalResponse) {
      parseString(SearchFinalResponse, { explicitArray: false }, (err, result) => {
        if (err) {
          console.error('Error parsing XML:', err);
          return;
        }
        const lowFareSearchRsp = result['SOAP:Envelope']['SOAP:Body']['air:LowFareSearchRsp'];
        if (lowFareSearchRsp !== null && lowFareSearchRsp !== undefined) {
          const pricepointlist = result['SOAP:Envelope']['SOAP:Body']['air:LowFareSearchRsp']['air:AirPricePointList']['air:AirPricePoint'];
          // console.log('pricepointlist', pricepointlist);

          const extractedBookingInfo = [];
          const extractedTaxInfo = [];
          const extractedOptionsArray = []; // <-- This is what you're asking for

          const pricepointlistArray = Array.isArray(pricepointlist) ? pricepointlist : [pricepointlist];

          // Iterate through the AirPricePoint list
          pricepointlistArray.forEach((airPricePoint) => {
            const airPricingInfo = airPricePoint['air:AirPricingInfo'];
            if (!airPricingInfo) return;

            // Tax Info extraction
            const taxInfoList = airPricingInfo['air:TaxInfo'];
            const taxInfoArray = Array.isArray(taxInfoList) ? taxInfoList : taxInfoList ? [taxInfoList] : [];

            taxInfoArray.forEach((taxInfo) => {
              if (taxInfo?.["$"]?.SupplierCode === "6E") {
                extractedTaxInfo.push(taxInfo["$"]);
              }
            });

            const flightOptionsList = airPricingInfo['air:FlightOptionsList'];
            if (!flightOptionsList) return;

            const flightOptions = flightOptionsList['air:FlightOption'];
            const flightOptionArray = Array.isArray(flightOptions) ? flightOptions : [flightOptions];

            flightOptionArray.forEach((flightOption) => {
              const options = flightOption['air:Option'];
              const optionsArray = Array.isArray(options) ? options : [options];

              optionsArray.forEach((airOption) => {
                const bookingInfo = airOption['air:BookingInfo'];
                const bookingInfoArray = Array.isArray(bookingInfo) ? bookingInfo : [bookingInfo];

                bookingInfoArray.forEach((info) => {
                  if (info && info["$"]) {
                    extractedBookingInfo.push(info["$"]);
                  }
                });

                // ðŸ’¡ Push only the 'air:BookingInfo' for each option (no '$' field)
                extractedOptionsArray.push({
                  "air:BookingInfo": Array.isArray(airOption["air:BookingInfo"])
                    ? airOption["air:BookingInfo"]
                    : [airOption["air:BookingInfo"]]
                });
              });
            });
          });


          // console.log("extractedOptionsArray:", extractedOptionsArray);
          setFlightAirOptionsArray(extractedOptionsArray)
          const Segmentlist = result['SOAP:Envelope']['SOAP:Body']['air:LowFareSearchRsp']['air:AirSegmentList']['air:AirSegment'];
          const flightdetailist = result['SOAP:Envelope']['SOAP:Body']['air:LowFareSearchRsp']['air:FlightDetailsList']['air:FlightDetails'];
          const hosttokenlist = result?.['SOAP:Envelope']?.['SOAP:Body']?.['air:LowFareSearchRsp']?.['air:HostTokenList']?.['common_v52_0:HostToken'] || [];
          const fareinfolist = result['SOAP:Envelope']['SOAP:Body']['air:LowFareSearchRsp']['air:FareInfoList']['air:FareInfo'];
          const brandlist = result['SOAP:Envelope']['SOAP:Body']['air:LowFareSearchRsp']['air:BrandList']['air:Brand'];
          setFlightOptions(Array.isArray(pricepointlist) ? pricepointlist : [pricepointlist]);
          setFlightAirOptions(Array.isArray(extractedBookingInfo) ? extractedBookingInfo : [extractedBookingInfo]);
          setBrandlist(Array.isArray(brandlist) ? brandlist : [brandlist]);
          setFlightDetails(Array.isArray(flightdetailist) ? flightdetailist : [flightdetailist]);
          setActualFlightDetails(Array.isArray(flightdetailist) ? flightdetailist : [flightdetailist]);
          setSegment(Array.isArray(Segmentlist) ? Segmentlist : [Segmentlist]);
          setHostlist(Array.isArray(hosttokenlist) ? hosttokenlist : [hosttokenlist]);
          setFarelist(Array.isArray(fareinfolist) ? fareinfolist : [fareinfolist]);
          setTaxlist(Array.isArray(extractedTaxInfo) ? extractedTaxInfo : [extractedTaxInfo]);

        } else {
          const error = result['SOAP:Envelope']['SOAP:Body']['SOAP:Fault']['faultstring'];

          setFlighterrors(error);

        }


      });
    }
  }, []);

  const [priceParse, setpriceparse] = useState(null);
  // console.log('priceparse', priceParse);
  const [minvalue, setMinvalue] = useState(0);
  const [maxvalue, setMaxvalue] = useState(10000000);

  useEffect(() => {
    const totalPriceValues = flightOptions.map((item) => {
      const totalPrice = parseFloat(item.$.TotalPrice.replace(/[^\d.]/g, ''));
      return !isNaN(totalPrice) ? totalPrice : 0;
    });
    const validTotalPriceValues = totalPriceValues.filter(value => !isNaN(value));
    const minprice = Math.min(...validTotalPriceValues);
    const maxprice = Math.max(...validTotalPriceValues);
    setMinvalue(minprice);
    setMaxvalue(maxprice);
  }, [flightOptions]);

  const [priceRange, setPriceRange] = useState([minvalue, maxvalue]);

  const handlePriceChange = (value) => {
    setPriceRange(value);
  };

  const handleweekdatemonthyear = (date) => {
    const arrivalTime = new Date(date);
    const weekdays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

    const weekday = weekdays[arrivalTime.getDay()];
    const day = arrivalTime.getDate();
    const month = months[arrivalTime.getMonth()];
    const year = arrivalTime.getFullYear();

    const formattedDateString = `${weekday}, ${day} ${month} ${year}`;
    return formattedDateString;
  }

  const handleflyghtHeadInfoDate = (date) => {
    const arrivalTime = new Date(date);
    const weekdays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
    const weekday = weekdays[arrivalTime.getDay()];
    const day = arrivalTime.getDate();
    const month = months[arrivalTime.getMonth()];
    const formattedDateString = `${weekday}, ${day} ${month}`;

    return formattedDateString;
  }
  const handledatemonth = (date) => {
    const arrivalTime = new Date(date);
    const weekdays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
    const weekday = weekdays[arrivalTime.getDay()];
    const day = arrivalTime.getDate();
    const month = months[arrivalTime.getMonth()];
    const formattedDateString = `${day} ${month}`;

    return formattedDateString;
  }
  const handledatemonthsplit = (date) => {
    const dateParts = date;
    const day = parseInt(dateParts[0]);
    const monthIndex = parseInt(dateParts[1]) - 1;
    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
    const month = months[monthIndex];
    const data = `${day} ${month}`;
    return data;
  }

  const [selectedAirlines, setSelectedAirlines] = useState([]);
  // console.log('selectedairline', selectedAirlines);
  const [selectedreturnAirlines, setreturnSelectedAirlines] = useState([]);
  const [selectedStops, setSelectedStops] = useState([]);
  const [selectedreturnStops, setreturnSelectedStops] = useState([]);
  const [selectedTimeRange, setSelectedTimeRange] = useState([]);
  // console.log('selectedTimeRange', selectedTimeRange);
  const [selectedTimeRanges, setSelectedTimeRanges] = useState([]);
  // console.log('selectedTimeRanges', selectedTimeRanges);


  const handleTimeRangeClick = (timeRange) => {
    setSelectedTimeRange((prevSelectedRanges) =>
      prevSelectedRanges.includes(timeRange)
        ? prevSelectedRanges.filter((range) => range !== timeRange) // Remove if already selected
        : [...prevSelectedRanges, timeRange] // Add if not selected
    );
  };

  const handleTimeRangeClicks = (timeRange) => {
    setSelectedTimeRanges((prevSelectedRanges) =>
      prevSelectedRanges.includes(timeRange)
        ? prevSelectedRanges.filter((range) => range !== timeRange) // Remove if already selected
        : [...prevSelectedRanges, timeRange] // Add if not selected
    );
  };

  const handleAirlineCheckboxChange = (airline) => {
    if (selectedAirlines.includes(airline)) {
      setSelectedAirlines(selectedAirlines.filter((selected) => selected !== airline));
    } else {
      setSelectedAirlines([...selectedAirlines, airline]);
    }
  };

  const handlereturnAirlineCheckboxChange = (airline) => {
    if (selectedreturnAirlines.includes(airline)) {
      setreturnSelectedAirlines(selectedreturnAirlines.filter((selected) => selected !== airline));
    } else {
      setreturnSelectedAirlines([...selectedreturnAirlines, airline]);
    }
  };

  const handleStopCheckboxChange = (stops) => {
    setSelectedStops((prevStops) =>
      prevStops.includes(stops)
        ? prevStops.filter((selected) => selected !== stops) // Remove if already selected
        : [...prevStops, stops] // Add if not selected
    );
  };

  const handlereturnStopCheckboxChange = (stops) => {
    if (selectedreturnStops.includes(stops)) {
      setreturnSelectedStops(selectedreturnStops.filter((selected) => selected !== stops));
    } else {
      setreturnSelectedStops([...selectedreturnStops, stops]);
    }
  };


  const [sortingCriterion, setSortingCriterion] = useState('1'); // Track the sorting criterion
  const [sortDirection, setSortDirection] = useState('asc'); // Track the sorting direction ('asc' or 'desc')

  const handleSortingCriterionClick = (criteria) => {
    if (sortingCriterion === criteria) {
      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');
    } else {
      setSortingCriterion(criteria);
      setSortDirection('asc');
    }
  };

  const calculateTravelTime = (traveltimes) => {
    // console.log('traveltimes', traveltimes);
    const days = traveltimes.match(/(\d+)DT/) ? parseInt(traveltimes.match(/(\d+)DT/)[1]) : 0;
    const hours = traveltimes.match(/(\d+)H/) ? parseInt(traveltimes.match(/(\d+)H/)[1]) : 0;
    const minutes = traveltimes.match(/(\d+)M/) ? parseInt(traveltimes.match(/(\d+)M/)[1]) : 0;

    return days * 24 * 60 + hours * 60 + minutes;
  }

  function convertMinutesToHours(minutes) {
    const hours = Math.floor(minutes / 60); // Get the whole hours
    const remainingMinutes = minutes % 60; // Get the remaining minutes
    return `${hours} hrs ${remainingMinutes} mins`;
  }

  const calculateTravellingTime = (traveltimes) => {
    const days = traveltimes.match(/(\d+)DT/) ? parseInt(traveltimes.match(/(\d+)DT/)[1]) : 0;
    const hours = traveltimes.match(/(\d+)H/) ? parseInt(traveltimes.match(/(\d+)H/)[1]) : 0;
    const minutes = traveltimes.match(/(\d+)M/) ? parseInt(traveltimes.match(/(\d+)M/)[1]) : 0;
    const finaltime = `${days}D ${hours}H ${minutes}M`;
    return finaltime;
  }

  const formatISODuration = (duration) => {
    if (!duration) return "00:00:00";

    // Match the components in the ISO 8601 duration
    const daysMatch = duration.match(/P(\d+)D/);
    const hoursMatch = duration.match(/T(\d+)H/);
    const minutesMatch = duration.match(/T\d+H(\d+)M/);
    const secondsMatch = duration.match(/T\d+H\d+M(\d+)S/);

    const days = daysMatch ? parseInt(daysMatch[1], 10) : 0;
    const hours = hoursMatch ? parseInt(hoursMatch[1], 10) : 0;
    const minutes = minutesMatch ? parseInt(minutesMatch[1], 10) : 0;
    const seconds = secondsMatch ? parseInt(secondsMatch[1], 10) : 0;

    // Convert days to hours and add to total hours
    const totalHours = days * 24 + hours;

    // Format as HH:MM:SS
    return `${String(totalHours).padStart(2, "0")}:${String(minutes).padStart(2, "0")}:${String(seconds).padStart(2, "0")}`;
  };

  const calculateDepartureTime = (depareturetimes) => {
    const date = new Date(depareturetimes);
    const hours = String(date.getHours()).padStart(2, '0');
    const minutes = String(date.getMinutes()).padStart(2, '0');
    return `${hours}:${minutes}`;
  }

  const handleClasstype = (value) => {
    setismodify(false);
    setCabinClass(value);
    setFormData({ ...formData, classType: value });
  };

  const handleAdult = (value) => {
    setismodify(false);
    setAdultCount(value);
    setFormData({ ...formData, adult: value });
  };

  const handleChild = (value) => {
    setismodify(false);
    setChildCount(value);
    setFormData({ ...formData, child: value });
  };

  const handleInfant = (value) => {
    setismodify(false);
    setInfantCount(value);
    setFormData({ ...formData, infant: value });
    const infanterror = document.querySelector('.infantmore');
    if (value > adultCount) {
      infanterror.style.display = 'block';
    } else {
      infanterror.style.display = 'none';
    }
  };

  const handleToggle = () => {
    setIsOpen(prevIsOpen => !prevIsOpen);
  };

  const [activeTab, setActiveTab] = useState([]);

  useEffect(() => {
    const updatedTabs = flightOptions.map((pricepoint, priceindex) => `Flight_Detail${priceindex}`);
    setActiveTab(updatedTabs);
  }, [flightOptions]);


  const handleAirline = (carrier) => {
    const airline = Airlines.find((airlineInfo) => {
      return airlineInfo['$'] && airlineInfo['$']['Code'] === carrier;
    });
    if (airline) {
      return airline['$']['Description'];
    } else {
      return "Airline";
    }
  }

  const handleApiAirport = (airportcode) => {
    if (apiairports) {
      const airportapi = apiairports.find((apiairportsInfo) => {
        return apiairportsInfo && apiairportsInfo['airport_iata_code'] === airportcode;
      });
      if (airportapi) {
        return (airportapi['airport_name']);
      } else {
        return "";
      }
    }

  }

  const handleAirport = (airportcode) => {
    const airport = Airports.find((airportInfo) => {
      return airportInfo['$'] && airportInfo['$']['Code'] === airportcode;
    });
    if (airport) {
      return airport['$']['Name'];
    } else {
      return "Airport";
    }
  }

  const [visibleFlightIndex, setVisibleFlightIndex] = useState(null);

  // const handleFlightDetails = (index) => {
  //   setVisibleFlightIndex(index === visibleFlightIndex ? null : index);
  // };
  const handleFlightDetails = (index) => {
    if (index === visibleFlightIndex) {
      setVisibleFlightIndex(null);
    } else {
      setVisibleFlightIndex(index);
      setActiveTab(`Flight_Detail${index}`); // Reset the active tab to the first tab for the selected flight
    }
  };

  const [segmentpriceParse, setsegmentpriceparse] = useState(null);
  const [isDropdownVisible, setIsDropdownVisible] = useState(false);
  const [terminals, setTerminals] = useState([])

 

  const navigate = useNavigate();

  const [selectedPriceParseIndices, setSelectedPriceParseIndices] = useState([]);
  const togglePriceIndex = (priceParseindex) => {
    setSelectedPriceParseIndices((prevIndices) => {
      if (prevIndices.includes(priceParseindex)) {
        // Remove the index if already selected
        return prevIndices.filter((index) => index !== priceParseindex);
      } else {
        // Add the index if not selected
        return [...prevIndices, priceParseindex];
      }
    });
  };

  const [selectedFlightss, setSelectedFlightss] = useState([]); // Use state for the selected flights

  
  const handleselectedContinue = (selectedprice) => {
    setLoading(true);
    setBookingpage(true);

    const Priceinginfoselected = priceParse[selectedprice];
    const fareInfoRefKey = Priceinginfoselected['air:AirPricingInfo']['air:FareInfo']['air:FareRuleKey']
    sessionStorage.setItem('packageselectedPrice', Priceinginfoselected['$']['TotalPrice']);
    sessionStorage.setItem('formdata_bookingtype', formData.bookingType);
    const airPricingInfo = priceParse[selectedprice]['air:AirPricingInfo'];

    const combinedArray = [];
    if (Array.isArray(airPricingInfo)) {
      if (Array.isArray(airPricingInfo[0]['air:BookingInfo'])) {
        airPricingInfo[0]['air:BookingInfo'].forEach(bookinginfo => {
          combinedArray.push({
            segmentRef: bookinginfo['$']['SegmentRef'],
            hostTokenRef: bookinginfo['$']['HostTokenRef']
          });
        });
      } else {
        combinedArray.push({
          segmentRef: airPricingInfo[0]['air:BookingInfo']['$']['SegmentRef'],
          hostTokenRef: airPricingInfo[0]['air:BookingInfo']['$']['HostTokenRef']
        });
      }
    } else {
      if (Array.isArray(airPricingInfo['air:BookingInfo'])) {
        airPricingInfo['air:BookingInfo'].forEach(bookinginfo => {
          combinedArray.push({
            segmentRef: bookinginfo['$']['SegmentRef'],
            hostTokenRef: bookinginfo['$']['HostTokenRef']
          });
        });
      } else {
        combinedArray.push({
          segmentRef: airPricingInfo['air:BookingInfo']['$']['SegmentRef'],
          hostTokenRef: airPricingInfo['air:BookingInfo']['$']['HostTokenRef']
        });
      }
    }

    const HostToken = priceParse[selectedprice]['common_v52_0:HostToken'];

    const SegmentParse = segmentpriceParse;
    // console.log('HostToken',HostToken);
    console.log('SegmentParse',SegmentParse);
    let finaldeparturedate = '';
    let finalreturndate = '';
    let finalarrivaldate = '';

    if (formData.bookingType === "Return") {
      SegmentParse.map((segmentInfo, segmentindex) => {

        if (segmentindex === 0) {
          finaldeparturedate = segmentInfo['$']['DepartureTime'];
        }
        if (segmentInfo['$']['Group'] === '1') {
          finalreturndate = segmentInfo['$']['DepartureTime'];
          return true;
        }
        return false;
      });
    } else {
      SegmentParse.map((segmentInfo, segmentindex) => {

        if (segmentindex === 0) {
          finaldeparturedate = segmentInfo['$']['DepartureTime'];
          finalarrivaldate = segmentInfo['$']['ArrivalTime'];
        }

      });
    }

    for (let i = 0; i < SegmentParse.length; i++) {
      let currentSegment = SegmentParse[i];
      for (let j = i + 1; j < SegmentParse.length; j++) {
        const nextSegment = SegmentParse[j];
        if (currentSegment.$.Group === nextSegment.$.Group) {
          currentSegment['air:Connection'] = "";
          currentSegment = SegmentParse[j];
          break;
        }
      }
    }
    SegmentParse.forEach(segment => {
      const segmentKey = segment['$'].Key;
      const matchedEntry = combinedArray.find(entry => entry.segmentRef === segmentKey);
      if (matchedEntry) {
        segment['$'].HostTokenRef = matchedEntry.hostTokenRef;
      }
    });
    const markup_price = calculateFinalMarkup((parseFloat(priceParse[selectedprice]['$']['TotalPrice'].replace("INR", "").trim())), markupdata);


    const makeServicesRequest = async () => {
      const builder = require('xml2js').Builder;
      var servicerequestXML = new builder().buildObject({
        'soap:Envelope': {
          '$': {
            'xmlns:soap': 'http://schemas.xmlsoap.org/soap/envelope/'
          },
          'soap:Header': {

          },
          'soap:Body': {
            '$': {
              'xmlns:air': 'http://www.travelport.com/schema/air_v52_0',
              'xmlns:com': 'http://www.travelport.com/schema/common_v52_0',
            },
            'air:AirMerchandisingOfferAvailabilityReq': {
              '$': {
                'TargetBranch': Targetbranch,
                'TraceId': 'ac191f0b9c0546659065f29389eae552'
              },
              'com:BillingPointOfSaleInfo': {
                '$': {
                  'OriginApplication': 'UAPI'
                },
              },
              'air:AirSolution': {
                'air:AirSegment': SegmentParse,
                'com:HostToken': HostToken
              },

            }
          }
        }
      });

      try {
        const serviceresponse = await axios.post(
          `${CONFIG.DEV_API}/reactSelfBookingApi/v1/makeFlightAirServiceRequest`, servicerequestXML);
        // const serviceResponse = serviceresponse.data;
        console.log('serviceresponse', serviceresponse.data);
        const serviceData = {
          apiairportsdata: apiairports,
          servicedata: serviceresponse.data,
          SegmentPricelist: SegmentParse,
          packageselected: Priceinginfoselected,
          hostToken: HostToken,
          classtype: formData.classType,
          Passengerarray: Passengerarray,
          searchdeparture: finaldeparturedate,
          searchreturn: finalreturndate,
          searcharrivaldate: finalarrivaldate,
          origin: formData.flightOrigin,
          destination: formData.flightDestination,
          finalorigin: inputOrigin,
          finaldestination: inputDestination,
          bookingtype: formData.bookingType,
          Airports: Airports,
          Airlines: Airlines,
          finalairlines: airlines,
          finalairports: airports,
          searchfinaldeparture: formData.departureDate,
          searchfinalreturn: formData.returnDate,
          adult: formData.adult,
          child: formData.child,
          infant: formData.infant,
          FinalResponse: SearchFinalResponse,
          formtaxivaxi: formtaxivaxi,
          booking_id: bookingid,
          // client_id: clientid,
          // is_gst_benefit: is_gst_benefit,
          accesstoken: access_token,
          fareInfoRefKey: fareInfoRefKey,
          markup_price: markup_price,
          flightDetails: actualFlightDetails,
          segmentArray: SegmentParse

        };
        setLoading(false);
        console.log('servicedata', serviceData);
        navigate('/bookingProcess', { state: { serviceData } });

      } catch (error) {
        console.error(error);
        // ErrorLogger.logError('service_api',servicerequestXML,error);
        navigate('/tryagainlater');
      }
      finally {
        setLoading(false);
      }
    };

    makeServicesRequest();
  };
  const [cancellationPolicy, setCancellationPolicy] = useState(null);

  useEffect(() => {
    const fetchCancellationPolicy = async () => {
      if (cancellationPolicy) return;

      try {
        const response = await axios.get(`${CONFIG.MAIN_API}/api/flights/getCancellationDateChangePolicy`);
        setCancellationPolicy(response.data.data);
      } catch (error) {
        console.error("Error fetching cancellation policy:", error);
      }
    };

    fetchCancellationPolicy();
  }, [cancellationPolicy]);

  function formattedDate(date) {
    const options = {
      weekday: 'short',
      month: 'short',
      day: 'numeric',
      year: 'numeric',
      hour: 'numeric',
      minute: 'numeric',
      second: 'numeric',
      timeZoneName: 'short'
    };
    return date.toLocaleString('en-US', options);
  }

  function isDateFormat(str) {
    const dateRegex = /^\d{2}\/\d{2}\/\d{4}$/;
    return dateRegex.test(str);
  }

  function ddmmyyyyformatDate(date) {
    // alert(date);
    const d = new Date(date);
    const day = String(d.getDate()).padStart(2, '0');
    const month = String(d.getMonth() + 1).padStart(2, '0');
    const year = d.getFullYear();
    return `${day}/${month}/${year}`;
  }

  let depFormattedDate = null;
  let retFormattedDate = null;
  if (isDateFormat(request.searchdeparture)) {
    const [depday, depmonth, depyear] = request.searchdeparture.split('/');
    depFormattedDate = new Date(Date.UTC(parseInt(depyear, 10), parseInt(depmonth, 10) - 1, parseInt(depday, 10)));

    if (request.searchreturnDate) {
      const [retday, retmonth, retyear] = request.searchreturnDate.split('/');
      retFormattedDate = new Date(Date.UTC(parseInt(retyear, 10), parseInt(retmonth, 10) - 1, parseInt(retday, 10)));
    }
  } else {
    depFormattedDate = request.searchdeparture;
    if (request.searchreturnDate) {
      retFormattedDate = request.searchreturnDate;
    }
  }

  const [formData, setFormData] = useState({
    departureDate: depFormattedDate,
    returnDate: retFormattedDate,
    flightOrigin: inputOrigin,
    flightDestination: inputDestination,
    bookingType: request.bookingtype,
    adult: adultCount,
    child: childCount,
    infant: infantCount,
    classType: cabinclass,
  });

  useEffect(() => {
    Cookies.set('cookiesData', JSON.stringify(formData), { expires: 7 });
  }, []);

  const [isReturnEnabled, setReturnEnabled] = useState(true);

  const handleReturnDateInitialization = (bookingType) => {
    if (bookingType === 'oneway') {
      setReturnEnabled(false);
      setFormData({ ...formData, bookingType, returnDate: null });
    } else {
      setReturnEnabled(true);
      const nextDay = new Date();
      if (formData.departureDate) {
        setFormData({ ...formData, bookingType, returnDate: formData.departureDate });
      } else {
        nextDay.setDate(nextDay.getDate() + 1);
        setFormData({ ...formData, bookingType, returnDate: nextDay });
      }
    }
  };

  const getLabelStyle = (labelValue) => {
    if (labelValue === formData.bookingType) {
      return { color: '#fff', backgroundColor: '#785eff' };
    } else {
      return {};
    }
  };

  const handleRadioChange = (e) => {
    setismodify(false);
    const value = e.target.value;
    setFormData({ ...formData, bookingType: value });
    handleReturnDateInitialization(value);
  };

  const handleDepartureDateChange = (date) => {
    setismodify(false);

    // Set a small delay to close the date picker after selecting the date
    setTimeout(() => {
      setdepIsOpen(false); // Close the departure date picker
    }, 0); // 200ms delay for smooth behavior

    if (formData.returnDate) {
      setFormData({ ...formData, departureDate: date, returnDate: date });
    } else {
      setFormData({ ...formData, departureDate: date });
    }
  };

  const handleReturnDateChange = (date) => {
    setismodify(false);

    // Set a small delay to close the return date picker after selecting the date
    setTimeout(() => {
      setretIsOpen(false); // Close the return date picker
    }, 0); // 200ms delay for smooth behavior

    setFormData({
      ...formData,
      returnDate: date,
      bookingType: 'Return',
    });
  };

  const handleOriginChange = (inputValue) => {
    setismodify(false);
    setInputOrigin(inputValue);
    setFormData({ ...formData, flightOrigin: inputValue });
    const filteredOptions = allAirportsOrigin
      .filter((airport) =>
        airport.$.Name.toLowerCase().includes(inputValue.toLowerCase())
      )
      .map((airport) => {
        const matchedAirport = apiairports.find(
          (apiAirport) => apiAirport.airport_iata_code === airport.$.Code
        );
        return {
          value: airport.$.Code,
          label: airport.$.Name,
          airportName: matchedAirport ? matchedAirport.airport_name : '' // Add airport name from apiairports
        };
      })
      .sort((a, b) => a.label.localeCompare(b.label));

    setOrigin(filteredOptions);
    setShowOriginDropdown(true);
  };

  const handleOrigin = (value, airportName) => {
    setInputOrigin(`${airportOriginCodes[value]} (${value}) ${airportName}`);
    setShowOriginDropdown(false);
  };

  const handleDestinationChange = (inputValue) => {
    setismodify(false);
    setInputDestination(inputValue);
    setFormData({ ...formData, flightDestination: inputValue });
    const filteredOptions = allAirportsDestination
      .filter((airport) =>
        airport.$.Name.toLowerCase().includes(inputValue.toLowerCase())
      )
      .map((airport) => {
        const matchedAirport = apiairports.find(
          (apiAirport) => apiAirport.airport_iata_code === airport.$.Code
        );
        return {
          value: airport.$.Code,
          label: airport.$.Name,
          airportName: matchedAirport ? matchedAirport.airport_name : '' // Add airport name from apiairports
        };
      })
      .sort((a, b) => a.label.localeCompare(b.label));

    setDestination(filteredOptions);
    setShowDestinationDropdown(true);
  };

  const handleDestination = (value, airportName) => {
    setInputDestination(`${airportDestinationCodes[value]} (${value}) ${airportName}`);
    setShowDestinationDropdown(false);
  };

  // const handlePriceSubmit = (event, priceindex, taxes) => {
  //   console.log('taxes', taxes);
  // }
  const handlePriceSubmit = (event, priceindex, taxes) => {
      // console.log('taxes', taxes);
      taxesRef.current = null;
      const tax = Math.floor(parseFloat(taxes.replace("INR", "").trim()));
  
      setLoading(true);
      setFareInfoRefsState([]);
      setpriceparse([]);
      setPassengerxml([]);
      setTerminals([]);
  
      event.preventDefault();
      // alert(isDropdownVisible)
      // alert(selectedPriceIndex)
      // alert(ismodify)
      if (isDropdownVisible && selectedPriceIndex === priceindex) {
        // If the dropdown for this priceIndex is already open, close it
        setIsDropdownVisible(false);
        setSelectedPriceIndex(null);
        setLoadingIndex(null);
      } else {
  
        setLoadingIndex(priceindex); // Set the loading index
        // Simulate an async operation
        setTimeout(() => {
          setLoadingIndex(null); // Clear the loading state after the operation
        }, 2000);
  
        if (ismodify) {
          taxesRef.current = tax;
          setLoading(true);
          setIsDropdownVisible(true);
          setSelectedPriceIndex(priceindex);
          const searchData = new FormData(event.target);
          var SearchPriceTotalPrice = event.target.SearchPriceTotalPrice.value;
          sessionStorage.setItem('SearchPriceTotalPrice', SearchPriceTotalPrice);
  
          // console.log('SearchPriceTotalPrice', SearchPriceTotalPrice);
  
          // console.log('segarr', segmentArrayJSON);
          const segmentArray = [];
          const bookingInfoArray = [];
          const totalpassengers = adultCount + childCount + infantCount;
  
          const generateRandomKey = () => {
            const randomBytes = CryptoJS.lib.WordArray.random(16);
            const base64Key = CryptoJS.enc.Base64.stringify(randomBytes);
            return base64Key;
          };
  
          const generatePassengerKeys = (adultCount, childCount, infantCount) => {
            const keys = [];
  
            for (let i = 0; i < adultCount; i++) {
              keys.push({
                Key: generateRandomKey(),
                Code: 'ADT'
              });
            }
  
            for (let i = 0; i < childCount; i++) {
              keys.push({
                Key: generateRandomKey(),
                Code: 'CNN',
                Age: "10"
              });
            }
  
            for (let i = 0; i < infantCount; i++) {
              keys.push({
                Key: generateRandomKey(),
                Code: 'INF',
                Age: "01"
              });
            }
  
            return keys;
          };
  
          const passengerKeys = generatePassengerKeys(adultCount, childCount, infantCount);
          setPassengerkeys(passengerKeys);
          const passengerKeysXml = passengerKeys.map(passenger => ({
            '$': {
              'Key': passenger.Key,
              'Code': passenger.Code,
              'Age': passenger.Age
  
            }
          }));
  
          setPassengerxml(passengerKeysXml);
          var segmentArrayJSON = Array.from(searchData.getAll('Segmentarray[]'));
          console.log('segmentArrayJSON', segmentArrayJSON);
          var BookingInfoJSON = Array.from(searchData.getAll('BookingInfoData[]'));
          const passengerKeysXmlString = JSON.stringify(passengerKeysXml);
          sessionStorage.setItem('passengerKeysXml', passengerKeysXmlString);
          sessionStorage.setItem('classType', formData.classType);
  
          segmentArrayJSON.forEach(jsonString => {
            segmentArray.push(JSON.parse(jsonString));
          });
          let parsedData;
          if (Array.isArray(segmentArrayJSON)) {
            parsedData = segmentArrayJSON;
          } else {
            parsedData = JSON.parse(segmentArrayJSON);
          }
  
          // const flightDetailsRefKey = parsedData["air:FlightDetailsRef"]["$"]["Key"];
          // console.log('flightDetailsRefKey', flightDetailsRefKey);
  
          BookingInfoJSON.forEach(jsonString => {
            bookingInfoArray.push(JSON.parse(jsonString));
          });
  
          const segmentRefs = bookingInfoArray.map(bookingInfo => {
            if (bookingInfo['$'] && bookingInfo['$']['SegmentRef']) {
              return bookingInfo['$']['SegmentRef'];
            }
            return null; // In case SegmentRef is not available
          }).filter(Boolean);
  
          const providerCode = segmentArray.find(segment =>
            segment['$'].ProviderCode || (segment['air:AirAvailInfo'] && segment['air:AirAvailInfo']['$'] && segment['air:AirAvailInfo']['$'].ProviderCode)
          );
  
          const providerCodeValue = providerCode ?
            (providerCode['$'].ProviderCode || providerCode['air:AirAvailInfo']['$'].ProviderCode)
            : null;
  
          // console.log('updatedsegmentar', segmentArray);
  
          if (providerCodeValue === '1G') {
            console.log('hi');
            segmentArray.forEach(segment => {
              if (segment['$']) {
                segment['$'].ProviderCode = '1G';
              }
              delete segment['air:FlightDetailsRef'];
            });
  
  
            for (let i = 0; i < segmentArray.length; i++) {
              let currentSegment = segmentArray[i];
              for (let j = i + 1; j < segmentArray.length; j++) {
                const nextSegment = segmentArray[j];
                if (currentSegment.$.Group === nextSegment.$.Group) {
                  currentSegment['air:Connection'] = "";
                  currentSegment = segmentArray[j];
                  break;
                }
              }
            }
  
            // setpricesegment(segmentArray);
            sessionStorage.setItem('segmentarray', JSON.stringify(parsedData));
            const builder = require('xml2js').Builder;
            var pricepointXMLpc = new builder().buildObject({
              'soap:Envelope': {
                '$': {
                  'xmlns:soap': 'http://schemas.xmlsoap.org/soap/envelope/'
                },
                'soap:Body': {
                  'air:AirPriceReq': {
                    '$': {
                      'AuthorizedBy': 'TAXIVAXI',
                      'TargetBranch': Targetbranch,
                      'FareRuleType': 'short',
                      'TraceId': 'TVSBP001',
                      'xmlns:air': 'http://www.travelport.com/schema/air_v52_0',
                      'xmlns:com': 'http://www.travelport.com/schema/common_v52_0'
                    },
                    'BillingPointOfSaleInfo': {
                      '$': {
                        'OriginApplication': 'UAPI',
                        'xmlns': 'http://www.travelport.com/schema/common_v52_0'
                      },
                    },
                    'air:AirItinerary': {
                      'air:AirSegment': segmentArray
                    },
                    'air:AirPricingModifiers': {
                      '$': {
                        'InventoryRequestType': 'DirectAccess',
                        'ETicketability': 'Yes',
                        'FaresIndicator': "AllFares"
                      },
                      'air:PermittedCabins': {
                        'com:CabinClass': {
                          '$': {
                            'Type': formData.classType,
                          },
                        },
                      },
                      'air:BrandModifiers': {
                        'air:FareFamilyDisplay': {
                          '$': {
                            'ModifierType': 'FareFamily',
                          },
                        },
                      },
                    },
                    'com:SearchPassenger': passengerKeysXml,
                    'air:AirPricingCommand': ''
                  }
                }
              }
            });
            console.log('prc_1g', pricepointXMLpc);
          }
  
          else if (providerCodeValue === 'ACH') {
            const segmentKeys = segmentArray.map((segment) => segment["$"]["Key"]); // Get all segment keys
            setAllSegmentKeys(segmentKeys);
            const key = segmentArray[0]["$"]["Key"];
            handleSegmentKeyMatch(segmentKeys);
            setLoading(false);
            return;
  
            // console.log('segmentArray',segmentArray);  
  
          }
  
          const makeSoapRequest = async () => {
            var pricepointXML = pricepointXMLpc;
            console.log("in api2")
            // console.log('main_prc', pricepointXML);
            try {
              const priceresponse = await axios.post(
                `${CONFIG.DEV_API}/reactSelfBookingApi/v1/makeFlightAirServiceRequest`,
                pricepointXML, { headers: { 'Content-Type': 'text/xml' } }
              );
              const priceResponse = priceresponse.data;
              console.log('priceResponse', priceResponse);
  
              parseString(priceResponse, { explicitArray: false }, (err, priceresult) => {
                if (err) {
                  console.error('Error parsing XML:', err);
                  return;
                }
                const AirPriceRsp = priceresult['SOAP:Envelope']['SOAP:Body']['air:AirPriceRsp'];
  
                if (AirPriceRsp !== null && AirPriceRsp !== undefined) {
                  const pricereponse = priceresult['SOAP:Envelope']['SOAP:Body']['air:AirPriceRsp']['air:AirPriceResult']['air:AirPricingSolution'];
                  const segmentpricereponse = priceresult['SOAP:Envelope']['SOAP:Body']['air:AirPriceRsp']['air:AirItinerary']['air:AirSegment'];
                  setpriceparse(Array.isArray(pricereponse) ? pricereponse : [pricereponse]);
                  setsegmentpriceparse(Array.isArray(segmentpricereponse) ? segmentpricereponse : [segmentpricereponse]);
                  // setShow(true);
                } else {
                  const error = priceresult['SOAP:Envelope']['SOAP:Body']['SOAP:Fault']['faultstring'];
              // ErrorLogger.logError('price_api',pricepointXML,error);
                  console.log('errror', error);
                  Swal.fire({
                    title: 'Something Went Wrong !',
                    text: error,
                    confirmButtonText: 'OK'
                  });
                }
              });
            } catch (error) {
              navigate('/tryagainlater');
            }
            finally {
              setLoading(false);
            }
          };
          makeSoapRequest();
        } else {
          Swal.fire({
            title: 'Something has been changed !',
            text: 'Please click on Search Button',
            confirmButtonText: 'OK'
          });
        }
      }
  
    }



  const handleSubmit = async (event) => {
    setFlightOptions([]);
    event.preventDefault();
    setismodify(true);
    let searchfrom = event.target.searchfrom.value.trim();
    let searchto = event.target.searchto.value.trim();
    let searchdeparture = event.target.searchdeparture.value.trim();
    let searchreturnDate = event.target.searchreturnDate.value.trim();
    const originerror = document.querySelector('.redorigin');
    const originerror1 = document.querySelector('.redorigin1');
    const destinationerror = document.querySelector('.redestination');
    const destinationerror1 = document.querySelector('.redestination1');
    const searchdepartureerror = document.querySelector('.redsearchdeparture');
    const searchreturnerror = document.querySelector('.redsearchreturn');
    const searchdepartureerror1 = document.querySelector('.redsearchdeparture1');
    const searchreturnerror1 = document.querySelector('.redsearchreturn1');
    const passengererror = document.querySelector('.redpassenger');
    const infanterror = document.querySelector('.infantmore');

    let totalpassenger = parseInt(adultCount) + parseInt(childCount) + parseInt(infantCount);
    let isValidPassenger = true;

    localStorage.setItem('lastorigin', searchfrom);
    localStorage.setItem('lastDestination', searchto);
    if (infantCount > adultCount) {

      isValidPassenger = false;
      infanterror.style.display = 'block';
    } else {
      infanterror.style.display = 'none';
    }
    const formatPattern = /\((.*?)\)/;
    const dateFormatPattern = /^(0[1-9]|[12]\d|3[01])\/(0[1-9]|1[0-2])\/\d{4}$/;
    if (!searchfrom) {
      isValidPassenger = false;
      originerror.style.display = 'block';
    } else if (!formatPattern.test(searchfrom)) {
      isValidPassenger = false;
      originerror1.style.display = 'block';
    } else {
      originerror1.style.display = 'none';
      originerror.style.display = 'none';
    }
    if (!searchto) {
      isValidPassenger = false;
      destinationerror.style.display = 'block';
    } else if (!formatPattern.test(searchto)) {
      isValidPassenger = false;
      destinationerror1.style.display = 'block';
    } else {
      destinationerror.style.display = 'none';
      destinationerror1.style.display = 'none';
    }
    if (!searchdeparture) {
      isValidPassenger = false;
      searchdepartureerror.style.display = 'block';
    } else if (!dateFormatPattern.test(searchdeparture)) {
      isValidPassenger = false;
      searchdepartureerror1.style.display = 'block';
    } else {
      searchdepartureerror.style.display = 'none';
      searchdepartureerror1.style.display = 'none';
    }
    if (formData.bookingType === 'Return') {
      if (!searchreturnDate) {
        isValidPassenger = false;
        searchreturnerror.style.display = 'block';
      } else {
        searchreturnerror.style.display = 'none';
      }
    } else {
      searchreturnerror.style.display = 'none';
    }
    if (searchreturnDate && !dateFormatPattern.test(searchreturnDate)) {
      isValidPassenger = false;
      searchreturnerror1.style.display = 'block';
    } else {
      searchreturnerror1.style.display = 'none';
    }
    if (totalpassenger > 9) {
      isValidPassenger = false;
      passengererror.style.display = 'block';
    } else {
      passengererror.style.display = 'none';
    }
    if (isValidPassenger) {
      setLoadingg(true);
      const formatDate = (inputDate) => {
        const parsedDate = parse(inputDate, 'dd/MM/yyyy', new Date());
        if (!isValid(parsedDate)) {
          return null;
        } else {
          const formattedDate = format(parsedDate, 'yyyy-MM-dd');
          return formattedDate;
        }

      };

      const searchfrom = event.target.searchfrom.value;
      const searchfromMatch = searchfrom.match(/\((\w+)\)/);
      const searchfromCode = searchfromMatch[1];
      const searchto = event.target.searchto.value;
      const searchtoMatch = searchto.match(/\((\w+)\)/);
      const searchtoCode = searchtoMatch[1];
      const searchdeparture = event.target.searchdeparture.value;
      const searchreturnDate = event.target.searchreturnDate.value;
      const formattedsearchdeparture = formatDate(searchdeparture);
      const formattedsearchreturnDate = formatDate(searchreturnDate);
      const adult = event.target.adult.value;
      const child = event.target.child.value;
      const infant = event.target.infant.value;
      const classtype = event.target.classtype.value;
      let cabinclass = classtype;
      let bookingtype = "";
      if (searchreturnDate) {
        bookingtype = "Return";
      } else {
        bookingtype = "oneway";
      }
      if (classtype === "Economy/Premium Economy") {
        cabinclass = "Economy";
      } else {
        cabinclass = classtype;
      }
      try {

        const dynamicCityCode = searchfromCode;
        const dynamicDestinationCode = searchtoCode;
        const dynamicDepTime = formattedsearchdeparture;
        const returndynamicDepTime = formattedsearchreturnDate;
        // const dynamicCabinType = cabinclass;
        const dynamicCabinType = cabinclass || 'Economy';
        const PassengerCodeADT = adult;
        const PassengerCodeCNN = child;
        const PassengerCodeINF = infant;

        const createSoapEnvelope = (
          cityCode,
          destinationCode,
          depTime,
          returnDepTime,
          cabinType,
          passengerCodeADT,
          passengerCodeCNN,
          passengerCodeINF
        ) => {

          const generatePassengerElements = (age, count, type) => {
            return Array.from({ length: count }, (_, index) => `<com:SearchPassenger Code="${type}"${age ? ` Age="${age}"` : ''}/>`).join('');
          };
          const searchPassengerADT = generatePassengerElements('', passengerCodeADT, 'ADT');
          const searchPassengerCNN = generatePassengerElements('10', passengerCodeCNN, 'CNN');
          const searchPassengerINF = generatePassengerElements('01', passengerCodeINF, 'INF');

          const returnLegSection = returnDepTime
            ? `<air:SearchAirLeg>
                <air:SearchOrigin>
                  <com:CityOrAirport Code="${destinationCode}"/>
                </air:SearchOrigin>
                <air:SearchDestination>
                  <com:CityOrAirport Code="${cityCode}"/>
                </air:SearchDestination>
                <air:SearchDepTime PreferredTime="${returnDepTime}"/>
              </air:SearchAirLeg>`
            : '';

          return `<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
                  <soap:Body>
                <air:LowFareSearchReq TargetBranch="${Targetbranch}" TraceId="TVSBP001" SolutionResult="false" DistanceUnits="Km" AuthorizedBy="TAXIVAXI" xmlns:air="http://www.travelport.com/schema/air_v52_0" xmlns:com="http://www.travelport.com/schema/common_v52_0">
                    <com:BillingPointOfSaleInfo OriginApplication="UAPI"/>
                    <air:SearchAirLeg>
                        <air:SearchOrigin>
                            <com:CityOrAirport Code="${cityCode}"/>
                        </air:SearchOrigin>
                        <air:SearchDestination>
                            <com:CityOrAirport Code="${destinationCode}"/>
                        </air:SearchDestination>
                        <air:SearchDepTime PreferredTime="${depTime}"/>
                    </air:SearchAirLeg>
                    ${returnLegSection}
                    <air:AirSearchModifiers ETicketability="Yes" FaresIndicator="AllFares">
                        <air:PreferredProviders>
                            <com:Provider Code="1G"/>
                            <com:Provider Code="ACH"/>
                        </air:PreferredProviders>
                        <air:PermittedCabins>
                            <com:CabinClass Type="${cabinType}"/>
                        </air:PermittedCabins>
                    </air:AirSearchModifiers>
                    ${searchPassengerADT}
                    ${searchPassengerCNN}
                    ${searchPassengerINF}
                </air:LowFareSearchReq>
            </soap:Body>
            </soap:Envelope>`;
        };

        var soapEnvelope = createSoapEnvelope(
          dynamicCityCode,
          dynamicDestinationCode,
          dynamicDepTime,
          returndynamicDepTime,
          dynamicCabinType,
          PassengerCodeADT,
          PassengerCodeCNN,
          PassengerCodeINF,
        );
        sessionStorage.setItem('searchdata', soapEnvelope);
        // console.log('soap', soapEnvelope);


        const eresponse = await axios.post(
          `${CONFIG.DEV_API}/reactSelfBookingApi/v1/makeFlightAirServiceRequest`,
          soapEnvelope, { headers: { 'Content-Type': 'text/xml' } }
        );
        const eResponse = eresponse.data;
       
        parseString(eResponse, { explicitArray: false }, (err, result) => {
          if (err) {
            console.error('Error parsing XML:', err);
            return;
          }
          const lowFareSearchRsp = result['SOAP:Envelope']['SOAP:Body']['air:LowFareSearchRsp'];
          if (lowFareSearchRsp !== null && lowFareSearchRsp !== undefined) {
            const pricepointlist = result['SOAP:Envelope']['SOAP:Body']['air:LowFareSearchRsp']['air:AirPricePointList']['air:AirPricePoint'];
            // console.log("pricepointlist", pricepointlist)
            const Segmentlist = result['SOAP:Envelope']['SOAP:Body']['air:LowFareSearchRsp']['air:AirSegmentList']['air:AirSegment'];
            const flightdetailist = result['SOAP:Envelope']['SOAP:Body']['air:LowFareSearchRsp']['air:FlightDetailsList']['air:FlightDetails'];
            const hosttokenlist = result?.['SOAP:Envelope']?.['SOAP:Body']?.['air:LowFareSearchRsp']?.['air:HostTokenList']?.['common_v52_0:HostToken'] || [];
            const fareinfolist = result['SOAP:Envelope']['SOAP:Body']['air:LowFareSearchRsp']['air:FareInfoList']['air:FareInfo'];
            // setFlightOptions(Array.isArray(pricepointlist) ? pricepointlist : [pricepointlist]);
            // console.log("Before updating flightOptions:", flightOptions.length);

            // setFlightOptions((prev) => [...pricepointlist]);
            setFlightOptions([...pricepointlist]);

            // console.log("After updating flightOptions:", flightOptions.length);
            setFlightDetails(Array.isArray(flightdetailist) ? flightdetailist : [flightdetailist]);
            setSegment(Array.isArray(Segmentlist) ? Segmentlist : [Segmentlist]);
            // console.log("pricepointlist", pricepointlist)
            setHostlist(Array.isArray(hosttokenlist) ? hosttokenlist : [hosttokenlist]);
            setFarelist(Array.isArray(fareinfolist) ? fareinfolist : [fareinfolist]);
            // console.log("Parsed XML successfully");

          } else {
            const error = result['SOAP:Envelope']['SOAP:Body']['SOAP:Fault']['faultstring'];
            // ErrorLogger.logError('modify_search_api',soapEnvelope,error);
            setFlighterrors(error);
            setFlightOptions([]);
          }
        });


      } catch (error) {
        // ErrorLogger.logError('modify_search_api','Error',error);
        navigate('/tryagainlater');
      }
      finally {
        setLoadingg(false);
      }
    }

  };

  const handleach = async (fareInfoRefKey, pricepoint) => {
    console.log('fareInfoRefKey', fareInfoRefKey);
    console.log('pricepoint', pricepoint);
    const pricingAttrs = pricepoint?.['$'] || {};
    

    const matchedHostTokens = HostList
      .filter(host => host['$']?.Key === fareInfoRefKey?.HostTokenRef)
      .map(host => ({
        key: host['$'].Key,
        value: host._
      }));

      const buildHostTokenObjects = (tokens) => {
        return tokens.map(token => ({
          'common:HostToken': {
            '$': {
              'Key': token.key
            },
            '_': token.value
          }
        }));
      };
    const matchedFareInfo = FareList.find(
      (fareInfo) => fareInfo['$']?.Key === fareInfoRefKey?.FareInfoRef
    );
    const fareBasisCode = matchedFareInfo?.['$']?.FareBasis || '';
    const matchingSegInfo = SegmentList.find(
      (segment) => segment['$']?.Key === fareInfoRefKey?.SegmentRef
    );
    console.log('matchingSegInfo', matchingSegInfo);
    const buildAirSegmentObject = (segment) => {
      if (!segment || !segment['$']) return null;
      
    
      const obj = {
        '$': segment['$']
      };
      
      obj['$'].ClassOfService = fareInfoRefKey?.BookingCode;
      obj['$'].CabinClass = cabinclass;
      const airAvailInfoAttrs = segment['air:AirAvailInfo']?.$;
        if (airAvailInfoAttrs?.ProviderCode) { 
          obj['$'].ProviderCode = airAvailInfoAttrs.ProviderCode;
        }
    
      if (segment['air:CodeshareInfo']) {
        const cs = segment['air:CodeshareInfo'];
        obj['air:CodeshareInfo'] = {
          '$': cs['$'] || {},
          '_': cs['_'] || ''
        };
      }
    
      if (segment['air:AirAvailInfo']) {
        obj['air:AirAvailInfo'] = {
          '$': segment['air:AirAvailInfo']['$'] || {}
        };
      }
    
      // if (segment['air:FlightDetailsRef']) {
      //   obj['air:FlightDetailsRef'] = {
      //     '$': segment['air:FlightDetailsRef']['$'] || {}
      //   };
      // }
    
      return obj;
    };

    const builder = require('xml2js').Builder;

    const airExchangeQuoteReqObj = {
      'soap:Envelope': {
        '$': {
          'xmlns:soap': 'http://schemas.xmlsoap.org/soap/envelope/'
        },
        'soap:Body': {
          'air:AirExchangeQuoteReq': {
            '$': {
              'TargetBranch': Targetbranch,
              'xmlns:air': 'http://www.travelport.com/schema/air_v47_0',
              'xmlns:common': 'http://www.travelport.com/schema/common_v47_0',
              'xmlns:xsi': 'http://www.w3.org/2001/XMLSchema-instance',
              'xsi:schemaLocation': 'http://www.travelport.com/schema/air_v47_0 file:///C:/Users/NESARA.DH/Documents/Ecommerce/uAPI_WSDLschema_Release-V20.2.1.573/air_v47_0/AirReqRsp.xsd'
            },

            'common:BillingPointOfSaleInfo': {
              '$': {
                'OriginApplication': 'UAPI'
              }
            },

            'air:ProviderReservationInfo': {
              '$': {
                'ProviderCode': 'ACH',
                'ProviderLocatorCode': universal_locator_code
              }
            },

            'air:AirPricingSolution': {
              '$': {
                'Key': pricingAttrs.Key || '',
                'CompleteItinerary': pricingAttrs.CompleteItinerary || 'true',
                'TotalPrice': pricingAttrs.TotalPrice || '',
                'BasePrice': pricingAttrs.BasePrice || '',
                'ApproximateTotalPrice': pricingAttrs.ApproximateTotalPrice || '',
                'ApproximateBasePrice': pricingAttrs.ApproximateBasePrice || '',
                'Taxes': pricingAttrs.Taxes || '',
                'ApproximateTaxes': pricingAttrs.ApproximateTaxes || ''
              },
              'air:AirSegment': buildAirSegmentObject(matchingSegInfo)
            },

            'air:AirExchangeModifiers': {
              '$': {
                'BookingDate': previousdepdate
              }
            },

            ...Object.assign({}, ...buildHostTokenObjects(matchedHostTokens)),

            'air:RepricingModifiers': {
              'air:AirSegmentPricingModifiers': {
                '$': {
                  'AirSegmentRef': fareInfoRefKey?.SegmentRef || '',
                  'CabinClass': cabinclass,
                  'FareBasisCode': fareBasisCode
                }
              }
            }
          }
        }
      }
    };
    const airExchangeQuoteReqXML = new builder({ headless: true }).buildObject(airExchangeQuoteReqObj);

    


    console.log('quotereq', airExchangeQuoteReqXML);
    const Quoteresponse = await axios.post(
      `${CONFIG.DEV_API}/reactSelfBookingApi/v1/makeFlightAirServiceRequest`,
      airExchangeQuoteReqXML, { headers: { 'Content-Type': 'text/xml' } }
    );
    const quoteResponse = Quoteresponse.data;
    console.log('quoteResponse', quoteResponse);
    };
  

  useEffect(() => {
    let timeoutId;
    const timeoutDuration = 5 * 60 * 1000;
    const handleInactive = () => {
      Swal.fire({
        title: 'Something went Wrong !',
        text: 'Your session has expired. You will be redirected to the homepage.',
        confirmButtonText: 'OK'
      });
      navigate('/');
    };
    const resetTimer = () => {
      clearTimeout(timeoutId);
      timeoutId = setTimeout(handleInactive, timeoutDuration);
    };
    const resetOnActivity = () => {
      resetTimer();
      window.addEventListener('mousemove', resetTimer);
      window.addEventListener('keydown', resetTimer);
    };
    resetOnActivity();
    return () => {
      clearTimeout(timeoutId);
      window.removeEventListener('mousemove', resetTimer);
      window.removeEventListener('keydown', resetTimer);
    };
  }, [navigate]);

  const [selectedFlights, setSelectedFlights] = useState([]);
  // console.log('selectedFlights',selectedFlights);
  const [isMinimized, setIsMinimized] = useState(false);




  const [selectedPriceIndex, setSelectedPriceIndex] = useState(null);
  const [visibleDetails, setVisibleDetails] = useState(false);
  const [visibleDetailsByName, setVisibleDetailsByName] = useState({}); // For name-specific toggle
  const [fareInfoDetails, setFareInfoDetails] = useState({});
  // console.log('fareInfoDetails', fareInfoDetails);


  const toggleDetails = async (name) => {
    if (visibleDetails) {
      setVisibleDetails(false);
      setVisibleDetailsByName(null);
    } else {
      setVisibleDetails(true);
      setVisibleDetailsByName(name);
    }

  };
  const handleFareInfoClick = async (fareInfoRefKey) => {
    try {
      // Reset fare info before making the API call
      setFareInfoDetails(null);
      // setFareInfoVisible(false);

      // console.log("Fetching Fare Info for Key:", fareInfoRefKey);
      const matchingFareRule = FareList.find(
        entry => entry["air:FareRuleKey"]["$"]['FareInfoRef'] === fareInfoRefKey
      )?.["air:FareRuleKey"];
      console.log('farerule', matchingFareRule);

      // Construct the SOAP envelope dynamically
      const soapEnvelope = `
        <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
            <soap:Body xmlns:air="http://www.travelport.com/schema/air_v52_0"
                xmlns:com="http://www.travelport.com/schema/common_v52_0">
                <air:AirFareRulesReq xmlns="http://www.travelport.com/schema/air_v52_0" TraceId="8eaceda4-2f16-4421-807d-67f3fd9738a2" TargetBranch="${Targetbranch}">
                    <com:BillingPointOfSaleInfo xmlns="http://www.travelport.com/schema/common_v52_0" OriginApplication="uAPI" />
                    <air:FareRuleKey FareInfoRef="${fareInfoRefKey["$"].FareInfoRef}" ProviderCode="${fareInfoRefKey["$"].ProviderCode}">
                    ${fareInfoRefKey["_"]}
                  </air:FareRuleKey>
                </air:AirFareRulesReq>
            </soap:Body>
        </soap:Envelope>
      `;
      // console.log('soapEnvelope', soapEnvelope);

      const response = await axios.post(
        `${CONFIG.DEV_API}/reactSelfBookingApi/v1/makeFlightAirServiceRequest`,
        soapEnvelope,
        { headers: { "Content-Type": "text/xml" } }
      );

      // console.log("API Response:", response.data);

      // Function to extract text from the XML response
      const extractFareRuleText = (xmlString) => {
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(xmlString, "text/xml");

        // Select all <air:FareRuleLong> elements
        const fareRuleNodes = xmlDoc.getElementsByTagName("air:FareRuleLong");
        let extractedTexts = [];

        for (let node of fareRuleNodes) {
          let cdataSection = node.childNodes[0]; // CDATA section is the first child
          if (cdataSection && cdataSection.nodeType === Node.CDATA_SECTION_NODE) {
            extractedTexts.push(cdataSection.nodeValue.trim());
          }
        }

        return extractedTexts; // Join multiple rules with spacing
      };

      // Extract text and update state
      const fareRuleText = extractFareRuleText(response.data);

      setFareInfoDetails(fareRuleText);


      // setFareInfoVisible(true);
      setVisibleDetails(true);
    } catch (error) {
      console.error("Error fetching fare info:", error);
    }
  };

  // const [dataFound, setDataFound] = useState(false);
  const renderedSegmentRefs = useRef(new Set()); // Track already rendered segment combinations
  const [filteredFlights, setFilteredFlights] = useState([]);

  useEffect(() => {
    setFilteredFlights([]); // Clear previous flights

    flightOptions.forEach((pricepoint) => {
      setTimeout(() => {
        const options = pricepoint['air:AirPricingInfo']?.['air:FlightOptionsList']?.['air:FlightOption']?.['air:Option'];
        const optionsArray = Array.isArray(options) ? options : options ? [options] : [];

        optionsArray.forEach((airOption) => {
          const bookingInfo = airOption['air:BookingInfo'];
          const bookingInfoArray = Array.isArray(bookingInfo) ? bookingInfo : [bookingInfo];

          // Collect all segment keys from bookingInfo
          const segmentKeys = bookingInfoArray.map(info => info['$']['SegmentRef']).sort(); // Sort for consistent ordering

          // Create a unique identifier for this flight option
          const segmentKeyString = segmentKeys.join(',');

          if (!renderedSegmentRefs.current.has(segmentKeyString)) {
            // Mark this segment combination as rendered
            renderedSegmentRefs.current.add(segmentKeyString);

            // Create a new flight option with only this `airOption`
            const newFlightOption = {
              ...pricepoint,
              'air:AirPricingInfo': {
                ...pricepoint['air:AirPricingInfo'],
                'air:FlightOptionsList': {
                  'air:FlightOption': {
                    ...pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'],
                    'air:Option': airOption // Assign only this option
                  }
                }
              }
            };

            setFilteredFlights(prevFlights => [...prevFlights, newFlightOption]);
          }
        });
      }, 200);
    });
  }, [flightOptions]);
  

  let flightsMatched = false;

  return (
    <div className="yield-content" style={{ background: '#e8e4ff' }}>
      <header className="search-bar" id="widgetHeader">
        <form id="submit-form" onSubmit={(e) => handleSubmit(e)} action="" method="POST" autoComplete="off">
          <div id="search-widget" className="hsw v2">
            <div className="hsw_inner" style={{ marginLeft: '7%' }}>

              <div className="hsw_inputBox tripTypeWrapper">
                <label htmlFor="tripType" className="lbl_input latoBold font12 blueText appendBottom5">
                  TRIP TYPE
                </label>
                <div className="selectDropdown">
                  <select
                    id="tripType"
                    className="tripTypeSelect"
                    name="bookingtype"
                    value={formData.bookingType}
                    onChange={handleRadioChange}
                    disabled={bookingid}
                    style={{ backgroundColor: bookingid ? "#e0e0e0" : "white", fontSize: '14px', fontWeight: '600', height: '40px' }}
                  >
                    <option value="oneway">One Way</option>
                    <option value="Return">Return</option>
                  </select>
                  <div className="dropdownIcon">
                    {/* SVG Icon */}
                    <svg
                      width="12"
                      height="12"
                      viewBox="0 0 24 24"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 10l5 5 5-5"
                        stroke="#666"
                        strokeWidth="2"
                        strokeLinecap="round"
                        strokeLinejoin="round"
                      />
                    </svg>
                  </div>
                </div>
              </div>


              <div className="hsw_inputBox">
                <label htmlFor="fromCity" className="lbl_input latoBold font12 blueText appendBottom5">
                  FROM
                </label>
                <div className="input-a" style={{ backgroundColor: bookingid ? "#e0e0e0" : "white" }}>
                  <input
                    type="text"
                    placeholder="Search..."
                    id="searchfrom"
                    className="text_input"
                    name="searchfrom"
                    value={inputOrigin}
                    onChange={(e) => handleOriginChange(e.target.value)}
                    disabled={bookingid}
                    style={{ fontSize: '14px', fontWeight: '600' }}

                  />

                  {showOriginDropdown && (
                    <ul style={{
                      position: 'absolute',
                      top: '100%',
                      marginLeft: '-8px',
                      borderRadius: '3px',
                      backgroundColor: '#fff',
                      paddingLeft: '6px',
                      width: '100%',
                      border: '1px solid #e3e3e3',
                      listStyle: 'none',
                      width: '100%',
                      zIndex: '9999',
                      maxHeight: '150px',
                      minHeight: 'auto',
                      overflow: 'auto'
                    }}>
                      {origin.map((option) => (
                        <li style={{
                          cursor: 'pointer',
                          fontFamily: 'Montserrat',
                          color: '#4c4c4c',
                          fontSize: '10px',
                          paddingTop: '5px',
                          paddingBottom: '5px',
                          paddingRight: '5px'
                        }} key={option.value} onClick={() => handleOrigin(option.value, option.airportName)}>
                          {option.label} ({option.value}) <br />
                          {option.airportName}
                        </li>
                      ))}
                    </ul>
                  )}


                </div>
                <div className="redorigin" style={{
                  color: 'red',
                  fontsize: '10px',
                  fontfamily: 'Raleway', display: 'none'
                }}>Please select Origin</div>
                <div className="redorigin1" style={{
                  color: 'red',
                  fontsize: '10px',
                  fontfamily: 'Raleway', display: 'none'
                }}>Please select valid Origin</div>

              </div>


              <div>

                <button type="button" className='swapbutton' onClick={swapOriginAndDestination}><img src='/img/Swap-01.png' width={'17px'} /></button>
              </div>


              <div className="hsw_inputBox">
                <label htmlFor="toCity" className="lbl_input latoBold font12 blueText appendBottom5">
                  TO
                </label>
                <div className="input-a" style={{ backgroundColor: bookingid ? "#e0e0e0" : "white" }}>
                  <input
                    type="text"
                    placeholder="Search..."
                    id="searchto" className="text_input" name="searchto"
                    value={inputDestination}
                    onChange={(e) => handleDestinationChange(e.target.value)}
                    disabled={bookingid}
                    style={{ fontSize: '14px', fontWeight: '600' }}
                  />

                  {showDestinationDropdown && (
                    <ul style={{
                      position: 'absolute',
                      top: '100%',
                      marginLeft: '-8px',
                      borderRadius: '3px',
                      backgroundColor: '#fff',
                      paddingLeft: '6px',
                      width: '100%',
                      border: '1px solid #e3e3e3',
                      listStyle: 'none',
                      width: '100%',
                      zIndex: '9999',
                      maxHeight: '150px',
                      minHeight: 'auto',
                      overflow: 'auto'
                    }}>
                      {destination.map((option) => (
                        <li style={{
                          cursor: 'pointer',
                          fontFamily: 'Montserrat',
                          color: '#4c4c4c',
                          fontSize: '10px',
                          paddingTop: '5px',
                          paddingBottom: '5px',
                          paddingRight: '5px'
                        }} key={option.value} onClick={() => handleDestination(option.value, option.airportName)}>
                          {option.label} ({option.value})<br />
                          {option.airportName}
                        </li>
                      ))}
                    </ul>
                  )}

                </div>

                <div className="redestination" style={{
                  color: 'red',
                  fontsize: '10px',
                  fontfamily: 'Raleway', display: 'none'
                }}>Please select Destination</div>
                <div className="redestination1" style={{
                  color: 'red',
                  fontsize: '10px',
                  fontfamily: 'Raleway', display: 'none'
                }}>Please select valid Destination</div>
              </div>


              <div className="hsw_inputBox">
                <label className="lbl_input latoBold font12 blueText appendBottom5">
                  DEPART
                </label>
                <div className="input-a" onClick={() => setdepIsOpen(true)} style={{ width: '120px', height: '40.5px', backgroundColor: bookingid ? "#e0e0e0" : "white" }} >
                  <div style={{ fontSize: '14px', fontWeight: '600' }}>
                    <DatePicker className="custom-datepicker"
                      name="searchdeparture"
                      selected={formData.departureDate}
                      onChange={handleDepartureDateChange}
                      dateFormat="dd/MM/yyyy"
                      minDate={new Date()}
                      value={ddmmyyyyformatDate(formData.departureDate)}
                      open={isdepOpen}
                      onClickOutside={() => setdepIsOpen(false)}
                      disabled={bookingid}
                      style={{ fontSize: '5px' }}
                    />
                  </div>


                  <span className="date-icon" onClick={(e) => { e.stopPropagation(); setdepIsOpen(true) }}></span></div>
                <span id="errorDate" style={{
                  color: 'red',
                  fontsize: '12px',
                  fontfamily: 'Raleway'
                }} className="error-message"></span>
                <div className="redsearchdeparture" style={{
                  color: 'red',
                  fontsize: '12px',
                  fontfamily: 'Raleway'
                }}>Please select Depart Date</div>
                <div className="redsearchdeparture1" style={{
                  display: 'none',
                  color: 'red',
                  fontsize: '12px',
                  fontfamily: 'Raleway'
                }}>Please select valid Depart Date</div>
              </div>


              <div className="hsw_inputBox" id="departurereturn">
                <label htmlFor="return" className="lbl_input latoBold font12 blueText appendBottom5">
                  RETURN
                </label>
                <div className="input-a" onClick={formData.bookingType === "Return" ? () => setretIsOpen(true) : () => () => setretIsOpen(false)} style={{ width: '120px', backgroundColor: bookingid ? "#e0e0e0" : "white" }}>
                  <DatePicker
                    name="searchreturnDate"
                    selected={formData.returnDate}
                    onChange={handleReturnDateChange}
                    dateFormat="dd/MM/yyyy"
                    minDate={formData.departureDate || new Date()}
                    placeholderText="Add Return Date"
                    value={formData.returnDate && ddmmyyyyformatDate(formData.returnDate)}
                    // disabled={!isReturnEnabled}
                    open={isretOpen}
                    onClickOutside={() => setretIsOpen(false)}
                    // disabled={bookingid}
                    disabled={!isReturnEnabled || bookingid}
                    className="custom-datepicker"
                    style={{ fontSize: '5px', paddingBottom: "4px" }}
                  />
                  <span
                    className="date-icon"
                    onClick={(e) => {
                      if (formData.bookingType === "Return") {
                        e.stopPropagation();
                        setretIsOpen(true);
                      }
                    }}
                  ></span>
                </div>
                <span id="errorDate1" style={{
                  color: 'red',
                  fontsize: '12px',
                  fontfamily: 'Raleway'
                }} className="error-message"></span>
                <div className="redsearchreturn" style={{
                  display: 'none',
                  color: 'red',
                  fontsize: '12px',
                  fontfamily: 'Raleway'
                }}>Please select Return Date</div>
                <div className="redsearchreturn1" style={{
                  display: 'none',
                  color: 'red',
                  fontsize: '12px',
                  fontfamily: 'Raleway'
                }}>Please select valid Return Date</div>
              </div>


              <div className="hsw_inputBox">
                <label htmlFor="travellerAndClass" className="lbl_input latoBold font12 blueText appendBottom5">
                  PASSENGERS &amp; CLASS
                </label>
                <div className="input-a" style={{ width: '250px', height: '40px', backgroundColor: bookingid ? "#e0e0e0" : "white" }}>
                  <input
                    type="text"
                    id="openpassengermodal"
                    name="openpassengermodal"
                    className="openpassengermodal srch-lbl"
                    placeholder="Select all"
                    value={`Adult: ${adultCount}, Child: ${childCount}, Infant: ${infantCount}, Cabinclass: ${cabinClass} class`}
                    onClick={handleToggle}
                    disabled={bookingid}
                    readOnly
                    style={{ fontSize: '14px', fontWeight: '600' }}
                  />

                </div>
                <div className="redpassenger" style={{
                  color: 'red',
                  fontsize: '12px',
                  fontfamily: 'Raleway'
                }}>Please select maximum 9 passenger</div>
                <div className="infantmore" style={{
                  color: 'red',
                  fontsize: '12px',
                  fontfamily: 'Raleway'
                }}>Number of infants cannot be more than adults</div>
                <div className="search-asvanced" style={{ display: isOpen ? 'block' : 'none', marginTop: '1%', marginLeft: '-43%' }}>
                  <div className="search-large-i">
                    <div className="srch-tab-line no-margin-bottom">
                      <label style={{ textAlign: 'left', marginBottom: '0px' }}>Adults (12y +)</label>
                      <p style={{ color: '#7b7777', fontSize: 'small', marginBottom: '1px' }}>on the day of travel</p>
                      <div className="select-wrapper1">
                        {[1, 2, 3, 4, 5, 6, 7, 8, 9].map((value) => (
                          <React.Fragment key={value}>
                            <input
                              type="radio"
                              name="adult"
                              id={`adult${value}`}
                              value={value}
                              onChange={(e) => handleAdult(e.target.value)}
                              checked={Cookies.get('cookiesData') ? value.toString() === adultCount.toString() : value === 1}
                            />
                            <label htmlFor={`adult${value}`}>{value}</label>
                          </React.Fragment>
                        ))}
                        <input
                          type="radio"
                          name="adult"
                          id="adultgreater9"
                          value={10}
                          onChange={(e) => handleAdult(e.target.value)}
                        />
                        <label htmlFor="adultgreater9">&gt;9</label>
                      </div>
                    </div>
                    <div className="row-container">
                      <div className="srch-tab-line no-margin-bottom">
                        <label style={{ textAlign: 'left', marginBottom: '0px' }}>Children (2y - 12y)</label>
                        <p style={{ color: '#7b7777', fontSize: 'small', marginBottom: '1px' }}>on the day of travel</p>
                        <div className="select-wrapper1">
                          {[0, 1, 2, 3, 4, 5, 6].map((value) => (
                            <React.Fragment key={value}>
                              <input
                                type="radio"
                                name="child"
                                id={`child${value}`}
                                value={value}
                                onChange={(e) => handleChild(e.target.value)}
                                checked={Cookies.get('cookiesData') ? value.toString() === childCount.toString() : value === 0}
                              />
                              <label htmlFor={`child${value}`}>{value}</label>
                            </React.Fragment>
                          ))}
                          <input
                            type="radio"
                            name="child"
                            id="childgreater6"
                            value={7}
                            onChange={(e) => handleChild(e.target.value)}
                          />
                          <label htmlFor="childgreater6">&gt;6</label>
                        </div>
                      </div>
                      <div className="srch-tab-line no-margin-bottom">
                        <label style={{ textAlign: 'left', marginBottom: '0px' }}>Infants (below 2y)</label>
                        <p style={{ color: '#7b7777', fontSize: 'small', marginBottom: '1px' }}>on the day of travel</p>
                        <div className="select-wrapper1">
                          {[0, 1, 2, 3, 4, 5, 6].map((value) => (
                            <React.Fragment key={value}>
                              <input
                                type="radio"
                                name="infant"
                                id={`infant${value}`}
                                value={value}
                                onChange={(e) => handleInfant(e.target.value)}
                                checked={Cookies.get('cookiesData') ? value.toString() === infantCount.toString() : value === 0}
                              />
                              <label htmlFor={`infant${value}`}>{value}</label>
                            </React.Fragment>
                          ))}
                          <input
                            type="radio"
                            name="infant"
                            id="infantgreater6"
                            value={7}
                            onChange={(e) => handleInfant(e.target.value)}
                          />
                          <label htmlFor="infantgreater6">&gt;6</label>
                        </div>
                      </div>
                    </div>

                  </div>
                  {/* Travel Class Selection */}
                  <div className="search-large-i1">
                    <div className="srch-tab-line no-margin-bottom">
                      <label style={{ marginBottom: '1%', textAlign: 'left' }}>Choose Travel Class</label>
                      <div className="select-wrapper1 select-wrapper2">
                        {['Economy/Premium Economy', 'Business', 'First'].map((value) => (
                          <React.Fragment key={value}>
                            <input
                              type="radio"
                              name="classtype"
                              id={`classtype${value}`}
                              value={value}
                              onChange={(e) => handleClasstype(e.target.value)}
                              checked={cabinClass?.toString() === "Economy" && value === "Economy/Premium Economy" ? true : cabinClass?.toString() === value}
                            />
                            <label style={{ lineHeight: '2' }} htmlFor={`classtype${value}`}>{value === "Economy/Premium Economy" ? value : `${value} class`}</label>
                          </React.Fragment>
                        ))}
                      </div>
                    </div>
                  </div>
                  <button type='button' className="search-buttonn" style={{ marginLeft: '69%' }} onClick={() => { setIsOpen(false); }}>Apply</button>
                </div>

                {/* <div className="search-asvanced" style={{ display: isOpen ? 'block' : 'none' }}>
                  <div className="search-large-i">
                    <div className="srch-tab-line no-margin-bottom">
                      <div className="srch-tab-line no-margin-bottom">
                        <label>Adults (12y + : on the day of travel)</label>
                        <div className="select-wrapper1">
                          {[1, 2, 3, 4, 5, 6, 7, 8, 9].map((value) => (
                            <React.Fragment key={value}>
                              <input
                                type="radio"
                                name="adult"
                                id={`adult${value}`}
                                value={value}
                                onChange={(e) => handleAdult(e.target.value)}
                                checked={Cookies.get('cookiesData') ? value.toString() === adultCount.toString() : value === 1}
                              />
                              <label htmlFor={`adult${value}`}>{value}</label>
                            </React.Fragment>
                          ))}
                          <input
                            type="radio"
                            name="adult"
                            id="adultgreater9"
                            value={10}
                            onChange={(e) => handleAdult(e.target.value)}
                          />
                          <label htmlFor="adultgreater9">&gt;9</label>
                        </div>
                      </div>
                      <div className="clear" />
                    </div>
                  </div>
                  <div className="search-large-i">
                    <div className="srch-tab-line no-margin-bottom">
                      <label>Children (2y - 12y : on the day of travel)</label>
                      <div className="select-wrapper1">
                        {[0, 1, 2, 3, 4, 5, 6].map((value) => (
                          <React.Fragment key={value}>
                            <input
                              type="radio"
                              name="child"
                              id={`child${value}`}
                              value={value}
                              onChange={(e) => handleChild(e.target.value)}
                              checked={Cookies.get('cookiesData') ? value.toString() === childCount.toString() : value === 0}
                            />
                            <label htmlFor={`child${value}`}>{value}</label>
                          </React.Fragment>
                        ))}
                        <input
                          type="radio"
                          name="child"
                          id="childgreater6"
                          value={7}
                          onChange={(e) => handleChild(e.target.value)}
                        />
                        <label htmlFor="childgreater6">&gt;6</label>
                      </div>

                    </div>
                  </div>
                  <div className="search-large-i">
                    <div className="srch-tab-line no-margin-bottom">
                      <label>Infants (below 2y : on the day of travel)</label>
                      <div className="select-wrapper1">
                        {[0, 1, 2, 3, 4, 5, 6].map((value) => (
                          <React.Fragment key={value}>
                            <input
                              type="radio"
                              name="infant"
                              id={`infant${value}`}
                              value={value}
                              onChange={(e) => handleInfant(e.target.value)}
                              checked={Cookies.get('cookiesData') ? value.toString() === infantCount.toString() : value === 0}
                            />
                            <label htmlFor={`infant${value}`}>{value}</label>
                          </React.Fragment>
                        ))}
                        <input
                          type="radio"
                          name="infant"
                          id="infantgreater6"
                          value={7}
                          onChange={(e) => handleInfant(e.target.value)}
                        />
                        <label htmlFor="infantgreater6">&gt;6</label>
                      </div>

                    </div>
                  </div>
                  <div className="clear" />
                </div>
                <div className="search-asvanced" style={{ display: isOpen ? 'block' : 'none' }}>
                  <div className="search-large-i1">
                    <div className="srch-tab-line no-margin-bottom">
                      <label>Choose Travel Class</label>
                      <div className="select-wrapper1 select-wrapper2">
                        {['Economy/Premium Economy', 'Business', 'First'].map((value) => (
                          <React.Fragment key={value}>
                            <input
                              type="radio"
                              name="classtype"
                              id={`classtype${value}`}
                              value={value}
                              onChange={(e) => handleClasstype(e.target.value)}
                              checked={cabinClass?.toString() === "Economy" && value === "Economy/Premium Economy" ? true : cabinClass?.toString() === value}
                            />
                            <label style={{ lineHeight: '1.8' }} htmlFor={`classtype${value}`}>{value === "Economy/Premium Economy" ? value : `${value} class`}</label>
                          </React.Fragment>
                        ))}
                      </div>
                      <div className="clear" />
                    </div>
                  </div>
                  <div className="clear" />
                </div> */}
              </div>
              <button type="submit" className="srch-btn" style={{ width: '98px', marginBottom: '-5px', height: '39px', fontSize: "14px" }} id="btnSearch">Search</button>

            </div>
          </div>
        </form>
      </header>
      {/* {loadingg &&  <div className="loader" style={{display:"block"}}>
            <img
              src="/img/flight-loader-material-gif.gif"
              alt="Loader"
            />
            <h2>Hold on, weâ€™re fetching packages for you</h2>
          </div>
        } */}
      {loadingg &&
        <div className="page-center-loader flex items-center justify-center">
          <div className="big-loader flex items-center justify-center">
            <img className="loader-gif" src="/img/cotravloader.gif" alt="Loader" />
            <p className="text-center ml-4 text-gray-600 text-lg">
              Retrieving flight details. Please wait a moment.
            </p>
          </div>
        </div>
      }
      <div className="main-cont" id="main_cont">
        <div className="body-wrapper">
          <div className="wrapper-padding">
            <div className="two-colls">
              {/* sidebar start */}
              <div className="two-colls-left">

                <div className='side-block fly-in headingofflights'>
                  Flights from {inputOrigin && (
                    inputOrigin.includes(" - ")
                      ? inputOrigin.split(" - ")[0].trim()
                      : inputOrigin.includes("(")
                        ? inputOrigin.split("(")[0].trim()
                        : inputOrigin.trim()
                  )} {" "}
                  to {inputDestination && (
                    inputDestination.includes(" - ")
                      ? inputDestination.split(" - ")[0].trim()
                      : inputDestination.includes("(")
                        ? inputDestination.split("(")[0].trim()
                        : inputDestination.trim()
                  )}
                </div>

                {flightOptions && flightOptions.length > 0 &&
                  <>
                    <div className="side-block fly-in">
                      <div className="side-stars">
                        <div className="side-padding">
                          <div className="side-lbl">Stops From {inputOrigin && (
                            inputOrigin.includes(" - ")
                              ? inputOrigin.split(" - ")[0].trim()
                              : inputOrigin.includes("(")
                                ? inputOrigin.split("(")[0].trim()
                                : inputOrigin.trim()
                          )} {" "}</div>
                          {(() => {
                            let uniqueStops = new Set();

                            flightOptions && flightOptions.map((pricepoint, priceindex) => (
                              pricepoint['air:AirPricingInfo'] && (
                                Array.isArray(pricepoint['air:AirPricingInfo'])
                                  ? (
                                    <>
                                      {
                                        pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0] ? (
                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'] && (
                                            Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'])
                                              ? (
                                                <>
                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'])
                                                    ? (

                                                      uniqueStops.add(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].length - 1)

                                                    ) : (
                                                      uniqueStops.add(0)
                                                    )
                                                  }
                                                </>
                                              ) : (
                                                <>
                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'])
                                                    ? (
                                                      uniqueStops.add(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].length - 1)

                                                    ) : (
                                                      uniqueStops.add(0)
                                                    )
                                                  }
                                                </>
                                              )
                                          )
                                        ) : (
                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'] && (
                                            Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'])
                                              ? (
                                                <>
                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'])
                                                    ? (

                                                      uniqueStops.add(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].length - 1)

                                                    ) : (
                                                      uniqueStops.add(0)
                                                    )
                                                  }
                                                </>
                                              ) : (
                                                <>
                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'])
                                                    ? (
                                                      uniqueStops.add(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].length - 1)

                                                    ) : (
                                                      uniqueStops.add(0)
                                                    )
                                                  }
                                                </>
                                              )
                                          )
                                        )
                                      }

                                    </>
                                  ) : (
                                    <>
                                      {
                                        pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0] ? (
                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'] && (
                                            Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'])
                                              ? (
                                                <>
                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'])
                                                    ? (
                                                      uniqueStops.add(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].length - 1)

                                                    ) : (
                                                      uniqueStops.add(0)
                                                    )
                                                  }
                                                </>
                                              ) : (
                                                <>
                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'])
                                                    ? (
                                                      uniqueStops.add(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].length - 1)
                                                    ) : (
                                                      uniqueStops.add(0)
                                                    )
                                                  }
                                                </>
                                              )
                                          )
                                        ) :
                                          (
                                            pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'] && (
                                              Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'])
                                                ? (
                                                  <>
                                                    {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'] &&
                                                      Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'])
                                                      ? (
                                                        uniqueStops.add(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].length - 1)

                                                      ) : (
                                                        uniqueStops.add(0)
                                                      )
                                                    }
                                                  </>
                                                ) : (
                                                  <>
                                                    {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'] &&
                                                      Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'])
                                                      ? (
                                                        uniqueStops.add(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].length - 1)
                                                      ) : (
                                                        uniqueStops.add(0)
                                                      )
                                                    }
                                                  </>
                                                )
                                            )
                                          )
                                      }

                                    </>
                                  )
                              )
                            ));
                            let uniqueStopsArray = Array.from(uniqueStops);
                            


                            return (
                              <>
                                {uniqueStopsArray.map((stop, index) => (
                                  <div className="checkbox" key={index}>
                                    <input
                                      type="checkbox"
                                      id={`stop${stop}`}
                                      name={stop === 0 ? 'nonstop' : `${stop}stop`}
                                      onChange={() => handleStopCheckboxChange(stop)}
                                      checked={selectedStops.includes(stop)}
                                    />
                                    <label>{stop === 0 ? 'non' : stop} stop</label>
                                  </div>

                                ))}
                              </>
                            );
                          })()}


                        </div>
                      </div>
                    </div>

                    {formData.bookingType === "Return" && (
                      <div className="side-block fly-in">
                        <div className="side-stars">
                          <div className="side-padding">
                            <div className="side-lbl">Stops From {inputDestination && (
                              inputDestination.includes(" - ")
                                ? inputDestination.split(" - ")[0].trim()
                                : inputDestination.includes("(")
                                  ? inputDestination.split("(")[0].trim()
                                  : inputDestination.trim()
                            )}</div>
                            {(() => {
                              let uniquereturnStops = new Set();

                              flightOptions && flightOptions.map((pricepoint, priceindex) => (
                                pricepoint['air:AirPricingInfo'] && (
                                  Array.isArray(pricepoint['air:AirPricingInfo'])
                                    ? (
                                      <>
                                        {
                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1] &&
                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'] && (
                                            Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'])
                                              ? (
                                                <>
                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'])
                                                    ? (

                                                      uniquereturnStops.add(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].length - 1)

                                                    ) : (
                                                      uniquereturnStops.add(0)
                                                    )
                                                  }
                                                </>
                                              ) : (
                                                <>
                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'])
                                                    ? (
                                                      uniquereturnStops.add(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].length - 1)

                                                    ) : (
                                                      uniquereturnStops.add(0)
                                                    )
                                                  }
                                                </>
                                              )
                                          )

                                        }

                                      </>
                                    ) : (
                                      <>
                                        {
                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1] &&
                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'] && (
                                            Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'])
                                              ? (
                                                <>
                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'])
                                                    ? (
                                                      uniquereturnStops.add(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].length - 1)

                                                    ) : (
                                                      uniquereturnStops.add(0)
                                                    )
                                                  }
                                                </>
                                              ) : (
                                                <>
                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'])
                                                    ? (
                                                      uniquereturnStops.add(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].length - 1)
                                                    ) : (
                                                      uniquereturnStops.add(0)
                                                    )
                                                  }
                                                </>
                                              )
                                          )

                                        }

                                      </>
                                    )
                                )
                              ));
                              let uniquereturnStopsArray = Array.from(uniquereturnStops);

                              return (
                                <>
                                  {uniquereturnStopsArray.map((returnstop, returnindex) => (
                                    <div className="checkbox" key={returnindex}>
                                      <input
                                        type="checkbox"
                                        id={`stop${returnstop}`}
                                        name={returnstop === 0 ? 'nonstop' : `${returnstop}stop`}
                                        onChange={() => handlereturnStopCheckboxChange(returnstop)}
                                        checked={selectedreturnStops.includes(returnstop)}
                                      />
                                      <label>{returnstop === 0 ? 'non' : returnstop} stop</label>
                                    </div>

                                  ))}
                                </>
                              );
                            })()}
                          </div>
                        </div>
                      </div>
                    )}

                    <div className="side-block fly-in">
                      <div className="side-padding">
                        <div className="side-lbl">Departure From {inputOrigin && (
                          inputOrigin.includes(" - ")
                            ? inputOrigin.split(" - ")[0].trim()
                            : inputOrigin.includes("(")
                              ? inputOrigin.split("(")[0].trim()
                              : inputOrigin.trim()
                        )} {" "}</div>
                        <div className="timeSlotsOuter">
                          <div
                            className={`appendBottom12 filterTimeSlots ${selectedTimeRange.includes('before6AM') ? 'selected' : ''}`}
                            onClick={() => handleTimeRangeClick('before6AM')}
                          >
                            <span
                              className="appendBottom2 checkBlockIcon"
                              style={{ backgroundImage: 'url(https://imgak.mmtcdn.com/flights/assets/media/dt/listing/left-filters/morning_inactive.png?v=1)' }}
                            ></span>
                            <div className="boldFont">Before 6 AM</div>
                          </div>

                          <div
                            className={`appendBottom12 filterTimeSlots ${selectedTimeRange.includes('6AMto12PM') ? 'selected' : ''}`}
                            onClick={() => handleTimeRangeClick('6AMto12PM')}
                          >
                            <span
                              className="appendBottom2 checkBlockIcon"
                              style={{ backgroundImage: 'url(https://imgak.mmtcdn.com/flights/assets/media/dt/listing/left-filters/noon_inactive.png?v=1)' }}
                            ></span>
                            <div className="boldFont">6 AM - 12 PM</div>
                          </div>

                          <div
                            className={`appendBottom12 filterTimeSlots ${selectedTimeRange.includes('12PMto6PM') ? 'selected' : ''}`}
                            onClick={() => handleTimeRangeClick('12PMto6PM')}
                          >
                            <span
                              className="appendBottom2 checkBlockIcon"
                              style={{ backgroundImage: 'url(https://imgak.mmtcdn.com/flights/assets/media/dt/listing/left-filters/evening_inactive.png?v=1)' }}
                            ></span>
                            <div className="boldFont">12 PM - 6 PM</div>
                          </div>

                          <div
                            className={`appendBottom12 filterTimeSlots ${selectedTimeRange.includes('after6PM') ? 'selected' : ''}`}
                            onClick={() => handleTimeRangeClick('after6PM')}
                          >
                            <span
                              className="appendBottom2 checkBlockIcon"
                              style={{ backgroundImage: 'url(https://imgak.mmtcdn.com/flights/assets/media/dt/listing/left-filters/night_inactive.png?v=1)' }}
                            ></span>
                            <div className="boldFont">After 6 PM</div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div className="side-block fly-in">
                      <div className="side-padding">
                        <div className="side-lbl">Arrival at {inputDestination && (
                          inputDestination.includes(" - ")
                            ? inputDestination.split(" - ")[0].trim()
                            : inputDestination.includes("(")
                              ? inputDestination.split("(")[0].trim()
                              : inputDestination.trim()
                        )}</div>
                        <div className="timeSlotsOuter">
                          <div
                            className={`appendBottom12 filterTimeSlots ${selectedTimeRanges.includes('before6AM') ? 'selected' : ''}`}
                            onClick={() => handleTimeRangeClicks('before6AM')}
                          >
                            <span
                              className="appendBottom2 checkBlockIcon"
                              style={{ backgroundImage: 'url(https://imgak.mmtcdn.com/flights/assets/media/dt/listing/left-filters/morning_inactive.png?v=1)' }}
                            ></span>
                            <div className="boldFont">Before 6 AM</div>
                          </div>

                          <div
                            className={`appendBottom12 filterTimeSlots ${selectedTimeRanges.includes('6AMto12PM') ? 'selected' : ''}`}
                            onClick={() => handleTimeRangeClicks('6AMto12PM')}
                          >
                            <span
                              className="appendBottom2 checkBlockIcon"
                              style={{ backgroundImage: 'url(https://imgak.mmtcdn.com/flights/assets/media/dt/listing/left-filters/noon_inactive.png?v=1)' }}
                            ></span>
                            <div className="boldFont">6 AM - 12 PM</div>
                          </div>

                          <div
                            className={`appendBottom12 filterTimeSlots ${selectedTimeRanges.includes('12PMto6PM') ? 'selected' : ''}`}
                            onClick={() => handleTimeRangeClicks('12PMto6PM')}
                          >
                            <span
                              className="appendBottom2 checkBlockIcon"
                              style={{ backgroundImage: 'url(https://imgak.mmtcdn.com/flights/assets/media/dt/listing/left-filters/evening_inactive.png?v=1)' }}
                            ></span>
                            <div className="boldFont">12 PM - 6 PM</div>
                          </div>

                          <div
                            className={`appendBottom12 filterTimeSlots ${selectedTimeRanges.includes('after6PM') ? 'selected' : ''}`}
                            onClick={() => handleTimeRangeClicks('after6PM')}
                          >
                            <span
                              className="appendBottom2 checkBlockIcon"
                              style={{ backgroundImage: 'url(https://imgak.mmtcdn.com/flights/assets/media/dt/listing/left-filters/night_inactive.png?v=1)' }}
                            ></span>
                            <div className="boldFont">After 6 PM</div>
                          </div>
                        </div>
                      </div>
                    </div>


                    <div className="side-block fly-in">
                      <div className="side-stars">
                        <div className="side-padding">
                          <div className="side-lbl">Airlines</div>

                          {SegmentList &&
                            SegmentList.length > 0 &&
                            [...new Set(SegmentList.map((SegmentListinfo) => SegmentListinfo['$']['Carrier']))].map(
                              (carrier, index) => (
                                <div className="checkbox" key={index}>
                                  <input
                                    type="checkbox"
                                    id={`myCheck_${index}`}
                                    name="airline"
                                    value={carrier}
                                    style={{ width: '17px', height: '30px' }}
                                    onChange={() => handleAirlineCheckboxChange(carrier)}
                                    checked={selectedAirlines.includes(carrier)}
                                  />
                                  <label htmlFor={`myCheck_${index}`} className="airline-label">
                                    <img
                                      src={`https://devapi.taxivaxi.com/airline_logo_images/${carrier}.png`}
                                      alt={`${carrier} logo`}
                                      className="airline-logo"
                                      onError={(e) => e.target.style.display = 'none'} // Hide broken images
                                    />
                                    {handleAirline(carrier)}
                                  </label>
                                </div>
                              )
                            )}
                        </div>
                      </div>
                    </div>
                    {formData.bookingType === "Return" && (
                      <div className="side-block fly-in">
                        <div className="side-stars">
                          <div className="side-padding">
                            <div className="side-lbl">Airlines </div>

                            {SegmentList &&
                              SegmentList.length > 0 &&
                              [...new Set(SegmentList.map((SegmentListinfo) => SegmentListinfo['$']['Carrier']))].map(
                                (carrier, index) => (
                                  <React.Fragment key={index}>
                                    <div className="checkbox">
                                      <input
                                        type="checkbox"
                                        id={`myCheck_${index}`}
                                        name="airline"
                                        value={carrier}
                                        onChange={() => handlereturnAirlineCheckboxChange(carrier)}
                                        checked={selectedreturnAirlines.includes(carrier)}
                                      />
                                      <label htmlFor={`myCheck_${index}`} className="airline-label">
                                        <img
                                          src={`https://devapi.taxivaxi.com/airline_logo_images/${carrier}.png`}
                                          alt={`${carrier} logo`}
                                          className="airline-logo"
                                          onError={(e) => e.target.style.display = 'none'} // Hide broken images
                                        />
                                        {handleAirline(carrier)}
                                      </label>
                                      {/* <label htmlFor={`myCheck_${index}`}>{handleAirline(carrier)}</label> */}
                                    </div>
                                  </React.Fragment>
                                )
                              )}
                          </div>
                        </div>
                      </div>
                    )}

                    <div className="side-block fly-in">
                      <div className="side-price">
                        <div className="price-ammounts">
                          <p className="price-ammountsp">
                            <label htmlFor="amount" className="side-lbl">
                              Price range:
                            </label>

                          </p>
                        </div>
                        <div className="price-ranger">
                          <Slider
                            min={minvalue}
                            max={maxvalue}
                            range
                            value={priceRange}
                            onChange={handlePriceChange}
                          // marks={{ [minvalue]: `${minvalue}`, [maxvalue]: `${maxvalue}` }}
                          />
                        </div>
                        <div className="price-ammounts">
                          <input type="text" id="ammount-from" value={`${priceRange[0]}`} readOnly />
                          <input type="text" id="ammount-to" value={`${priceRange[1]}`} readOnly />
                          <div className="clear" />
                        </div>
                      </div>
                    </div>
                    <div className="side-block fly-in">
                      <button className="scrolltotop" type="button" onClick={handleScrollToTop}>Scroll To Top</button>
                    </div>

                  </>
                }
              </div>

              {/* sidebar end */}
              <div className="two-colls-right">
                <div className="two-colls-right-b">
                  <div className="padding">
                    <div className="catalog-row" id="catalog">

                      {flightOptions && flightOptions.length > 0 ? (
                        <>
                          <div className='row catalog_filters'>

                            <div className='col-md-2 departurefilter' onClick={() => handleSortingCriterionClick('3')}
                              style={{ opacity: sortingCriterion === '3' ? '1' : '0.5' }}>
                              Departure {sortingCriterion === '3' && (sortDirection === 'asc' ? 'â†“' : 'â†‘')}
                            </div>
                            <div className='col-md-3 travelfilter' onClick={() => handleSortingCriterionClick('2')}
                              style={{ opacity: sortingCriterion === '2' ? '1' : '0.5' }}>
                              Travel Time {sortingCriterion === '2' && (sortDirection === 'asc' ? 'â†“' : 'â†‘')}
                            </div>
                            <div className='col-md-2 arriavelfilter' onClick={() => handleSortingCriterionClick('4')}
                              style={{ opacity: sortingCriterion === '4' ? '1' : '0.5' }}>
                              Arrival {sortingCriterion === '4' && (sortDirection === 'asc' ? 'â†“' : 'â†‘')}
                            </div>

                            <div className='col-md-2 stopsfilter' onClick={() => handleSortingCriterionClick('5')}
                              style={{ opacity: sortingCriterion === '5' ? '1' : '0.5' }}>
                              Stops {sortingCriterion === '5' && (sortDirection === 'asc' ? 'â†“' : 'â†‘')}
                            </div>
                            <div
                              className="col-md-3 pricefilter"
                              onClick={() => handleSortingCriterionClick('1')}
                              style={{ opacity: sortingCriterion === '1' ? '1' : '0.5' }}
                            >
                              Price {sortingCriterion === '1' && (sortDirection === 'asc' ? 'â†“' : 'â†‘')}
                            </div>
                          </div>



                          {filteredFlights.map(pricepoint => {
                            {/* console.log('pricepoint', pricepoint); */ }
                            pricepoint.price = parseFloat(pricepoint.$.TotalPrice.replace(/[^\d.]/g, ''));
                            let result = {};
                            pricepoint['air:AirPricingInfo'] && (
                              Array.isArray(pricepoint['air:AirPricingInfo'])
                                ? (
                                  <>
                                    {
                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0] &&
                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'] && (
                                        Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'])
                                          ? (
                                            <>
                                              {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'] &&
                                                Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'])
                                                ? (

                                                  <>
                                                    {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                      <div key={bookingindex}>
                                                        {bookingInfo['$'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                            ) {
                                                              result.travelTime = segmentinfo['$']['DepartureTime'];
                                                              result.return = segmentinfo['$']['ArrivalTime'];
                                                              result.departure = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['$']['TravelTime'];
                                                              result.stops = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].length - 1;
                                                            }
                                                            return result;

                                                          })
                                                        }


                                                      </div>
                                                    ))}
                                                  </>
                                                ) : (
                                                  <>
                                                    {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                        if (
                                                          segmentinfo['$'] &&
                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                        ) {
                                                          result.travelTime = segmentinfo['$']['DepartureTime'];
                                                          result.return = segmentinfo['$']['ArrivalTime'];
                                                          result.departure = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['$']['TravelTime'];
                                                          result.stops = 0;
                                                        }
                                                        return result;



                                                      })
                                                    }


                                                  </>
                                                )
                                              }
                                            </>
                                          ) : (
                                            <>
                                              {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'] &&
                                                Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'])
                                                ? (
                                                  <>
                                                    {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                      <div key={bookingindex}>
                                                        {bookingInfo['$'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                              result.travelTime = segmentinfo['$']['DepartureTime'];
                                                              result.return = segmentinfo['$']['ArrivalTime'];
                                                              result.departure = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['$']['TravelTime'];
                                                              result.stops = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].length - 1;
                                                            }
                                                            return result;


                                                          })
                                                        }


                                                      </div>
                                                    ))}
                                                  </>
                                                ) : (
                                                  <>
                                                    {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$'] &&
                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                        if (
                                                          segmentinfo['$'] &&
                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef']) {
                                                          result.travelTime = segmentinfo['$']['DepartureTime'];
                                                          result.return = segmentinfo['$']['ArrivalTime'];
                                                          result.departure = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['$']['TravelTime'];
                                                          result.stops = 0;
                                                        }
                                                        return result;


                                                      })
                                                    }
                                                  </>
                                                )
                                              }
                                            </>
                                          )
                                      )
                                    }

                                  </>
                                ) : (
                                  <>
                                    {
                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0] &&
                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'] && (
                                        Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'])
                                          ? (
                                            <>
                                              {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'] &&
                                                Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'])
                                                ? (
                                                  <>
                                                    {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                      <div key={bookingindex}>
                                                        {bookingInfo['$'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                              result.travelTime = segmentinfo['$']['DepartureTime'];
                                                              result.return = segmentinfo['$']['ArrivalTime'];
                                                              result.departure = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['$']['TravelTime'];
                                                              result.stops = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].length - 1;
                                                            }
                                                            return result;

                                                          })
                                                        }


                                                      </div>
                                                    ))}
                                                  </>
                                                ) : (
                                                  <>
                                                    {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                        if (
                                                          segmentinfo['$'] &&
                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']) {
                                                          result.travelTime = segmentinfo['$']['DepartureTime'];
                                                          result.return = segmentinfo['$']['ArrivalTime'];
                                                          result.departure = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['$']['TravelTime'];
                                                          result.stops = 0;
                                                        }
                                                        return result;



                                                      })
                                                    }


                                                  </>
                                                )
                                              }
                                            </>
                                          ) : (
                                            <>
                                              {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'] &&
                                                Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'])
                                                ? (
                                                  <>
                                                    {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                      <div key={bookingindex}>
                                                        {bookingInfo['$'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                              result.travelTime = segmentinfo['$']['DepartureTime'];
                                                              result.return = segmentinfo['$']['ArrivalTime'];
                                                              result.departure = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['$']['TravelTime'];
                                                              result.stops = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].length - 1;
                                                            }
                                                            return result;

                                                          })
                                                        }


                                                      </div>
                                                    ))}
                                                  </>
                                                ) : (
                                                  <>
                                                    {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$'] &&
                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                        if (
                                                          segmentinfo['$'] &&
                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef']) {
                                                          result.travelTime = segmentinfo['$']['DepartureTime'];
                                                          result.return = segmentinfo['$']['ArrivalTime'];
                                                          result.departure = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['$']['TravelTime'];
                                                          result.stops = 0;
                                                        }
                                                        return result;



                                                      })
                                                    }
                                                  </>
                                                )
                                              }
                                            </>
                                          )
                                      )
                                    }

                                  </>
                                )
                            )

                            pricepoint['air:AirPricingInfo'] && (
                              Array.isArray(pricepoint['air:AirPricingInfo'])
                                ? (
                                  <>
                                    {

                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'] &&
                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'] && (
                                        Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'])
                                          ? (
                                            <>

                                              {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'] &&
                                                Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'])
                                                ? (

                                                  <>
                                                    {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                      <div key={bookingindex}>
                                                        {bookingInfo['$'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                            ) {
                                                              result.travelTime = segmentinfo['$']['DepartureTime'];
                                                              result.return = segmentinfo['$']['ArrivalTime'];
                                                              result.departure = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['$']['TravelTime'];
                                                              result.stops = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].length - 1;
                                                            }
                                                            return result;

                                                          })
                                                        }


                                                      </div>
                                                    ))}
                                                  </>
                                                ) : (
                                                  <>
                                                    {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$'] &&
                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                        if (
                                                          segmentinfo['$'] &&
                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                        ) {
                                                          result.travelTime = segmentinfo['$']['DepartureTime'];
                                                          result.return = segmentinfo['$']['ArrivalTime'];
                                                          result.departure = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['$']['TravelTime'];
                                                          result.stops = 0;
                                                        }
                                                        return result;



                                                      })
                                                    }


                                                  </>
                                                )
                                              }
                                            </>
                                          ) : (
                                            <>
                                              {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'] &&
                                                Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'])
                                                ? (
                                                  <>
                                                    {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                      <div key={bookingindex}>
                                                        {bookingInfo['$'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                              result.travelTime = segmentinfo['$']['DepartureTime'];
                                                              result.return = segmentinfo['$']['ArrivalTime'];
                                                              result.departure = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['$']['TravelTime'];
                                                              result.stops = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].length - 1;
                                                            }
                                                            return result;


                                                          })
                                                        }


                                                      </div>
                                                    ))}
                                                  </>
                                                ) : (
                                                  <>
                                                    {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$'] &&
                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                        if (
                                                          segmentinfo['$'] &&
                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef']) {
                                                          result.travelTime = segmentinfo['$']['DepartureTime'];
                                                          result.return = segmentinfo['$']['ArrivalTime'];
                                                          result.departure = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['$']['TravelTime'];
                                                          result.stops = 0;
                                                        }
                                                        return result;


                                                      })
                                                    }
                                                  </>
                                                )
                                              }
                                            </>
                                          )
                                      )
                                    }

                                  </>
                                ) : (
                                  <>
                                    {
                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'] &&
                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'] && (
                                        Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'])
                                          ? (
                                            <>
                                              {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'] &&
                                                Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'])
                                                ? (
                                                  <>
                                                    {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                      <div key={bookingindex}>
                                                        {bookingInfo['$'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                              result.travelTime = segmentinfo['$']['DepartureTime'];
                                                              result.return = segmentinfo['$']['ArrivalTime'];
                                                              result.departure = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['$']['TravelTime'];
                                                              result.stops = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].length - 1;
                                                            }
                                                            return result;

                                                          })
                                                        }


                                                      </div>
                                                    ))}
                                                  </>
                                                ) : (
                                                  <>
                                                    {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$'] &&
                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                        if (
                                                          segmentinfo['$'] &&
                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']) {
                                                          result.travelTime = segmentinfo['$']['DepartureTime'];
                                                          result.return = segmentinfo['$']['ArrivalTime'];
                                                          result.departure = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['$']['TravelTime'];
                                                          result.stops = 0;
                                                        }
                                                        return result;



                                                      })
                                                    }


                                                  </>
                                                )
                                              }
                                            </>
                                          ) : (
                                            <>
                                              {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'] &&
                                                Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'])
                                                ? (
                                                  <>
                                                    {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                      <div key={bookingindex}>
                                                        {bookingInfo['$'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                              result.travelTime = segmentinfo['$']['DepartureTime'];
                                                              result.return = segmentinfo['$']['ArrivalTime'];
                                                              result.departure = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['$']['TravelTime'];
                                                              result.stops = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].length - 1;

                                                            }
                                                            return result;

                                                          })
                                                        }


                                                      </div>
                                                    ))}
                                                  </>
                                                ) : (
                                                  <>
                                                    {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$'] &&
                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                        if (
                                                          segmentinfo['$'] &&
                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef']) {
                                                          result.travelTime = segmentinfo['$']['DepartureTime'];
                                                          result.return = segmentinfo['$']['ArrivalTime'];
                                                          result.departure = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['$']['TravelTime'];
                                                          result.stops = 0;
                                                        }
                                                        return result;



                                                      })
                                                    }
                                                  </>
                                                )
                                              }
                                            </>
                                          )
                                      )
                                    }

                                  </>
                                )
                            )

                            pricepoint.travelTime = calculateTravelTime(result.departure);
                            pricepoint.departure = calculateDepartureTime(result.travelTime);
                            pricepoint.return = calculateDepartureTime(result.return);
                            pricepoint.stops = result.stops;
                            {/* console.log('test', pricepoint); */ }
                            return pricepoint;

                          })
                            .sort((a, b) => {
                              switch (sortingCriterion) {
                                case '1': // Sorting by price
                                  return sortDirection === 'asc' ? a.price - b.price : b.price - a.price;

                                  {/* case '1':
                                  return a.price - b.price; */}
                                case '2':
                                  {/* return a.travelTime - b.travelTime; */ }
                                  return sortDirection === 'asc' ? a.travelTime - b.travelTime : b.travelTime - a.travelTime;
                                case '3':
                                  const [aHours] = a.departure.split(':').map(Number);
                                  const [bHours] = b.departure.split(':').map(Number);


                                  return sortDirection === 'asc' ? aHours - bHours : bHours - aHours;
                                case '4':
                                  const [arHours] = a.return.split(':').map(Number);
                                  const [brHours] = b.return.split(':').map(Number);

                                  return sortDirection === 'asc' ? arHours - brHours : brHours - arHours;
                                case '5':
                                  return sortDirection === 'asc' ? a.stops - b.stops : b.stops - a.stops;
                                default:
                                  {/* return 0; */ }
                              }
                            }).map((pricepoint, priceindex) => {
                              {/* console.log('price', pricepoint); */ }
                              const totalPrice = parseFloat(pricepoint.$.TotalPrice.replace(/[^\d.]/g, ''));
                              {/* console.log('totalPrice',totalPrice); */ }
                              let result = {};
                              {
                                pricepoint['air:AirPricingInfo'] && (
                                  Array.isArray(pricepoint['air:AirPricingInfo'])
                                    ? (
                                      <>
                                        {
                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0] &&
                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'] && (
                                            Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'])
                                              ? (
                                                <>
                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'])
                                                    ? (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                          <div key={bookingindex}>
                                                            {bookingInfo['$'] &&
                                                              SegmentList.map((segmentinfo, segmentindex) => {
                                                                if (
                                                                  segmentinfo['$'] &&
                                                                  segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                ) {
                                                                  result.carrier = segmentinfo['$']['Carrier'];
                                                                  result.stop = bookingindex;
                                                                }
                                                                return result;
                                                              })
                                                            }
                                                          </div>
                                                        ))}
                                                      </>
                                                    ) : (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                            ) {
                                                              result.carrier = segmentinfo['$']['Carrier'];
                                                              result.stop = 0;
                                                            }
                                                            return result;
                                                          })
                                                        }
                                                      </>
                                                    )
                                                  }
                                                </>
                                              ) : (
                                                <>
                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'])
                                                    ? (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                          <div key={bookingindex}>
                                                            {bookingInfo['$'] &&
                                                              SegmentList.map((segmentinfo, segmentindex) => {

                                                                if (
                                                                  segmentinfo['$'] &&
                                                                  segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                  result.carrier = segmentinfo['$']['Carrier'];
                                                                  result.stop = bookingindex;
                                                                }
                                                                return result;


                                                              })
                                                            }


                                                          </div>
                                                        ))}
                                                      </>
                                                    ) : (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$'] &&
                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef']) {
                                                              result.carrier = segmentinfo['$']['Carrier'];
                                                              result.stop = 0;
                                                            }
                                                            return result;


                                                          })
                                                        }
                                                      </>
                                                    )
                                                  }
                                                </>
                                              )
                                          )
                                        }

                                      </>
                                    ) : (
                                      <>
                                        {
                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0] &&
                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'] && (
                                            Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'])
                                              ? (
                                                <>
                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'])
                                                    ? (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                          <div key={bookingindex}>
                                                            {bookingInfo['$'] &&
                                                              SegmentList.map((segmentinfo, segmentindex) => {
                                                                if (
                                                                  segmentinfo['$'] &&
                                                                  segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                  result.carrier = segmentinfo['$']['Carrier'];
                                                                  result.stop = bookingindex;
                                                                }
                                                                return result;

                                                              })
                                                            }


                                                          </div>
                                                        ))}
                                                      </>
                                                    ) : (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']) {
                                                              result.carrier = segmentinfo['$']['Carrier'];
                                                              result.stop = 0;
                                                            }
                                                            return result;



                                                          })
                                                        }


                                                      </>
                                                    )
                                                  }
                                                </>
                                              ) : (
                                                <>
                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'])
                                                    ? (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                          <div key={bookingindex}>
                                                            {bookingInfo['$'] &&
                                                              SegmentList.map((segmentinfo, segmentindex) => {
                                                                if (
                                                                  segmentinfo['$'] &&
                                                                  segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                  result.carrier = segmentinfo['$']['Carrier'];
                                                                  result.stop = bookingindex;
                                                                }
                                                                return result;

                                                              })
                                                            }


                                                          </div>
                                                        ))}
                                                      </>
                                                    ) : (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$'] &&
                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef']) {
                                                              result.carrier = segmentinfo['$']['Carrier'];
                                                              result.stop = 0;
                                                            }
                                                            return result;



                                                          })
                                                        }
                                                      </>
                                                    )
                                                  }
                                                </>
                                              )
                                          )
                                        }

                                      </>
                                    )
                                )
                              }
                              {
                                pricepoint['air:AirPricingInfo'] && (
                                  Array.isArray(pricepoint['air:AirPricingInfo'])
                                    ? (
                                      <>
                                        {
                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1] &&
                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'] && (
                                            Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'])
                                              ? (
                                                <>
                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'])
                                                    ? (

                                                      <>
                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                          <div key={bookingindex}>
                                                            {bookingInfo['$'] &&
                                                              SegmentList.map((segmentinfo, segmentindex) => {
                                                                if (
                                                                  segmentinfo['$'] &&
                                                                  segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                ) {
                                                                  result.returncarrier = segmentinfo['$']['Carrier'];
                                                                  result.returnstop = bookingindex;
                                                                }
                                                                return result;

                                                              })
                                                            }


                                                          </div>
                                                        ))}
                                                      </>
                                                    ) : (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                            ) {
                                                              result.returncarrier = segmentinfo['$']['Carrier'];
                                                              result.returnstop = 0;
                                                            }
                                                            return result;



                                                          })
                                                        }


                                                      </>
                                                    )
                                                  }
                                                </>
                                              ) : (
                                                <>
                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'])
                                                    ? (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                          <div key={bookingindex}>
                                                            {bookingInfo['$'] &&
                                                              SegmentList.map((segmentinfo, segmentindex) => {

                                                                if (
                                                                  segmentinfo['$'] &&
                                                                  segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                  result.returncarrier = segmentinfo['$']['Carrier'];
                                                                  result.returnstop = bookingindex;
                                                                }
                                                                return result;


                                                              })
                                                            }


                                                          </div>
                                                        ))}
                                                      </>
                                                    ) : (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$'] &&
                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef']) {
                                                              result.returncarrier = segmentinfo['$']['Carrier'];
                                                              result.returnstop = 0;
                                                            }
                                                            return result;


                                                          })
                                                        }
                                                      </>
                                                    )
                                                  }
                                                </>
                                              )
                                          )
                                        }

                                      </>
                                    ) : (
                                      <>
                                        {
                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1] &&
                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'] && (
                                            Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'])
                                              ? (
                                                <>
                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'])
                                                    ? (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                          <div key={bookingindex}>
                                                            {bookingInfo['$'] &&
                                                              SegmentList.map((segmentinfo, segmentindex) => {
                                                                if (
                                                                  segmentinfo['$'] &&
                                                                  segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                  result.returncarrier = segmentinfo['$']['Carrier'];
                                                                  result.returnstop = bookingindex;
                                                                }
                                                                return result;

                                                              })
                                                            }


                                                          </div>
                                                        ))}
                                                      </>
                                                    ) : (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']) {
                                                              result.returncarrier = segmentinfo['$']['Carrier'];
                                                              result.returnstop = 0;
                                                            }
                                                            return result;



                                                          })
                                                        }


                                                      </>
                                                    )
                                                  }
                                                </>
                                              ) : (
                                                <>
                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'])
                                                    ? (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                          <div key={bookingindex}>
                                                            {bookingInfo['$'] &&
                                                              SegmentList.map((segmentinfo, segmentindex) => {
                                                                if (
                                                                  segmentinfo['$'] &&
                                                                  segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                  result.returncarrier = segmentinfo['$']['Carrier'];
                                                                  result.returnstop = bookingindex;
                                                                }
                                                                return result;

                                                              })
                                                            }


                                                          </div>
                                                        ))}
                                                      </>
                                                    ) : (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$'] &&
                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef']) {
                                                              result.returncarrier = segmentinfo['$']['Carrier'];
                                                              result.returnstop = 0;
                                                            }
                                                            return result;



                                                          })
                                                        }
                                                      </>
                                                    )
                                                  }
                                                </>
                                              )
                                          )
                                        }

                                      </>
                                    )
                                )
                              }
                              {
                                pricepoint['air:AirPricingInfo'] && (
                                  Array.isArray(pricepoint['air:AirPricingInfo'])
                                    ? (
                                      <>
                                        {
                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'] &&
                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'] && (
                                            Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'])
                                              ? (
                                                <>
                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'])
                                                    ? (

                                                      <>
                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                          <div key={bookingindex}>
                                                            {bookingInfo['$'] &&
                                                              SegmentList.map((segmentinfo, segmentindex) => {
                                                                if (
                                                                  segmentinfo['$'] &&
                                                                  segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                ) {
                                                                  result.carrier = segmentinfo['$']['Carrier'];
                                                                  result.stop = bookingindex;
                                                                }
                                                                return result;

                                                              })
                                                            }


                                                          </div>
                                                        ))}
                                                      </>
                                                    ) : (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$'] &&
                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                            ) {
                                                              result.carrier = segmentinfo['$']['Carrier'];
                                                              result.stop = 0;
                                                            }
                                                            return result;



                                                          })
                                                        }


                                                      </>
                                                    )
                                                  }
                                                </>
                                              ) : (
                                                <>
                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'])
                                                    ? (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                          <div key={bookingindex}>
                                                            {bookingInfo['$'] &&
                                                              SegmentList.map((segmentinfo, segmentindex) => {

                                                                if (
                                                                  segmentinfo['$'] &&
                                                                  segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                  result.carrier = segmentinfo['$']['Carrier'];
                                                                  result.stop = bookingindex;
                                                                }
                                                                return result;


                                                              })
                                                            }


                                                          </div>
                                                        ))}
                                                      </>
                                                    ) : (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$'] &&
                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef']) {
                                                              result.carrier = segmentinfo['$']['Carrier'];
                                                              result.stop = 0;
                                                            }
                                                            return result;


                                                          })
                                                        }
                                                      </>
                                                    )
                                                  }
                                                </>
                                              )
                                          )
                                        }

                                      </>
                                    ) : (
                                      <>
                                        {
                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'] &&
                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'] && (
                                            Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'])
                                              ? (
                                                <>
                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'])
                                                    ? (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                          <div key={bookingindex}>
                                                            {bookingInfo['$'] &&
                                                              SegmentList.map((segmentinfo, segmentindex) => {
                                                                if (
                                                                  segmentinfo['$'] &&
                                                                  segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                  result.carrier = segmentinfo['$']['Carrier'];
                                                                  result.stop = bookingindex;
                                                                }
                                                                return result;

                                                              })
                                                            }


                                                          </div>
                                                        ))}
                                                      </>
                                                    ) : (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$'] &&
                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']) {
                                                              result.carrier = segmentinfo['$']['Carrier'];
                                                              result.stop = 0;
                                                            }
                                                            return result;



                                                          })
                                                        }


                                                      </>
                                                    )
                                                  }
                                                </>
                                              ) : (
                                                <>
                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'] &&
                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'])
                                                    ? (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                          <div key={bookingindex}>
                                                            {bookingInfo['$'] &&
                                                              SegmentList.map((segmentinfo, segmentindex) => {
                                                                if (
                                                                  segmentinfo['$'] &&
                                                                  segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                  result.carrier = segmentinfo['$']['Carrier'];
                                                                  result.stop = bookingindex;
                                                                }
                                                                return result;

                                                              })
                                                            }


                                                          </div>
                                                        ))}
                                                      </>
                                                    ) : (
                                                      <>
                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$'] &&
                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                            if (
                                                              segmentinfo['$'] &&
                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef']) {
                                                              result.carrier = segmentinfo['$']['Carrier'];
                                                              result.stop = 0;
                                                            }
                                                            return result;



                                                          })
                                                        }
                                                      </>
                                                    )
                                                  }
                                                </>
                                              )
                                          )
                                        }

                                      </>
                                    )
                                )
                              }

                              const departuretimeCheck = selectedTimeRange.length === 0 || (() => {
                                const bookingInfo = pricepoint['air:AirPricingInfo']
                                  ?.['air:FlightOptionsList']
                                  ?.['air:FlightOption']
                                  ?.['air:Option']
                                  ?.['air:BookingInfo'];

                                if (!bookingInfo) return false;

                                // Get the SegmentRef (handle both array and single object cases)
                                const firstSegmentRef = Array.isArray(bookingInfo)
                                  ? bookingInfo[0]?.['$']?.['SegmentRef'] // First segment for connecting flights
                                  : bookingInfo?.['$']?.['SegmentRef']; // Direct flight case

                                if (!firstSegmentRef) return false;

                                // Find the matching segment in SegmentList
                                const firstSegment = SegmentList.find(segment => segment['$']?.['Key'] === firstSegmentRef);

                                if (!firstSegment) return false;

                                // Extract departure time in ISO format
                                const departureTimeISO = firstSegment['$']['DepartureTime'];
                                if (!departureTimeISO) return false;

                                // Convert ISO string to Date object
                                const departureDate = new Date(departureTimeISO);

                                if (isNaN(departureDate.getTime())) {
                                  console.error("Invalid date extracted from DepartureTime:", departureTimeISO);
                                  return false;
                                }

                                // Extract hour in local time
                                const hour = departureDate.getHours();

                                // Check if the departure time matches any selected range
                                return selectedTimeRange.some((range) => {
                                  switch (range) {
                                    case 'before6AM': return hour < 6;
                                    case '6AMto12PM': return hour >= 6 && hour < 12;
                                    case '12PMto6PM': return hour >= 12 && hour < 18;
                                    case 'after6PM': return hour >= 18;
                                    default: return false;
                                  }
                                });
                              })();


                              const arrivaltimeCheck = selectedTimeRanges.length === 0 || (() => {
                                const [hour] = pricepoint['return'].split(':').map(Number); // Extract hour as a number

                                return selectedTimeRanges.some((range) => {
                                  switch (range) {
                                    case 'before6AM':
                                      return hour < 6;
                                    case '6AMto12PM':
                                      return hour >= 6 && hour < 12;
                                    case '12PMto6PM':
                                      return hour >= 12 && hour < 18;
                                    case 'after6PM':
                                      return hour >= 18;
                                    default:
                                      return false;
                                  }
                                });
                              })();

                              const airlineCheck = selectedAirlines.length === 0 || selectedAirlines.includes(result['carrier']);
                              const airlinereturnCheck = selectedreturnAirlines.length === 0 || selectedreturnAirlines.includes(result['returncarrier']);
                              const stopsCheck = selectedStops.length === 0 || selectedStops.includes(result['stop']);
                              const stopsreturnCheck = selectedreturnStops.length === 0 || selectedreturnStops.includes(result['returnstop']);
                              if (airlineCheck && airlinereturnCheck && stopsCheck && stopsreturnCheck && arrivaltimeCheck && departuretimeCheck) {
                                if (totalPrice >= priceRange[0] && totalPrice <= priceRange[1]) {
                                  flightsMatched = true;
                                  {/* console.log('pricepoint', pricepoint); */ }
                                  return (
                                    <React.Fragment key={priceindex}>
                                      <form onSubmit={(e) => handlePriceSubmit(e, priceindex, pricepoint['$']['Taxes'])}>
                                        <div key={priceindex}>
                                          {pricepoint && pricepoint['air:AirPricingInfo'] && (
                                            (pricepoint['air:AirPricingInfo'][0]?.['air:FlightOptionsList']?.['air:FlightOption'] && Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'])) ||
                                            (pricepoint['air:AirPricingInfo']?.['air:FlightOptionsList']?.['air:FlightOption'] && Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']))
                                          ) ? (
                                            <div>

                                              <div
                                                className={`flight-item fly-in ${selectedFlights.some(
                                                  (selectedFlight) =>
                                                    selectedFlight["$"].Key === pricepoint["air:AirPricingInfo"]["$"].Key &&
                                                    selectedFlight.isReturn === pricepoint["air:AirPricingInfo"].isReturn
                                                )
                                                  ? "selected-flight"
                                                  : ""
                                                  }`}
                                                data-price={6521}
                                                data-departure={1}
                                                data-duration={1}
                                                data-category="myCheckAI checkclassEconomy"
                                                id="textAI"
                                                data-category1="stop0"
                                                style={{ display: "block" }}

                                              >
                                                <div className="flt-i-a">
                                                  <div className="flt-i-b">
                                                    <div className="flt-i-bb">
                                                      <div className="flt-l-a">
                                                        <div className="flt-l-b">
                                                          <div className="way-lbl">departure</div>
                                                          <div className="company">
                                                            {pricepoint['air:AirPricingInfo'] && (
                                                              Array.isArray(pricepoint['air:AirPricingInfo'])
                                                                ? (
                                                                  <div style={{ width: '95%' }}>
                                                                    {
                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'] &&
                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'] && (
                                                                        Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'])
                                                                          ? (
                                                                            <div>
                                                                              {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'] &&
                                                                                Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'])
                                                                                ? (

                                                                                  <div>
                                                                                    {(() => {
                                                                                      const uniqueCarriers1 = new Set();
                                                                                      return (
                                                                                        pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                          <div key={bookingindex}>
                                                                                            {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                              if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                uniqueCarriers1.add(segmentinfo['$']['Carrier']);

                                                                                              }
                                                                                            })}
                                                                                          </div>

                                                                                        )),
                                                                                        Array.from(uniqueCarriers1).map((carrier, index) => (
                                                                                          <div key={index}>
                                                                                            <div className="airline-container">
                                                                                              <img
                                                                                                className={`airlineimg${index}`}
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${carrier}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              />
                                                                                              <span className="flightnumber">{handleAirline(carrier)}</span>
                                                                                            </div><br />
                                                                                            <div>
                                                                                              {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                                <div key={bookingindex}>
                                                                                                  {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef'] && segmentinfo['$']['Carrier'] === carrier) {
                                                                                                      return (
                                                                                                        <span key={segmentindex} className='flightnumber'>
                                                                                                          {bookingindex > 0 && ', '}
                                                                                                          {segmentinfo['$']['Carrier']} {segmentinfo['$']['FlightNumber']}
                                                                                                        </span>
                                                                                                      );
                                                                                                    }
                                                                                                  })}
                                                                                                </div>
                                                                                              ))}
                                                                                            </div>

                                                                                          </div>
                                                                                        ))
                                                                                      );
                                                                                    })()}

                                                                                  </div>
                                                                                ) : (
                                                                                  <div>
                                                                                    {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                      SegmentList.map((segmentinfo, segmentindex) => {

                                                                                        if (
                                                                                          segmentinfo['$'] &&
                                                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']

                                                                                        ) {

                                                                                          return (
                                                                                            <div key={segmentindex}>
                                                                                              <img
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${segmentinfo['$']['Carrier']}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              /><br />
                                                                                              <span className='flightnumber1'>
                                                                                                {handleAirline(segmentinfo['$']['Carrier'])}<br />
                                                                                                {segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']}
                                                                                              </span>
                                                                                            </div>
                                                                                          );
                                                                                        }
                                                                                      })
                                                                                    }
                                                                                  </div>
                                                                                )
                                                                              }
                                                                            </div>
                                                                          ) : (
                                                                            <div>
                                                                              {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'] &&
                                                                                Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'])
                                                                                ? (
                                                                                  <div>
                                                                                    {(() => {
                                                                                      const uniqueCarriers2 = new Set();
                                                                                      return (
                                                                                        pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                          <div key={bookingindex}>
                                                                                            {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                              if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                uniqueCarriers2.add(segmentinfo['$']['Carrier']);

                                                                                              }
                                                                                            })}
                                                                                          </div>
                                                                                        )),
                                                                                        Array.from(uniqueCarriers2).map((carrier, index) => (
                                                                                          <div key={index}>
                                                                                            <div className="airline-container">
                                                                                              <img
                                                                                                className={`airlineimg${index}`}
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${carrier}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              />
                                                                                              <span className="flightnumber">{handleAirline(carrier)}</span>
                                                                                            </div><br />
                                                                                            <div>
                                                                                              {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                                <div key={bookingindex}>
                                                                                                  {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef'] && segmentinfo['$']['Carrier'] === carrier) {
                                                                                                      return (
                                                                                                        <span key={segmentindex} className='flightnumber'>
                                                                                                          {bookingindex > 0 && ', '}
                                                                                                          {segmentinfo['$']['Carrier']} {segmentinfo['$']['FlightNumber']}
                                                                                                        </span>
                                                                                                      );
                                                                                                    }
                                                                                                  })}
                                                                                                </div>
                                                                                              ))}
                                                                                            </div>

                                                                                          </div>
                                                                                        ))
                                                                                      );
                                                                                    })()}
                                                                                  </div>
                                                                                ) : (
                                                                                  <div>
                                                                                    {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                      SegmentList.map((segmentinfo, segmentindex) => {

                                                                                        if (
                                                                                          segmentinfo['$'] &&
                                                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                        ) {

                                                                                          return (
                                                                                            <div key={segmentindex}>
                                                                                              <img
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${segmentinfo['$']['Carrier']}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              /><br />
                                                                                              <span className='flightnumber1'>
                                                                                                {handleAirline(segmentinfo['$']['Carrier'])}<br />
                                                                                                ,{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']}
                                                                                              </span>
                                                                                            </div>
                                                                                          );
                                                                                        }
                                                                                      })
                                                                                    }
                                                                                  </div>
                                                                                )
                                                                              }
                                                                            </div>
                                                                          )
                                                                      )
                                                                    }
                                                                  </div>
                                                                ) : (
                                                                  <div style={{ width: '95%' }}>
                                                                    {
                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'] &&
                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'] && (
                                                                        Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'])
                                                                          ? (
                                                                            <div>
                                                                              {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'] &&
                                                                                Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'])
                                                                                ? (
                                                                                  <div>
                                                                                    {(() => {
                                                                                      const uniqueCarriers3 = new Set();
                                                                                      return (
                                                                                        pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                          <div key={bookingindex} >

                                                                                            {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                              if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                uniqueCarriers3.add(segmentinfo['$']['Carrier']);
                                                                                              }
                                                                                            })}

                                                                                          </div>
                                                                                        )),
                                                                                        Array.from(uniqueCarriers3).map((carrier, index) => (
                                                                                          <div key={index}>
                                                                                            <div className="airline-container">
                                                                                              <img
                                                                                                className={`airlineimg${index}`}
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${carrier}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              />
                                                                                              <span className="flightnumber">{handleAirline(carrier)}</span>
                                                                                            </div><br />
                                                                                            <div>
                                                                                              {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                                <div key={bookingindex}>
                                                                                                  {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef'] && segmentinfo['$']['Carrier'] === carrier) {
                                                                                                      return (
                                                                                                        <span key={segmentindex} className='flightnumber'>
                                                                                                          {bookingindex > 0 && ', '}
                                                                                                          {segmentinfo['$']['Carrier']} {segmentinfo['$']['FlightNumber']}
                                                                                                        </span>
                                                                                                      );
                                                                                                    }
                                                                                                  })}
                                                                                                </div>
                                                                                              ))}
                                                                                            </div>

                                                                                          </div>
                                                                                        ))
                                                                                      );
                                                                                    })()}
                                                                                  </div>
                                                                                ) : (
                                                                                  <div>
                                                                                    {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                      SegmentList.map((segmentinfo, segmentindex) => {

                                                                                        if (
                                                                                          segmentinfo['$'] &&
                                                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                        ) {

                                                                                          return (
                                                                                            <div key={segmentindex}>
                                                                                              <img
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${segmentinfo['$']['Carrier']}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              /><br />
                                                                                              <span className='flightnumber1'>
                                                                                                {handleAirline(segmentinfo['$']['Carrier'])}<br />
                                                                                                {segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']}
                                                                                              </span>
                                                                                            </div>
                                                                                          );
                                                                                        }
                                                                                      })
                                                                                    }
                                                                                  </div>
                                                                                )
                                                                              }
                                                                            </div>
                                                                          ) : (
                                                                            <div>
                                                                              {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'] &&
                                                                                Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'])
                                                                                ? (
                                                                                  <div>
                                                                                    {(() => {
                                                                                      const uniqueCarriers4 = new Set();
                                                                                      return (
                                                                                        pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                          <div key={bookingindex}>
                                                                                            {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                              if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                uniqueCarriers4.add(segmentinfo['$']['Carrier']);

                                                                                              }
                                                                                            })}
                                                                                          </div>
                                                                                        )),
                                                                                        Array.from(uniqueCarriers4).map((carrier, index) => (
                                                                                          <div key={index}>
                                                                                            <div className="airline-container">
                                                                                              <img
                                                                                                className={`airlineimg${index}`}
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${carrier}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              />
                                                                                              <span className="flightnumber">{handleAirline(carrier)}</span>
                                                                                            </div><br />
                                                                                            <div>
                                                                                              {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                                <div key={bookingindex}>
                                                                                                  {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef'] && segmentinfo['$']['Carrier'] === carrier) {
                                                                                                      return (
                                                                                                        <span key={segmentindex} className='flightnumber'>
                                                                                                          {bookingindex > 0 && ', '}
                                                                                                          {segmentinfo['$']['Carrier']} {segmentinfo['$']['FlightNumber']}
                                                                                                        </span>
                                                                                                      );
                                                                                                    }
                                                                                                  })}
                                                                                                </div>
                                                                                              ))}
                                                                                            </div>
                                                                                          </div>
                                                                                        ))
                                                                                      );
                                                                                    })()}
                                                                                  </div>
                                                                                ) : (
                                                                                  <div>
                                                                                    {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                      SegmentList.map((segmentinfo, segmentindex) => {

                                                                                        if (
                                                                                          segmentinfo['$'] &&
                                                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                        ) {

                                                                                          return (
                                                                                            <div key={segmentindex}>
                                                                                              <img
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${segmentinfo['$']['Carrier']}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              /><br />
                                                                                              <span className='flightnumber1'>
                                                                                                {handleAirline(segmentinfo['$']['Carrier'])}<br />
                                                                                                {segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']}
                                                                                              </span>
                                                                                            </div>
                                                                                          );

                                                                                        }
                                                                                      })
                                                                                    }
                                                                                  </div>
                                                                                )
                                                                              }
                                                                            </div>
                                                                          )
                                                                      )
                                                                    }

                                                                  </div>
                                                                )
                                                            )
                                                            }



                                                          </div>
                                                        </div>
                                                        <div className="flt-l-c">
                                                          <div className="flt-l-cb">
                                                            <div className="flt-l-c-padding">
                                                              <div className="flyght-info-head">
                                                                <input type="hidden" name="SearchPriceTotalPrice" value={pricepoint['$']['TotalPrice']} />
                                                                {pricepoint['air:AirPricingInfo'] && (
                                                                  Array.isArray(pricepoint['air:AirPricingInfo'])
                                                                    ? (
                                                                      <div>
                                                                        {
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'] &&
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'] && (
                                                                            Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'])
                                                                              ? (
                                                                                <div>
                                                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'])
                                                                                    ? (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['0'] &&


                                                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['0']['$']['SegmentRef']
                                                                                            ) {
                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  {handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])}
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })

                                                                                        }


                                                                                      </div>
                                                                                    ) : (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  {handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])}
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }
                                                                                      </div>
                                                                                    )
                                                                                  }
                                                                                </div>
                                                                              ) : (
                                                                                <div>
                                                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'])
                                                                                    ? (
                                                                                      <div>


                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['0'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['0']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  {handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])}
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }
                                                                                      </div>
                                                                                    ) : (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  {handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])}
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }
                                                                                      </div>
                                                                                    )
                                                                                  }
                                                                                </div>
                                                                              )
                                                                          )
                                                                        }
                                                                      </div>
                                                                    ) : (
                                                                      <div>
                                                                        {
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'] &&
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'] && (
                                                                            Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'])
                                                                              ? (
                                                                                <div>
                                                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'])
                                                                                    ? (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['0'] &&


                                                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['0']['$']['SegmentRef']
                                                                                            ) {
                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  {handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])}
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })

                                                                                        }
                                                                                      </div>
                                                                                    ) : (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  {handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])}
                                                                                                </div>
                                                                                              );
                                                                                            }


                                                                                          })
                                                                                        }
                                                                                      </div>
                                                                                    )
                                                                                  }
                                                                                </div>
                                                                              ) : (
                                                                                <div>
                                                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'])
                                                                                    ? (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['0'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['0']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])

                                                                                                  } &nbsp;
                                                                                                  {handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])}
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }
                                                                                      </div>
                                                                                    ) : (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  {handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])}
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }
                                                                                      </div>
                                                                                    )
                                                                                  }
                                                                                </div>
                                                                              )
                                                                          )
                                                                        }
                                                                      </div>
                                                                    )
                                                                )
                                                                }
                                                              </div>
                                                              {/* // */}
                                                              <div className="flight-line">
                                                                {pricepoint['air:AirPricingInfo'] && (
                                                                  Array.isArray(pricepoint['air:AirPricingInfo'])
                                                                    ? (
                                                                      <>
                                                                        {
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'] &&
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'] && (
                                                                            Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'])
                                                                              ? (
                                                                                <>
                                                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'])
                                                                                    ? (
                                                                                      <>
                                                                                        <span className="lineflightss">
                                                                                          <div className="flight-line-a"
                                                                                            style={{ width: 58 }}>

                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === 0 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                {handleAirport(segmentinfo['$']['Origin'])} <br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>
                                                                                            ))}
                                                                                          </div>
                                                                                          <span className="lineflights">
                                                                                            <div className="flight-line-d1"></div>
                                                                                            <div
                                                                                              className="flight-line-a"
                                                                                              width="45px"
                                                                                            >
                                                                                              <span>
                                                                                                {calculateTravellingTime(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['$']['TravelTime'])}
                                                                                              </span>
                                                                                            </div>
                                                                                            <div className="flight-line-d2"></div>
                                                                                          </span>
                                                                                          <div className="flight-line-a" style={{ width: 62 }}>

                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].length - 1 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                {handleAirport(segmentinfo['$']['Destination'])} <br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destiation'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                              
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>
                                                                                            ))}
                                                                                          </div>
                                                                                        </span>
                                                                                        <div className="flight-line-a" style={{ marginLeft: 10 }}>
                                                                                          {(() => {
                                                                                            let totalIterations = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].length - 1;
                                                                                            let backgroundColor = totalIterations === 1 ? "#785eff" : "red";


                                                                                            return (
                                                                                              <p className="iteration0" style={{ color: "#fff", fontWeight: '600', textAlign: "center", border: "1px solid #cbfac8", width: 70, backgroundColor: backgroundColor, padding: 4, borderRadius: 15, fontSize: 8 }}>
                                                                                                {totalIterations} STOP
                                                                                              </p>
                                                                                            );
                                                                                          })()}
                                                                                        </div>
                                                                                      </>
                                                                                    ) : (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <span key={segmentindex}>
                                                                                                  <span className="lineflightss">
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 58 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        {handleAirport(segmentinfo['$']['Origin'])}<br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                           {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                     
                                                                                                      </span>
                                                                                                    </div>
                                                                                                    <span className="lineflights">
                                                                                                      <div className="flight-line-d1"></div>
                                                                                                      <div
                                                                                                        className="flight-line-a"
                                                                                                        width="45px"
                                                                                                      >
                                                                                                        <span>
                                                                                                          {calculateTravellingTime(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['$']['TravelTime'])}
                                                                                                        </span>
                                                                                                      </div>
                                                                                                      <div className="flight-line-d2"></div>
                                                                                                    </span>
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 62 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}
                                                                                                        <sup></sup>

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        {handleAirport(segmentinfo['$']['Destination'])}  <br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                       </span>
                                                                                                    </div>
                                                                                                  </span>
                                                                                                  <div className="flight-line-a" style={{ marginLeft: 10 }}>
                                                                                                    {(() => {
                                                                                                      let totalIterations = 0;

                                                                                                      return (
                                                                                                        <p className="iteration0" style={{ textAlign: "center", border: "1px solid #cbfac8", width: 70, backgroundColor: "#cbfac8", color: "black", padding: 4, borderRadius: 15, fontSize: 8 }}>
                                                                                                          NON STOP
                                                                                                        </p>
                                                                                                      );
                                                                                                    })()}
                                                                                                  </div>
                                                                                                </span>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }
                                                                                      </>
                                                                                    )
                                                                                  }
                                                                                </>
                                                                              ) : (
                                                                                <>
                                                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'])
                                                                                    ? (
                                                                                      <>
                                                                                        <span className="lineflightss">
                                                                                          <div className="flight-line-a"
                                                                                            style={{ width: 58 }}>

                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === 0 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                {handleAirport(segmentinfo['$']['Origin'])}<br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                              </span></span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>
                                                                                            ))}
                                                                                          </div>
                                                                                          <span className="lineflights">
                                                                                            <div className="flight-line-d1"></div>
                                                                                            <div
                                                                                              className="flight-line-a"
                                                                                              width="45px"
                                                                                            >
                                                                                              <span>
                                                                                                {calculateTravellingTime(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['$']['TravelTime'])}
                                                                                              </span>
                                                                                            </div>
                                                                                            <div className="flight-line-d2"></div>
                                                                                          </span>
                                                                                          <div className="flight-line-a" style={{ width: 62 }}>

                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].length - 1 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                {handleAirport(segmentinfo['$']['Destination'])}<br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                             
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>
                                                                                            ))}
                                                                                          </div>
                                                                                        </span>
                                                                                        <div className="flight-line-a" style={{ marginLeft: 10 }}>
                                                                                          {(() => {
                                                                                            let totalIterations = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].length - 1;
                                                                                            let backgroundColor = totalIterations === 1 ? "#785eff" : "red";
                                                                                            return (
                                                                                              <p className="iteration0" style={{ color: "#fff", fontWeight: '600', textAlign: "center", border: "1px solid #cbfac8", width: 70, backgroundColor: backgroundColor, padding: 4, borderRadius: 15, fontSize: 8 }}>
                                                                                                {totalIterations} STOP
                                                                                              </p>
                                                                                            );
                                                                                          })()}
                                                                                        </div>
                                                                                      </>
                                                                                    ) : (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <span key={segmentindex}>
                                                                                                  <span className="lineflightss">
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 58 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        {handleAirport(segmentinfo['$']['Origin'])}<br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                      </span>
                                                                                                    </div>
                                                                                                    <span className="lineflights">
                                                                                                      <div className="flight-line-d1"></div>
                                                                                                      <div
                                                                                                        className="flight-line-a"
                                                                                                        width="45px"
                                                                                                      >
                                                                                                        <span>
                                                                                                          {calculateTravellingTime(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['$']['TravelTime'])}
                                                                                                        </span>
                                                                                                      </div>
                                                                                                      <div className="flight-line-d2"></div>
                                                                                                    </span>
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 62 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}
                                                                                                        <sup></sup>

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        {handleAirport(segmentinfo['$']['Destination'])}     <br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                       </span>
                                                                                                    </div>
                                                                                                  </span>
                                                                                                  <div className="flight-line-a" style={{ marginLeft: 10 }}>
                                                                                                    {(() => {
                                                                                                      let totalIterations = 0;

                                                                                                      return (
                                                                                                        <p className="iteration0" style={{ textAlign: "center", border: "1px solid #cbfac8", width: 70, backgroundColor: "#cbfac8", color: "black", padding: 4, borderRadius: 15, fontSize: 8 }}>
                                                                                                          NON STOP
                                                                                                        </p>
                                                                                                      );
                                                                                                    })()}
                                                                                                  </div>
                                                                                                </span>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }
                                                                                      </>
                                                                                    )
                                                                                  }
                                                                                </>
                                                                              )
                                                                          )
                                                                        }

                                                                      </>
                                                                    ) : (
                                                                      <>
                                                                        {
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'] &&
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'] && (
                                                                            Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'])
                                                                              ? (
                                                                                <>
                                                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'])
                                                                                    ? (
                                                                                      <>
                                                                                        <span className="lineflightss">
                                                                                          <div className="flight-line-a"
                                                                                            style={{ width: 58 }}>

                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === 0 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                {handleAirport(segmentinfo['$']['Origin'])}<br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>
                                                                                            ))}
                                                                                          </div>
                                                                                          <span className="lineflights">
                                                                                            <div className="flight-line-d1"></div>
                                                                                            <div
                                                                                              className="flight-line-a"
                                                                                              width="45px"
                                                                                            >
                                                                                              <span>
                                                                                                {calculateTravellingTime(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['$']['TravelTime'])}
                                                                                              </span>
                                                                                            </div>
                                                                                            <div className="flight-line-d2"></div>
                                                                                          </span>
                                                                                          <div className="flight-line-a" style={{ width: 62 }}>

                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].length - 1 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                {handleAirport(segmentinfo['$']['Destination'])}<br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                               
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>
                                                                                            ))}
                                                                                          </div>
                                                                                        </span>
                                                                                        <div className="flight-line-a" style={{ marginLeft: 10 }}>
                                                                                          {(() => {
                                                                                            let totalIterations = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].length - 1;
                                                                                            let backgroundColor = totalIterations === 1 ? "#785eff" : "red";
                                                                                            return (
                                                                                              <p className="iteration0" style={{ color: "#fff", fontWeight: '600', textAlign: "center", border: "1px solid #cbfac8", width: 70, backgroundColor: backgroundColor, padding: 4, borderRadius: 15, fontSize: 8 }}>
                                                                                                {totalIterations} STOP
                                                                                              </p>
                                                                                            );
                                                                                          })()}
                                                                                        </div>
                                                                                      </>
                                                                                    ) : (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <span key={segmentindex}>
                                                                                                  <span className="lineflightss">
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 58 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        {handleAirport(segmentinfo['$']['Origin'])}<br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                      </span>
                                                                                                    </div>
                                                                                                    <span className="lineflights">
                                                                                                      <div className="flight-line-d1"></div>
                                                                                                      <div
                                                                                                        className="flight-line-a"
                                                                                                        width="45px"
                                                                                                      >
                                                                                                        <span>

                                                                                                          {calculateTravellingTime(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['$']['TravelTime'])}
                                                                                                        </span>
                                                                                                      </div>
                                                                                                      <div className="flight-line-d2"></div>
                                                                                                    </span>
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 62 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}
                                                                                                        <sup></sup>

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        {handleAirport(segmentinfo['$']['Destination'])}        <br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                        </span>
                                                                                                    </div>
                                                                                                  </span>
                                                                                                  <div className="flight-line-a" style={{ marginLeft: 10 }}>
                                                                                                    {(() => {
                                                                                                      let totalIterations = 0;
                                                                                                      return (
                                                                                                        <p className="iteration0" style={{ textAlign: "center", border: "1px solid #cbfac8", width: 70, backgroundColor: "#cbfac8", color: "black", padding: 4, borderRadius: 15, fontSize: 8 }}>
                                                                                                          NON STOP
                                                                                                        </p>
                                                                                                      );
                                                                                                    })()}
                                                                                                  </div>
                                                                                                </span>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }
                                                                                      </>
                                                                                    )
                                                                                  }
                                                                                </>
                                                                              ) : (
                                                                                <>
                                                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'])
                                                                                    ? (
                                                                                      <>
                                                                                        <span className="lineflightss">
                                                                                          <div className="flight-line-a"
                                                                                            style={{ width: 58 }}>

                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === 0 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                {handleAirport(segmentinfo['$']['Origin'])}<br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>
                                                                                            ))}
                                                                                          </div>
                                                                                          <span className="lineflights">
                                                                                            <div className="flight-line-d1"></div>
                                                                                            <div
                                                                                              className="flight-line-a"
                                                                                              width="45px"
                                                                                            >
                                                                                              <span>
                                                                                                {calculateTravellingTime(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['$']['TravelTime'])}
                                                                                              </span>
                                                                                            </div>
                                                                                            <div className="flight-line-d2"></div>
                                                                                          </span>
                                                                                          <div className="flight-line-a" style={{ width: 62 }}>

                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].length - 1 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                {handleAirport(segmentinfo['$']['Destination'])}<br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                               
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>

                                                                                            ))}


                                                                                          </div>
                                                                                        </span>
                                                                                        <div className="flight-line-a" style={{ marginLeft: 10 }}>
                                                                                          {(() => {
                                                                                            let totalIterations = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].length - 1;
                                                                                            let backgroundColor = totalIterations === 1 ? "#785eff" : "red";
                                                                                            return (
                                                                                              <p className="iteration0" style={{ color: "#fff", fontWeight: '600', textAlign: "center", border: "1px solid #cbfac8", width: 70, backgroundColor: backgroundColor, padding: 4, borderRadius: 15, fontSize: 8 }}>
                                                                                                {totalIterations} STOP
                                                                                              </p>
                                                                                            );
                                                                                          })()}
                                                                                        </div>
                                                                                      </>
                                                                                    ) : (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <span key={segmentindex}>
                                                                                                  <span className="lineflightss">
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 58 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        {handleAirport(segmentinfo['$']['Origin'])}<br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                      </span>
                                                                                                    </div>
                                                                                                    <span className="lineflights">
                                                                                                      <div className="flight-line-d1"></div>
                                                                                                      <div
                                                                                                        className="flight-line-a"
                                                                                                        width="45px"
                                                                                                      >
                                                                                                        <span>
                                                                                                          {calculateTravellingTime(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['$']['TravelTime'])}
                                                                                                        </span>
                                                                                                      </div>
                                                                                                      <div className="flight-line-d2"></div>
                                                                                                    </span>
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 62 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}
                                                                                                        <sup></sup>

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        {handleAirport(segmentinfo['$']['Destination'])}<br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                        </span>
                                                                                                    </div>
                                                                                                  </span>
                                                                                                  <div className="flight-line-a" style={{ marginLeft: 10 }}>
                                                                                                    {(() => {
                                                                                                      let totalIterations = 0;

                                                                                                      return (
                                                                                                        <p className="iteration0" style={{ textAlign: "center", border: "1px solid #cbfac8", width: 70, backgroundColor: "#cbfac8", color: "black", padding: 4, borderRadius: 15, fontSize: 8 }}>
                                                                                                          NON STOP
                                                                                                        </p>
                                                                                                      );
                                                                                                    })()}
                                                                                                  </div>

                                                                                                </span>
                                                                                              );

                                                                                            }


                                                                                          })
                                                                                        }
                                                                                      </>
                                                                                    )
                                                                                  }
                                                                                </>
                                                                              )
                                                                          )
                                                                        }

                                                                      </>
                                                                    )
                                                                )
                                                                }

                                                                <div className="flight-line-b">
                                                                  <b onClick={() => handleFlightDetails(priceindex)}>flight details3</b>
                                                                </div>
                                                                <div className="clear" />
                                                                {/* // details // */}




                                                                <div className="flight-details" style={{ display: visibleFlightIndex === priceindex ? 'block' : 'none' }}>
                                                                  <Nav justify variant="tabs" className="flight_nav" defaultActiveKey={`Flight_Details${priceindex}`} activeKey={activeTab} onSelect={setActiveTab} style={{ border: 'none' }}>

                                                                  </Nav>
                                                                  {pricepoint['air:AirPricingInfo'] && (
                                                                    Array.isArray(pricepoint['air:AirPricingInfo'])
                                                                      ? (
                                                                        <div>
                                                                          <div id={`Flight_Detail${priceindex}`} className="tabcontent" style={activeTab.includes(`Flight_Detail${priceindex}`) ? { display: 'block' } : { display: 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                                                              pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'] &&
                                                                              pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'] && (
                                                                                Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'])
                                                                                  ? (
                                                                                    <div>
                                                                                      {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'] &&
                                                                                        Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'])
                                                                                        ? (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingInfo['$'] &&
                                                                                                  SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (
                                                                                                      segmentinfo['$'] &&
                                                                                                      segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                    ) {

                                                                                                      return (
                                                                                                        <div key={segmentindex}>

                                                                                                          <div>
                                                                                                            <div className="flight-details-d">
                                                                                                              <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                              <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfo)} />
                                                                                                            </div>
                                                                                                            <div className="flight-details-a">
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handleAirline(segmentinfo['$']['Carrier'])
                                                                                                              } . &nbsp; {segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                              &nbsp;
                                                                                                              {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                              }

                                                                                                              <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>



                                                                                                            </div>

                                                                                                            <div className="clear" />
                                                                                                            <div className="flight-details-l">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}
                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])

                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-m">
                                                                                                              <div className="flight-details-e">
                                                                                                                {segmentinfo['$']
                                                                                                                  && (() => {
                                                                                                                    const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                    const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                    const minutes = flightTimeInMinutes % 60;
                                                                                                                    const formattedHours = String(hours).padStart(2, '0');
                                                                                                                    const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                    const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                    return formattedFlightTime;
                                                                                                                  })
                                                                                                                    ()}

                                                                                                              </div>
                                                                                                              <div className="flight-details-e">
                                                                                                                <hr />
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-r">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])

                                                                                                                }
                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="clear" />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                      );
                                                                                                    }
                                                                                                  })
                                                                                                }


                                                                                              </div>
                                                                                            ))}


                                                                                          </div>
                                                                                        ) : (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                              pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                              SegmentList.map((segmentinfo, segmentindex) => {

                                                                                                if (
                                                                                                  segmentinfo['$'] &&
                                                                                                  segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                                ) {
                                                                                                  const bookingInfoo = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'];

                                                                                                  return (
                                                                                                    <div key={segmentindex}>

                                                                                                      <div>
                                                                                                        <div className="flight-details-d">
                                                                                                          <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                          <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfoo)} />
                                                                                                        </div>
                                                                                                        <div className="flight-details-a">
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handleAirline(segmentinfo['$']['Carrier'])
                                                                                                          } . &nbsp; {segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                          &nbsp;

                                                                                                          {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                          }

                                                                                                          <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>

                                                                                                        </div>

                                                                                                        <div className="clear" />
                                                                                                        <div className="flight-details-l">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}
                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-m">
                                                                                                          <div className="flight-details-e">
                                                                                                            {segmentinfo['$']
                                                                                                              && (() => {
                                                                                                                const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                const minutes = flightTimeInMinutes % 60;
                                                                                                                const formattedHours = String(hours).padStart(2, '0');
                                                                                                                const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                return formattedFlightTime;
                                                                                                              })
                                                                                                                ()}

                                                                                                          </div>
                                                                                                          <div className="flight-details-e">
                                                                                                            <hr />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-r">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                            }
                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="clear" />
                                                                                                      </div>
                                                                                                    </div>
                                                                                                  );
                                                                                                }


                                                                                              })
                                                                                            }


                                                                                          </div>
                                                                                        )
                                                                                      }
                                                                                    </div>
                                                                                  ) : (
                                                                                    <div>
                                                                                      {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'] &&
                                                                                        Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'])
                                                                                        ? (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingInfo['$'] &&
                                                                                                  SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (
                                                                                                      segmentinfo['$'] &&
                                                                                                      segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                    ) {

                                                                                                      return (
                                                                                                        <div key={segmentindex}>

                                                                                                          <div>
                                                                                                            <div className="flight-details-d"><input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                              <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfo)} /></div>
                                                                                                            <div className="flight-details-a">
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handleAirline(segmentinfo['$']['Carrier'])
                                                                                                              } . &nbsp; {segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                              &nbsp;

                                                                                                              {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                              }
                                                                                                              <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>


                                                                                                            </div>

                                                                                                            <div className="clear" />
                                                                                                            <div className="flight-details-l">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-m">
                                                                                                              <div className="flight-details-e">
                                                                                                                {segmentinfo['$']
                                                                                                                  && (() => {
                                                                                                                    const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                    const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                    const minutes = flightTimeInMinutes % 60;
                                                                                                                    const formattedHours = String(hours).padStart(2, '0');
                                                                                                                    const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                    const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                    return formattedFlightTime;
                                                                                                                  })
                                                                                                                    ()}

                                                                                                              </div>
                                                                                                              <div className="flight-details-e">
                                                                                                                <hr />
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-r">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                                }
                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="clear" />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                      );
                                                                                                    }
                                                                                                  })
                                                                                                }


                                                                                              </div>
                                                                                            ))}
                                                                                          </div>
                                                                                        ) : (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$'] &&
                                                                                              pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                              SegmentList.map((segmentinfo, segmentindex) => {

                                                                                                if (
                                                                                                  segmentinfo['$'] &&
                                                                                                  segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                                ) {
                                                                                                  const bookingInfoo = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'];

                                                                                                  return (
                                                                                                    <div key={segmentindex}>

                                                                                                      <div>
                                                                                                        <div className="flight-details-d"><input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                          <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfoo)} /></div>
                                                                                                        <div className="flight-details-a">
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handleAirline(segmentinfo['$']['Carrier'])
                                                                                                          } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                          &nbsp;

                                                                                                          {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                          }
                                                                                                          <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>


                                                                                                        </div>

                                                                                                        <div className="clear" />
                                                                                                        <div className="flight-details-l">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-m">
                                                                                                          <div className="flight-details-e">
                                                                                                            {segmentinfo['$']
                                                                                                              && (() => {
                                                                                                                const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                const minutes = flightTimeInMinutes % 60;
                                                                                                                const formattedHours = String(hours).padStart(2, '0');
                                                                                                                const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                return formattedFlightTime;
                                                                                                              })
                                                                                                                ()}

                                                                                                          </div>
                                                                                                          <div className="flight-details-e">
                                                                                                            <hr />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-r">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                            }
                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                      `T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="clear" />
                                                                                                      </div>
                                                                                                    </div>
                                                                                                  );

                                                                                                }


                                                                                              })
                                                                                            }
                                                                                          </div>
                                                                                        )
                                                                                      }
                                                                                    </div>
                                                                                  )
                                                                              )
                                                                            }
                                                                          </div>
                                                                          <div id={`Fare_Summary${priceindex}`} className="tabcontent" style={{ display: activeTab === `Fare_Summary${priceindex}` ? 'block' : 'none' }}>

                                                                            <div className="flight-details-a">
                                                                              Fare Breakup (For All Passengers)
                                                                            </div>

                                                                            <div className="flight-details-l">
                                                                              <div className="flight-details-b">
                                                                                Total Fare
                                                                              </div>
                                                                              <div className="flight-details-c">
                                                                                Base Price
                                                                              </div>
                                                                              {Array.isArray(pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"])
                                                                                ? pricepoint["air:AirPricingInfo"]["air:TaxInfo"].map((tax, index) => (
                                                                                  <div key={index} className="flight-details-c">
                                                                                    {tax["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {tax["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                ))
                                                                                : pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"] && (
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                )}
                                                                              <div className="flight-details-c">
                                                                                Surcharge
                                                                              </div>
                                                                            </div>
                                                                            <div className="flight-details-r">
                                                                              <div className="flight-details-b">
                                                                                {pricepoint.$.TotalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.TotalPrice.replace('INR', '')}
                                                                              </div>
                                                                              <div className="flight-details-c">
                                                                                {pricepoint.$.BasePrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.BasePrice.replace('INR', '')}
                                                                              </div>
                                                                              {Array.isArray(pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"])
                                                                                ? pricepoint["air:AirPricingInfo"]["air:TaxInfo"].map((tax, index) => (
                                                                                  <div key={index} className="flight-details-c">
                                                                                    {tax["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {tax["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                ))
                                                                                : pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"] && (
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                )}
                                                                              <div className="flight-details-c">
                                                                                {pricepoint.$.Taxes.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.Taxes.replace('INR', '')}
                                                                              </div>
                                                                            </div>
                                                                            <div className="clear" />
                                                                          </div>
                                                                          <div id={`Date_Change${priceindex}`} className="tabcontent" style={{ display: activeTab === `Date_Change${priceindex}` ? 'block' : 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty'] &&
                                                                              <div>

                                                                                <div className="flight-details-a">
                                                                                  || {inputOrigin && inputOrigin.split('(')[0]} to {inputDestination && inputDestination.split('(')[0]} , &nbsp;
                                                                                  {
                                                                                    handledatemonthsplit(request.searchdeparture.split('/'))
                                                                                  }
                                                                                </div>

                                                                                <div className="flight-details-l">
                                                                                  <div className="flight-details-b">
                                                                                    Time Frame
                                                                                  </div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['$']['PenaltyApplies'] ? (
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['$']['PenaltyApplies']
                                                                                    ) : (
                                                                                      'NA'
                                                                                    )}
                                                                                  </div>
                                                                                </div>
                                                                                <div className="flight-details-r">
                                                                                  <div className="flight-details-b">
                                                                                    Airline Fee+Fare diff.
                                                                                  </div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['air:Amount'] ? (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['air:Amount'].includes('INR') ? 'â‚¹ ' : ''}
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['air:Amount'].replace('INR', '')} Fare diff.
                                                                                      </>
                                                                                    ) : (
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['air:Percentage'] ? (
                                                                                        pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['air:Percentage']
                                                                                      ) : (
                                                                                        'NA'
                                                                                      )
                                                                                    )}
                                                                                  </div>
                                                                                </div>
                                                                                <div className="clear" />
                                                                                <br className="clear" />
                                                                                <div className="flight-details-c">
                                                                                  <mark>
                                                                                    *Please note that the airline
                                                                                    fee provided is indicative.
                                                                                    CoTrav does not guarantee the
                                                                                    exact amount of the fee.
                                                                                  </mark>
                                                                                </div>
                                                                                <div className="clear" />
                                                                              </div>
                                                                            }
                                                                          </div>
                                                                          <div id={`Cancellation${priceindex}`} className="tabcontent" style={{ display: activeTab === `Cancellation${priceindex}` ? 'block' : 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty'] &&
                                                                              <div>

                                                                                <div className="flight-details-a">
                                                                                  || {inputOrigin && inputOrigin.split('(')[0]} to {inputDestination && inputDestination.split('(')[0]} , &nbsp;
                                                                                  {
                                                                                    handledatemonthsplit(request.searchdeparture.split('/'))
                                                                                  }
                                                                                </div>

                                                                                <div className="flight-details-l">
                                                                                  <div className="flight-details-b">
                                                                                    Time Frame
                                                                                  </div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['$']['PenaltyApplies'] ? (
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['$']['PenaltyApplies']
                                                                                    ) : (
                                                                                      'NA'
                                                                                    )}
                                                                                  </div>
                                                                                </div>
                                                                                <div className="flight-details-r">
                                                                                  <div className="flight-details-b">
                                                                                    Airline Fee+Fare diff.
                                                                                  </div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['air:Amount'] ? (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['air:Amount'].includes('INR') ? 'â‚¹ ' : ''}
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['air:Amount'].replace('INR', '')} Fare diff.
                                                                                      </>
                                                                                    ) : (
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['air:Percentage'] ? (
                                                                                        pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['air:Percentage']
                                                                                      ) : (
                                                                                        'NA'
                                                                                      )
                                                                                    )}
                                                                                  </div>
                                                                                </div>
                                                                                <div className="clear" />
                                                                                <br className="clear" />
                                                                                <div className="flight-details-c">
                                                                                  <mark>
                                                                                    *Please note that the airline
                                                                                    fee provided is indicative.
                                                                                    CoTrav does not guarantee the
                                                                                    exact amount of the fee.
                                                                                  </mark>
                                                                                </div>
                                                                                <div className="clear" />
                                                                              </div>
                                                                            }
                                                                          </div>
                                                                        </div>
                                                                      ) : (
                                                                        <div>
                                                                          <div id={`Flight_Detail${priceindex}`} className="tabcontent" style={activeTab.includes(`Flight_Detail${priceindex}`) ? { display: 'block' } : { display: 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                                                              pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'] &&
                                                                              pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'] && (
                                                                                Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'])
                                                                                  ? (
                                                                                    <div>
                                                                                      {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'] &&
                                                                                        Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'])
                                                                                        ? (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingInfo['$'] &&
                                                                                                  SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (
                                                                                                      segmentinfo['$'] &&
                                                                                                      segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                    ) {

                                                                                                      return (
                                                                                                        <div key={segmentindex}>

                                                                                                          <div>
                                                                                                            <div className="flight-details-d"><input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                              <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfo)} /></div>
                                                                                                            <div className="flight-details-a">
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handleAirline(segmentinfo['$']['Carrier'])
                                                                                                              } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                              &nbsp;

                                                                                                              {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handledatemonth(segmentinfo['$']['DepartureTime'])

                                                                                                              }

                                                                                                              <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>

                                                                                                            </div>

                                                                                                            <div className="clear" />
                                                                                                            <div className="flight-details-l">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-m">
                                                                                                              <div className="flight-details-e">
                                                                                                                {segmentinfo['$']
                                                                                                                  && (() => {
                                                                                                                    const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                    const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                    const minutes = flightTimeInMinutes % 60;
                                                                                                                    const formattedHours = String(hours).padStart(2, '0');
                                                                                                                    const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                    const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                    return formattedFlightTime;
                                                                                                                  })
                                                                                                                    ()}

                                                                                                              </div>
                                                                                                              <div className="flight-details-e">
                                                                                                                <hr />
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-r">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                                }
                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="clear" />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                      );
                                                                                                    }
                                                                                                  })
                                                                                                }


                                                                                              </div>
                                                                                            ))}


                                                                                          </div>
                                                                                        ) : (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                              pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                              SegmentList.map((segmentinfo, segmentindex) => {

                                                                                                if (
                                                                                                  segmentinfo['$'] &&
                                                                                                  segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                                ) {
                                                                                                  const bookingInfoo = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option'][0]['air:BookingInfo'];

                                                                                                  return (
                                                                                                    <div key={segmentindex}>

                                                                                                      <div>
                                                                                                        <div className="flight-details-d"><input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                          <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfoo)} /></div>
                                                                                                        <div className="flight-details-a">
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handleAirline(segmentinfo['$']['Carrier'])
                                                                                                          } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                          &nbsp;

                                                                                                          {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                          }
                                                                                                          <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>


                                                                                                        </div>

                                                                                                        <div className="clear" />
                                                                                                        <div className="flight-details-l">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-m">
                                                                                                          <div className="flight-details-e">
                                                                                                            {segmentinfo['$']
                                                                                                              && (() => {
                                                                                                                const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                const minutes = flightTimeInMinutes % 60;
                                                                                                                const formattedHours = String(hours).padStart(2, '0');
                                                                                                                const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                return formattedFlightTime;
                                                                                                              })
                                                                                                                ()}

                                                                                                          </div>
                                                                                                          <div className="flight-details-e">
                                                                                                            <hr />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-r">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                            }
                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="clear" />
                                                                                                      </div>
                                                                                                    </div>
                                                                                                  );
                                                                                                }


                                                                                              })
                                                                                            }


                                                                                          </div>
                                                                                        )
                                                                                      }
                                                                                    </div>
                                                                                  ) : (
                                                                                    <div>
                                                                                      {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'] &&
                                                                                        Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'])
                                                                                        ? (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingInfo['$'] &&
                                                                                                  SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (
                                                                                                      segmentinfo['$'] &&
                                                                                                      segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                    ) {

                                                                                                      return (
                                                                                                        <div key={segmentindex}>

                                                                                                          <div>
                                                                                                            <div className="flight-details-d"><input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                              <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfo)} /></div>
                                                                                                            <div className="flight-details-a">
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handleAirline(segmentinfo['$']['Carrier'])
                                                                                                              } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                              &nbsp;

                                                                                                              {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                              }

                                                                                                              <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>

                                                                                                            </div>

                                                                                                            <div className="clear" />
                                                                                                            <div className="flight-details-l">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-m">
                                                                                                              <div className="flight-details-e">
                                                                                                                {segmentinfo['$']
                                                                                                                  && (() => {
                                                                                                                    const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                    const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                    const minutes = flightTimeInMinutes % 60;
                                                                                                                    const formattedHours = String(hours).padStart(2, '0');
                                                                                                                    const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                    const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                    return formattedFlightTime;
                                                                                                                  })
                                                                                                                    ()}

                                                                                                              </div>
                                                                                                              <div className="flight-details-e">
                                                                                                                <hr />
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-r">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                                }
                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="clear" />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                      );
                                                                                                    }
                                                                                                  })
                                                                                                }


                                                                                              </div>
                                                                                            ))}
                                                                                          </div>
                                                                                        ) : (
                                                                                          <div>

                                                                                            {

                                                                                              pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$'] &&
                                                                                              pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                              SegmentList.map((segmentinfo, segmentindex) => {

                                                                                                if (
                                                                                                  segmentinfo['$'] &&
                                                                                                  segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                                ) {
                                                                                                  const bookingInfoo = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][0]['air:Option']['air:BookingInfo'];

                                                                                                  return (
                                                                                                    <div key={segmentindex}>

                                                                                                      <div>
                                                                                                        <div className="flight-details-d"><input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                          <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfoo)} /></div>
                                                                                                        <div className="flight-details-a">
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handleAirline(segmentinfo['$']['Carrier'])
                                                                                                          } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                          &nbsp;

                                                                                                          {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                          }

                                                                                                          <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>

                                                                                                        </div>

                                                                                                        <div className="clear" />
                                                                                                        <div className="flight-details-l">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-m">
                                                                                                          <div className="flight-details-e">
                                                                                                            {segmentinfo['$']
                                                                                                              && (() => {
                                                                                                                const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                const minutes = flightTimeInMinutes % 60;
                                                                                                                const formattedHours = String(hours).padStart(2, '0');
                                                                                                                const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                return formattedFlightTime;
                                                                                                              })
                                                                                                                ()}

                                                                                                          </div>
                                                                                                          <div className="flight-details-e">
                                                                                                            <hr />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-r">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                            }
                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="clear" />
                                                                                                      </div>
                                                                                                    </div>
                                                                                                  );

                                                                                                }


                                                                                              })
                                                                                            }
                                                                                          </div>
                                                                                        )
                                                                                      }
                                                                                    </div>
                                                                                  )
                                                                              )
                                                                            }
                                                                          </div>
                                                                          <div id={`Fare_Summary${priceindex}`} className="tabcontent" style={{ display: activeTab === `Fare_Summary${priceindex}` ? 'block' : 'none' }}>

                                                                            <div className="flight-details-a">
                                                                              Fare Breakup (For All Passengers)
                                                                            </div>

                                                                            <div className="flight-details-l">
                                                                              <div className="flight-details-b">
                                                                                Total Fare
                                                                              </div>
                                                                              <div className="flight-details-c">
                                                                                Base Price
                                                                              </div>
                                                                              {Array.isArray(pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"])
                                                                                ? pricepoint["air:AirPricingInfo"]["air:TaxInfo"].map((tax, index) => (
                                                                                  <div key={index} className="flight-details-c">
                                                                                    {tax["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {tax["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                ))
                                                                                : pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"] && (
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                )}
                                                                              <div className="flight-details-c">
                                                                                Surcharge
                                                                              </div>
                                                                            </div>
                                                                            <div className="flight-details-r">
                                                                              <div className="flight-details-b">
                                                                                {pricepoint.$.TotalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.TotalPrice.replace('INR', '')}
                                                                              </div>
                                                                              <div className="flight-details-c">
                                                                                {pricepoint.$.BasePrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.BasePrice.replace('INR', '')}
                                                                              </div>
                                                                              {Array.isArray(pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"])
                                                                                ? pricepoint["air:AirPricingInfo"]["air:TaxInfo"].map((tax, index) => (
                                                                                  <div key={index} className="flight-details-c">
                                                                                    {tax["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {tax["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                ))
                                                                                : pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"] && (
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                )}
                                                                              <div className="flight-details-c">
                                                                                {pricepoint.$.Taxes.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.Taxes.replace('INR', '')}
                                                                              </div>
                                                                            </div>
                                                                            <div className="clear" />
                                                                          </div>
                                                                          <div id={`Date_Change${priceindex}`} className="tabcontent" style={{ display: activeTab === `Date_Change${priceindex}` ? 'block' : 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo']['air:ChangePenalty'] &&
                                                                              <div>

                                                                                <div className="flight-details-a">
                                                                                  || {inputOrigin && inputOrigin.split('(')[0]} to {inputDestination && inputDestination.split('(')[0]} , &nbsp;
                                                                                  {
                                                                                    handledatemonthsplit(request.searchdeparture.split('/'))

                                                                                  }
                                                                                </div>

                                                                                <div className="flight-details-l">
                                                                                  <div className="flight-details-b">
                                                                                    Time Frame
                                                                                  </div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo']['air:ChangePenalty']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo']['air:ChangePenalty']['$']['PenaltyApplies'] ? (
                                                                                      pricepoint['air:AirPricingInfo']['air:ChangePenalty']['$']['PenaltyApplies']
                                                                                    ) : (
                                                                                      'NA'
                                                                                    )}
                                                                                  </div>
                                                                                </div>
                                                                                <div className="flight-details-r">
                                                                                  <div className="flight-details-b">
                                                                                    Airline Fee+Fare diff.
                                                                                  </div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo']['air:ChangePenalty']['air:Amount'] ? (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo']['air:ChangePenalty']['air:Amount'].includes('INR') ? 'â‚¹ ' : ''}
                                                                                        {pricepoint['air:AirPricingInfo']['air:ChangePenalty']['air:Amount'].replace('INR', '')} Fare diff.
                                                                                      </>
                                                                                    ) : (
                                                                                      pricepoint['air:AirPricingInfo']['air:ChangePenalty']['air:Percentage'] ? (
                                                                                        pricepoint['air:AirPricingInfo']['air:ChangePenalty']['air:Percentage']
                                                                                      ) : (
                                                                                        'NA'
                                                                                      )
                                                                                    )}
                                                                                  </div>
                                                                                </div>
                                                                                <div className="clear" />
                                                                                <br className="clear" />
                                                                                <div className="flight-details-c">
                                                                                  <mark>
                                                                                    *Please note that the airline
                                                                                    fee provided is indicative.
                                                                                    CoTrav does not guarantee the
                                                                                    exact amount of the fee.
                                                                                  </mark>
                                                                                </div>
                                                                                <div className="clear" />
                                                                              </div>
                                                                            }
                                                                          </div>
                                                                          <div id={`Cancellation${priceindex}`} className="tabcontent" style={{ display: activeTab === `Cancellation${priceindex}` ? 'block' : 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo']['air:CancelPenalty'] &&
                                                                              <div>

                                                                                <div className="flight-details-a">
                                                                                  || {inputOrigin && inputOrigin.split('(')[0]} to {inputDestination && inputDestination.split('(')[0]} , &nbsp;
                                                                                  {
                                                                                    handledatemonthsplit(request.searchdeparture.split('/'))
                                                                                  }
                                                                                </div>

                                                                                <div className="flight-details-l">
                                                                                  <div className="flight-details-b">
                                                                                    Time Frame
                                                                                  </div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo']['air:CancelPenalty']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo']['air:CancelPenalty']['$']['PenaltyApplies'] ? (
                                                                                      pricepoint['air:AirPricingInfo']['air:CancelPenalty']['$']['PenaltyApplies']
                                                                                    ) : (
                                                                                      'NA'
                                                                                    )}
                                                                                  </div>
                                                                                </div>
                                                                                <div className="flight-details-r">
                                                                                  <div className="flight-details-b">
                                                                                    Airline Fee+Fare diff.
                                                                                  </div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo']['air:CancelPenalty']['air:Amount'] ? (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo']['air:CancelPenalty']['air:Amount'].includes('INR') ? 'â‚¹ ' : ''}
                                                                                        {pricepoint['air:AirPricingInfo']['air:CancelPenalty']['air:Amount'].replace('INR', '')} Fare diff.
                                                                                      </>
                                                                                    ) : (
                                                                                      pricepoint['air:AirPricingInfo']['air:CancelPenalty']['air:Percentage'] ? (
                                                                                        pricepoint['air:AirPricingInfo']['air:CancelPenalty']['air:Percentage']
                                                                                      ) : (
                                                                                        'NA'
                                                                                      )
                                                                                    )}
                                                                                  </div>
                                                                                </div>
                                                                                <div className="clear" />
                                                                                <br className="clear" />
                                                                                <div className="flight-details-c">
                                                                                  <mark>
                                                                                    *Please note that the airline
                                                                                    fee provided is indicative.
                                                                                    CoTrav does not guarantee the
                                                                                    exact amount of the fee.
                                                                                  </mark>
                                                                                </div>
                                                                                <div className="clear" />
                                                                              </div>
                                                                            }
                                                                          </div>
                                                                        </div>
                                                                      )
                                                                  )

                                                                  }
                                                                </div>



                                                              </div>
                                                            </div>
                                                          </div>
                                                          <br className="clear" />
                                                        </div>
                                                      </div>
                                                      <div className="clear" />
                                                    </div>
                                                    <div className="flt-i-bb flight-return">
                                                      <div className="flt-l-a">
                                                        <div className="flt-l-b">
                                                          <div className="way-lbl">return</div>
                                                          <div className="company">
                                                            {pricepoint['air:AirPricingInfo'] && (
                                                              Array.isArray(pricepoint['air:AirPricingInfo'])
                                                                ? (
                                                                  <div style={{ width: '95%' }}>
                                                                    {
                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'] &&
                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'] && (
                                                                        Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'])
                                                                          ? (
                                                                            <div>
                                                                              {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'] &&
                                                                                Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'])
                                                                                ? (

                                                                                  <div>
                                                                                    {(() => {
                                                                                      const uniqueCarriers5 = new Set();
                                                                                      return (
                                                                                        pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                          <div key={bookingindex} >
                                                                                            {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                              if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                uniqueCarriers5.add(segmentinfo['$']['Carrier']);

                                                                                              }
                                                                                            })}

                                                                                          </div>
                                                                                        )),
                                                                                        Array.from(uniqueCarriers5).map((carrier, index) => (
                                                                                          <div key={index}>
                                                                                            <div className="airline-container">
                                                                                              <img
                                                                                                className={`airlineimg${index}`}
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${carrier}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              />
                                                                                              <span className="flightnumber">{handleAirline(carrier)}</span>
                                                                                            </div><br />
                                                                                            <br />
                                                                                            <div>
                                                                                              {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                                <div key={bookingindex}>
                                                                                                  {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef'] && segmentinfo['$']['Carrier'] === carrier) {
                                                                                                      return (
                                                                                                        <span key={segmentindex} className='flightnumber'>
                                                                                                          {bookingindex > 0 && ', '}
                                                                                                          {segmentinfo['$']['Carrier']} {segmentinfo['$']['FlightNumber']}
                                                                                                        </span>
                                                                                                      );
                                                                                                    }
                                                                                                  })}
                                                                                                </div>
                                                                                              ))}
                                                                                            </div>

                                                                                          </div>
                                                                                        ))
                                                                                      );
                                                                                    })()}
                                                                                  </div>
                                                                                ) : (
                                                                                  <div>
                                                                                    {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                      SegmentList.map((segmentinfo, segmentindex) => {

                                                                                        if (
                                                                                          segmentinfo['$'] &&
                                                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                        ) {

                                                                                          return (
                                                                                            <div key={segmentindex}>
                                                                                              <img
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${segmentinfo['$']['Carrier']}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              /><br />
                                                                                              <span className='flightnumber1'>
                                                                                                {handleAirline(segmentinfo['$']['Carrier'])}<br />
                                                                                                {segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']}
                                                                                              </span>
                                                                                            </div>
                                                                                          );
                                                                                        }


                                                                                      })
                                                                                    }


                                                                                  </div>
                                                                                )
                                                                              }
                                                                            </div>
                                                                          ) : (
                                                                            <div>
                                                                              {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'] &&
                                                                                Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'])
                                                                                ? (
                                                                                  <div>
                                                                                    {(() => {
                                                                                      const uniqueCarriers6 = new Set();
                                                                                      return (
                                                                                        pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                          <div key={bookingindex}>
                                                                                            {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                              if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                uniqueCarriers6.add(segmentinfo['$']['Carrier']);

                                                                                              }
                                                                                            })}


                                                                                          </div>
                                                                                        )),
                                                                                        Array.from(uniqueCarriers6).map((carrier, index) => (
                                                                                          <div key={index}>
                                                                                            <div className="airline-container">
                                                                                              <img
                                                                                                className={`airlineimg${index}`}
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${carrier}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              />
                                                                                              <span className="flightnumber">{handleAirline(carrier)}</span>
                                                                                            </div><br />
                                                                                            <br />
                                                                                            <div>
                                                                                              {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                                <div key={bookingindex}>
                                                                                                  {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef'] && segmentinfo['$']['Carrier'] === carrier) {
                                                                                                      return (
                                                                                                        <span key={segmentindex} className='flightnumber'>
                                                                                                          {bookingindex > 0 && ', '}
                                                                                                          {segmentinfo['$']['Carrier']} {segmentinfo['$']['FlightNumber']}
                                                                                                        </span>
                                                                                                      );
                                                                                                    }
                                                                                                  })}
                                                                                                </div>
                                                                                              ))}
                                                                                            </div>

                                                                                          </div>
                                                                                        ))
                                                                                      );
                                                                                    })()}

                                                                                  </div>
                                                                                ) : (
                                                                                  <div>
                                                                                    {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                      SegmentList.map((segmentinfo, segmentindex) => {

                                                                                        if (
                                                                                          segmentinfo['$'] &&
                                                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                        ) {

                                                                                          return (
                                                                                            <div key={segmentindex}>
                                                                                              <img
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${segmentinfo['$']['Carrier']}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              /><br />
                                                                                              <span className='flightnumber1'>
                                                                                                {handleAirline(segmentinfo['$']['Carrier'])}<br />
                                                                                                {segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']}
                                                                                              </span>
                                                                                            </div>
                                                                                          );

                                                                                        }


                                                                                      })
                                                                                    }
                                                                                  </div>
                                                                                )
                                                                              }
                                                                            </div>
                                                                          )
                                                                      )
                                                                    }

                                                                  </div>
                                                                ) : (
                                                                  <div style={{ width: '95%' }}>
                                                                    {
                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'] &&
                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'] && (
                                                                        Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'])
                                                                          ? (
                                                                            <div>
                                                                              {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'] &&
                                                                                Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'])
                                                                                ? (
                                                                                  <div>
                                                                                    {(() => {
                                                                                      const uniqueCarriers7 = new Set();
                                                                                      return (
                                                                                        pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                          <div key={bookingindex} >
                                                                                            {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                              if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                uniqueCarriers7.add(segmentinfo['$']['Carrier']);

                                                                                              }
                                                                                            })}


                                                                                          </div>
                                                                                        )),
                                                                                        Array.from(uniqueCarriers7).map((carrier, index) => (
                                                                                          <div key={index}>
                                                                                            <div className="airline-container">
                                                                                              <img
                                                                                                className={`airlineimg${index}`}
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${carrier}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              />
                                                                                              <span className="flightnumber">{handleAirline(carrier)}</span>
                                                                                            </div><br />
                                                                                            <div>
                                                                                              {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                                <div key={bookingindex}>
                                                                                                  {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef'] && segmentinfo['$']['Carrier'] === carrier) {
                                                                                                      return (
                                                                                                        <span key={segmentindex} className='flightnumber'>
                                                                                                          {bookingindex > 0 && ', '}
                                                                                                          {segmentinfo['$']['Carrier']} {segmentinfo['$']['FlightNumber']}
                                                                                                        </span>
                                                                                                      );
                                                                                                    }
                                                                                                  })}
                                                                                                </div>
                                                                                              ))}
                                                                                            </div>

                                                                                          </div>
                                                                                        ))
                                                                                      );
                                                                                    })()}
                                                                                  </div>
                                                                                ) : (
                                                                                  <div>
                                                                                    {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                      SegmentList.map((segmentinfo, segmentindex) => {

                                                                                        if (
                                                                                          segmentinfo['$'] &&
                                                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                        ) {

                                                                                          return (
                                                                                            <div key={segmentindex}>
                                                                                              <img
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${segmentinfo['$']['Carrier']}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              /><br />
                                                                                              <span className='flightnumber1'>
                                                                                                {handleAirline(segmentinfo['$']['Carrier'])}<br />
                                                                                                {segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']}
                                                                                              </span>
                                                                                            </div>
                                                                                          );
                                                                                        }


                                                                                      })
                                                                                    }


                                                                                  </div>
                                                                                )
                                                                              }
                                                                            </div>
                                                                          ) : (
                                                                            <div>
                                                                              {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'] &&
                                                                                Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'])
                                                                                ? (
                                                                                  <div>
                                                                                    {(() => {
                                                                                      const uniqueCarriers8 = new Set();
                                                                                      return (
                                                                                        pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                          <div key={bookingindex}>
                                                                                            {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                              if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                uniqueCarriers8.add(segmentinfo['$']['Carrier']);

                                                                                              }
                                                                                            })}

                                                                                          </div>
                                                                                        )),
                                                                                        Array.from(uniqueCarriers8).map((carrier, index) => (
                                                                                          <div key={index}>
                                                                                            <div className="airline-container">
                                                                                              <img
                                                                                                className={`airlineimg${index}`}
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${carrier}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              />
                                                                                              <span className="flightnumber">{handleAirline(carrier)}</span>
                                                                                            </div><br />
                                                                                            <div>
                                                                                              {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                                <div key={bookingindex}>
                                                                                                  {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef'] && segmentinfo['$']['Carrier'] === carrier) {
                                                                                                      return (
                                                                                                        <span key={segmentindex} className='flightnumber'>
                                                                                                          {bookingindex > 0 && ', '}
                                                                                                          {segmentinfo['$']['Carrier']} {segmentinfo['$']['FlightNumber']}
                                                                                                        </span>
                                                                                                      );
                                                                                                    }
                                                                                                  })}
                                                                                                </div>
                                                                                              ))}
                                                                                            </div>

                                                                                          </div>
                                                                                        ))
                                                                                      );
                                                                                    })()}
                                                                                  </div>
                                                                                ) : (
                                                                                  <div>
                                                                                    {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                      SegmentList.map((segmentinfo, segmentindex) => {

                                                                                        if (
                                                                                          segmentinfo['$'] &&
                                                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                        ) {

                                                                                          return (
                                                                                            <div key={segmentindex}>
                                                                                              <img
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${segmentinfo['$']['Carrier']}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              /><br />
                                                                                              <span className='flightnumber1'>
                                                                                                {handleAirline(segmentinfo['$']['Carrier'])}<br />
                                                                                                {segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']}
                                                                                              </span>
                                                                                            </div>
                                                                                          );

                                                                                        }


                                                                                      })
                                                                                    }
                                                                                  </div>
                                                                                )
                                                                              }
                                                                            </div>
                                                                          )
                                                                      )
                                                                    }

                                                                  </div>
                                                                )
                                                            )
                                                            }




                                                          </div>
                                                        </div>
                                                        <div className="flt-l-c">
                                                          <div className="flt-l-cb">
                                                            <div className="flt-l-c-padding">
                                                              <div className="flyght-info-head">
                                                                <input type="hidden" name="SearchPriceTotalPrice" value={pricepoint['$']['TotalPrice']} />
                                                                {pricepoint['air:AirPricingInfo'] && (
                                                                  Array.isArray(pricepoint['air:AirPricingInfo'])
                                                                    ? (
                                                                      <div>
                                                                        {
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'] &&
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'] && (
                                                                            Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'])
                                                                              ? (
                                                                                <div>
                                                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'])
                                                                                    ? (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['0'] &&


                                                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['0']['$']['SegmentRef']
                                                                                            ) {
                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  {handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])}
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })

                                                                                        }


                                                                                      </div>
                                                                                    ) : (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  {handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])}
                                                                                                </div>
                                                                                              );
                                                                                            }


                                                                                          })
                                                                                        }


                                                                                      </div>
                                                                                    )
                                                                                  }
                                                                                </div>
                                                                              ) : (
                                                                                <div>
                                                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'])
                                                                                    ? (
                                                                                      <div>


                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['0'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['0']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  {handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])}
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }




                                                                                      </div>
                                                                                    ) : (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  {handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])}
                                                                                                </div>
                                                                                              );


                                                                                            }


                                                                                          })
                                                                                        }
                                                                                      </div>
                                                                                    )
                                                                                  }
                                                                                </div>
                                                                              )
                                                                          )
                                                                        }

                                                                      </div>

                                                                    ) : (
                                                                      <div>
                                                                        {
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'] &&
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'] && (
                                                                            Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'])
                                                                              ? (
                                                                                <div>
                                                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'])
                                                                                    ? (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['0'] &&


                                                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['0']['$']['SegmentRef']
                                                                                            ) {
                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  {handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])}
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })

                                                                                        }


                                                                                      </div>
                                                                                    ) : (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  {handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])}
                                                                                                </div>
                                                                                              );
                                                                                            }


                                                                                          })
                                                                                        }


                                                                                      </div>
                                                                                    )
                                                                                  }
                                                                                </div>
                                                                              ) : (
                                                                                <div>
                                                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'])
                                                                                    ? (
                                                                                      <div>


                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['0'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['0']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  {handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])}
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }




                                                                                      </div>
                                                                                    ) : (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  {handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])}
                                                                                                </div>
                                                                                              );


                                                                                            }


                                                                                          })
                                                                                        }
                                                                                      </div>
                                                                                    )
                                                                                  }
                                                                                </div>
                                                                              )
                                                                          )
                                                                        }

                                                                      </div>

                                                                    )
                                                                )
                                                                }


                                                              </div>
                                                              {/* // */}
                                                              <div className="flight-line">
                                                                {pricepoint['air:AirPricingInfo'] && (
                                                                  Array.isArray(pricepoint['air:AirPricingInfo'])
                                                                    ? (
                                                                      <>
                                                                        {
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'] &&
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'] && (
                                                                            Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'])
                                                                              ? (
                                                                                <>
                                                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'])
                                                                                    ? (
                                                                                      <>
                                                                                        <span className="lineflightss">
                                                                                          <div className="flight-line-a"
                                                                                            style={{ width: 58 }}>

                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === 0 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                {handleAirport(segmentinfo['$']['Origin'])}<br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>

                                                                                            ))}


                                                                                          </div>
                                                                                          <span className="lineflights">
                                                                                            <div className="flight-line-d1"></div>
                                                                                            <div
                                                                                              className="flight-line-a"
                                                                                              width="45px"
                                                                                              style={{ textAlign: 'center', marginTop: '7%' }}
                                                                                            >
                                                                                              <span >
                                                                                                {calculateTravellingTime(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['$']['TravelTime'])}
                                                                                              </span>
                                                                                              <span className="stop-badge-container">
                                                                                                <div className="flight-line-a">
                                                                                                  {(() => {
                                                                                                    let totalIterations = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].length - 1;
                                                                                                    let stopoverCity = "";
                                                                                                    let flightTimeInMinutes = 0;
                                                                                                    if (totalIterations > 0) {
                                                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].forEach((bookingInfo) => {
                                                                                                        SegmentList.map((segmentinfo) => {
                                                                                                          if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                            flightTimeInMinutes = flightTimeInMinutes + parseInt(segmentinfo['$']['FlightTime']);
                                                                                                            stopoverCity = handleAirport(segmentinfo['$']['Origin']);
                                                                                                          }
                                                                                                        });
                                                                                                      });
                                                                                                    }
                                                                                                    {/* <p className="stop-badge" >
                                                                                                                      {totalIterations} stop via {stopoverCity}
                                                                                                                          <div className="tooltip-content">
                                                                                                                            {totalIterations} stop from {stopoverCity} 
                                                                                                                          </div>
                                                                                                                        </p> */}
                                                                                                    return (
                                                                                                      <p className="stop-badge" >
                                                                                                        {totalIterations} stop via {stopoverCity}
                                                                                                        <div className="tooltip-content">
                                                                                                          <p style={{ marginBottom: '0px' }}>Plane Change</p>
                                                                                                          {stopoverCity} | {convertMinutesToHours(pricepoint['travelTime'] - flightTimeInMinutes)} Layover
                                                                                                        </div>
                                                                                                      </p>

                                                                                                    );
                                                                                                  })()}
                                                                                                </div>
                                                                                              </span>
                                                                                            </div>

                                                                                            <div className="flight-line-d2"></div>
                                                                                          </span>
                                                                                          <div className="flight-line-a" style={{ width: 62 }}>

                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].length - 1 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                {handleAirport(segmentinfo['$']['Destination'])}<br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                             
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>

                                                                                            ))}


                                                                                          </div>
                                                                                        </span>

                                                                                      </>
                                                                                    ) : (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <span key={segmentindex}>
                                                                                                  <span className="lineflightss">
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 58 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        {handleAirport(segmentinfo['$']['Origin'])}<br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                      </span>
                                                                                                    </div>
                                                                                                    <span className="lineflights">
                                                                                                      <div className="flight-line-d1"></div>
                                                                                                      <div
                                                                                                        className="flight-line-a"
                                                                                                        width="45px"
                                                                                                        style={{ textAlign: 'center', marginTop: '7%' }}
                                                                                                      >
                                                                                                        <span style={{ marginLeft: '5px', marginRight: '5px' }} >
                                                                                                          {calculateTravellingTime(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['$']['TravelTime'])}
                                                                                                        </span>
                                                                                                        <span className="stop-badge-container">
                                                                                                          <p className="stop-badge">
                                                                                                            Non-Stop
                                                                                                            <div className="tooltip-content">
                                                                                                              This is a direct flight with no stops.
                                                                                                            </div>
                                                                                                          </p>
                                                                                                        </span>
                                                                                                      </div>

                                                                                                      <div className="flight-line-d2"></div>
                                                                                                    </span>
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 62 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}
                                                                                                        <sup></sup>

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        {handleAirport(segmentinfo['$']['Destination'])}<br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }</span>                                                                                          </span>
                                                                                                    </div>
                                                                                                  </span>


                                                                                                </span>
                                                                                              );
                                                                                            }


                                                                                          })
                                                                                        }


                                                                                      </>
                                                                                    )
                                                                                  }
                                                                                </>
                                                                              ) : (
                                                                                <>
                                                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'])
                                                                                    ? (
                                                                                      <>
                                                                                        <span className="lineflightss">
                                                                                          <div className="flight-line-a"
                                                                                            style={{ width: 58 }}>

                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === 0 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                {handleAirport(segmentinfo['$']['Origin'])}<br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>

                                                                                            ))}


                                                                                          </div>
                                                                                          <span className="lineflights">
                                                                                            <div className="flight-line-d1"></div>
                                                                                            <div
                                                                                              className="flight-line-a"
                                                                                              width="45px"
                                                                                              style={{ textAlign: 'center', marginTop: '7%' }}
                                                                                            >
                                                                                              <span >
                                                                                                {calculateTravellingTime(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['$']['TravelTime'])}
                                                                                              </span>
                                                                                              <span className="stop-badge-container">
                                                                                                <div className="flight-line-a">
                                                                                                  {(() => {
                                                                                                    let totalIterations = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].length - 1;
                                                                                                    let stopoverCity = "";
                                                                                                    let flightTimeInMinutes = 0;
                                                                                                    if (totalIterations > 0) {
                                                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].forEach((bookingInfo) => {
                                                                                                        SegmentList.map((segmentinfo) => {
                                                                                                          if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                            flightTimeInMinutes = flightTimeInMinutes + parseInt(segmentinfo['$']['FlightTime']);
                                                                                                            stopoverCity = handleAirport(segmentinfo['$']['Origin']);
                                                                                                          }
                                                                                                        });
                                                                                                      });
                                                                                                    }
                                                                                                    return (
                                                                                                      <p className="stop-badge" >
                                                                                                        {totalIterations} stop via {stopoverCity}
                                                                                                        <div className="tooltip-content">
                                                                                                          <p style={{ marginBottom: '0px' }}>Plane Change</p>
                                                                                                          {stopoverCity} | {convertMinutesToHours(pricepoint['travelTime'] - flightTimeInMinutes)} Layover
                                                                                                        </div>
                                                                                                      </p>
                                                                                                    );
                                                                                                  })()}
                                                                                                </div>
                                                                                              </span>
                                                                                            </div>

                                                                                            <div className="flight-line-d2"></div>
                                                                                          </span>
                                                                                          <div className="flight-line-a" style={{ width: 62 }}>

                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].length - 1 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                {handleAirport(segmentinfo['$']['Destination'])}<br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                               
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>

                                                                                            ))}


                                                                                          </div>
                                                                                        </span>

                                                                                      </>
                                                                                    ) : (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <span key={segmentindex}>
                                                                                                  <span className="lineflightss">
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 58 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        {handleAirport(segmentinfo['$']['Origin'])}<br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                      </span>
                                                                                                    </div>
                                                                                                    <span className="lineflights">
                                                                                                      <div className="flight-line-d1"></div>
                                                                                                      <div
                                                                                                        className="flight-line-a"
                                                                                                        width="45px"
                                                                                                        style={{ textAlign: 'center', marginTop: '7%' }}
                                                                                                      >
                                                                                                        <span style={{ marginLeft: '5px', marginRight: '5px' }} >
                                                                                                          {calculateTravellingTime(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['$']['TravelTime'])}
                                                                                                        </span>
                                                                                                        <span className="stop-badge-container">
                                                                                                          <p className="stop-badge">
                                                                                                            Non-Stop
                                                                                                            <div className="tooltip-content">
                                                                                                              This is a direct flight with no stops.
                                                                                                            </div>
                                                                                                          </p>
                                                                                                        </span>
                                                                                                      </div>

                                                                                                      <div className="flight-line-d2"></div>
                                                                                                    </span>
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 62 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}
                                                                                                        <sup></sup>

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        {handleAirport(segmentinfo['$']['Destination'])} <br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                        </span>
                                                                                                    </div>
                                                                                                  </span>


                                                                                                </span>
                                                                                              );

                                                                                            }


                                                                                          })
                                                                                        }
                                                                                      </>
                                                                                    )
                                                                                  }
                                                                                </>
                                                                              )
                                                                          )
                                                                        }

                                                                      </>
                                                                    ) : (
                                                                      <>
                                                                        {
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'] &&
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'] && (
                                                                            Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'])
                                                                              ? (
                                                                                <>
                                                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'])
                                                                                    ? (
                                                                                      <>
                                                                                        <span className="lineflightss">
                                                                                          <div className="flight-line-a"
                                                                                            style={{ width: 58 }}>

                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === 0 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                {handleAirport(segmentinfo['$']['Origin'])}<br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>

                                                                                            ))}


                                                                                          </div>
                                                                                          <span className="lineflights">
                                                                                            <div className="flight-line-d1"></div>
                                                                                            <div
                                                                                              className="flight-line-a"
                                                                                              width="45px"
                                                                                              style={{ textAlign: 'center', marginTop: '7%' }}
                                                                                            >
                                                                                              <span >
                                                                                                {calculateTravellingTime(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['$']['TravelTime'])}
                                                                                              </span>
                                                                                              <span className="stop-badge-container">
                                                                                                <div className="flight-line-a">
                                                                                                  {(() => {
                                                                                                    let totalIterations = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].length - 1;
                                                                                                    let stopoverCity = "";
                                                                                                    let flightTimeInMinutes = 0;
                                                                                                    if (totalIterations > 0) {
                                                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].forEach((bookingInfo) => {
                                                                                                        SegmentList.map((segmentinfo) => {
                                                                                                          if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                            flightTimeInMinutes = flightTimeInMinutes + parseInt(segmentinfo['$']['FlightTime']);
                                                                                                            stopoverCity = handleAirport(segmentinfo['$']['Origin']);
                                                                                                          }
                                                                                                        });
                                                                                                      });
                                                                                                    }
                                                                                                    return (
                                                                                                      <p className="stop-badge" >
                                                                                                        {totalIterations} stop via {stopoverCity}
                                                                                                        <div className="tooltip-content">
                                                                                                          <p style={{ marginBottom: '0px' }}>Plane Change</p>
                                                                                                          {stopoverCity} | {convertMinutesToHours(pricepoint['travelTime'] - flightTimeInMinutes)} Layover
                                                                                                        </div>
                                                                                                      </p>
                                                                                                    );
                                                                                                  })()}
                                                                                                </div>
                                                                                              </span>
                                                                                            </div>

                                                                                            <div className="flight-line-d2"></div>
                                                                                          </span>
                                                                                          <div className="flight-line-a" style={{ width: 62 }}>

                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].length - 1 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                {handleAirport(segmentinfo['$']['Destination'])}<br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                               
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>

                                                                                            ))}


                                                                                          </div>
                                                                                        </span>

                                                                                      </>
                                                                                    ) : (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <span key={segmentindex}>
                                                                                                  <span className="lineflightss">
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 58 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        {handleAirport(segmentinfo['$']['Origin'])}<br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                      </span>
                                                                                                    </div>
                                                                                                    <span className="lineflights">
                                                                                                      <div className="flight-line-d1"></div>
                                                                                                      <div
                                                                                                        className="flight-line-a"
                                                                                                        width="45px"
                                                                                                        style={{ textAlign: 'center', marginTop: '7%' }}
                                                                                                      >
                                                                                                        <span style={{ marginLeft: '5px', marginRight: '5px' }} >
                                                                                                          {calculateTravellingTime(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['$']['TravelTime'])}
                                                                                                        </span>
                                                                                                        <span className="stop-badge-container">
                                                                                                          <p className="stop-badge">
                                                                                                            Non-Stop
                                                                                                            <div className="tooltip-content">
                                                                                                              This is a direct flight with no stops.
                                                                                                            </div>
                                                                                                          </p>
                                                                                                        </span>
                                                                                                      </div>

                                                                                                      <div className="flight-line-d2"></div>
                                                                                                    </span>
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 62 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}
                                                                                                        <sup></sup>

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        {handleAirport(segmentinfo['$']['Destination'])} <br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                        </span>
                                                                                                    </div>
                                                                                                  </span>


                                                                                                </span>
                                                                                              );
                                                                                            }


                                                                                          })
                                                                                        }


                                                                                      </>
                                                                                    )
                                                                                  }
                                                                                </>
                                                                              ) : (
                                                                                <>
                                                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'])
                                                                                    ? (
                                                                                      <>
                                                                                        <span className="lineflightss">
                                                                                          <div className="flight-line-a"
                                                                                            style={{ width: 58 }}>

                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === 0 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                {handleAirport(segmentinfo['$']['Origin'])}<br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                              </span></span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>

                                                                                            ))}


                                                                                          </div>
                                                                                          <span className="lineflights">
                                                                                            <div className="flight-line-d1"></div>
                                                                                            <div
                                                                                              className="flight-line-a"
                                                                                              width="45px"
                                                                                              style={{ textAlign: 'center', marginTop: '7%' }}
                                                                                            >
                                                                                              <span >
                                                                                                {calculateTravellingTime(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['$']['TravelTime'])}
                                                                                              </span>
                                                                                              <span className="stop-badge-container">
                                                                                                <div className="flight-line-a">
                                                                                                  {(() => {
                                                                                                    let totalIterations = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].length - 1;
                                                                                                    let stopoverCity = "";
                                                                                                    let flightTimeInMinutes = 0;
                                                                                                    if (totalIterations > 0) {
                                                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].forEach((bookingInfo) => {
                                                                                                        SegmentList.map((segmentinfo) => {
                                                                                                          if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                            flightTimeInMinutes = flightTimeInMinutes + parseInt(segmentinfo['$']['FlightTime']);
                                                                                                            stopoverCity = handleAirport(segmentinfo['$']['Origin']);
                                                                                                          }
                                                                                                        });
                                                                                                      });
                                                                                                    }
                                                                                                    return (
                                                                                                      <p className="stop-badge" >
                                                                                                        {totalIterations} stop via {stopoverCity}
                                                                                                        <div className="tooltip-content">
                                                                                                          <p style={{ marginBottom: '0px' }}>Plane Change</p>
                                                                                                          {stopoverCity} | {convertMinutesToHours(pricepoint['travelTime'] - flightTimeInMinutes)} Layover
                                                                                                        </div>
                                                                                                      </p>
                                                                                                    );
                                                                                                  })()}
                                                                                                </div>
                                                                                              </span>
                                                                                            </div>

                                                                                            <div className="flight-line-d2"></div>
                                                                                          </span>
                                                                                          <div className="flight-line-a" style={{ width: 62 }}>

                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].length - 1 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                {handleAirport(segmentinfo['$']['Destination'])}<br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                               
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>

                                                                                            ))}


                                                                                          </div>
                                                                                        </span>

                                                                                      </>
                                                                                    ) : (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <span key={segmentindex}>
                                                                                                  <span className="lineflightss">
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 58 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        {handleAirport(segmentinfo['$']['Origin'])}<br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                      </span>
                                                                                                    </div>
                                                                                                    <span className="lineflights">
                                                                                                      <div className="flight-line-d1"></div>
                                                                                                      <div
                                                                                                        className="flight-line-a"
                                                                                                        width="45px"
                                                                                                        style={{ textAlign: 'center', marginTop: '7%' }}
                                                                                                      >
                                                                                                        <span style={{ marginLeft: '5px', marginRight: '5px' }} >
                                                                                                          {calculateTravellingTime(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['$']['TravelTime'])}
                                                                                                        </span>
                                                                                                        <span className="stop-badge-container">
                                                                                                          <p className="stop-badge">
                                                                                                            Non-Stop
                                                                                                            <div className="tooltip-content">
                                                                                                              This is a direct flight with no stops.
                                                                                                            </div>
                                                                                                          </p>
                                                                                                        </span>
                                                                                                      </div>

                                                                                                      <div className="flight-line-d2"></div>
                                                                                                    </span>
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 62 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}
                                                                                                        <sup></sup>

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        {handleAirport(segmentinfo['$']['Destination'])}<br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                        </span>
                                                                                                    </div>
                                                                                                  </span>


                                                                                                </span>
                                                                                              );

                                                                                            }


                                                                                          })
                                                                                        }
                                                                                      </>
                                                                                    )
                                                                                  }
                                                                                </>
                                                                              )
                                                                          )
                                                                        }

                                                                      </>
                                                                    )
                                                                )
                                                                }

                                                                {/* <div className="flight-line-b">
                                                                      <b onClick={() => handleFlightDetails(priceindex)}>flight details2</b>
                                                                    </div> */}

                                                                <div className="flt-i-price">
                                                                  {pricepoint['air:AirPricingInfo'] && (
                                                                    Array.isArray(pricepoint['air:AirPricingInfo']) ? (
                                                                      <>
                                                                        {(() => {
                                                                          const totalPrice =
                                                                            pricepoint['air:AirPricingInfo'][0]['$']['TotalPrice'];
                                                                          const seatType = cabinClass; // Set the seat type dynamically as needed
                                                                          const fareName = "Base Fare";
                                                                          const airline = inputOrigin;

                                                                          const finalPrice = calculateFinalPrice(totalPrice, markupdata, seatType, fareName, airline, flight_type);

                                                                          return (
                                                                            <>
                                                                              {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                              {Math.floor(finalPrice)}
                                                                            </>
                                                                          );
                                                                        })()}
                                                                      </>
                                                                    ) : (
                                                                      <>
                                                                        {(() => {
                                                                          const totalPrice =
                                                                            pricepoint['air:AirPricingInfo']['$']['TotalPrice'];
                                                                          const seatType = cabinClass; // Set the seat type dynamically as needed
                                                                          const fareName = "Base Fare";
                                                                          const airline = inputOrigin;

                                                                          const finalPrice = calculateFinalPrice(totalPrice, markupdata, seatType, fareName, airline, flight_type);

                                                                          return (
                                                                            <>
                                                                              {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                              {Math.floor(finalPrice)} {/* Show final price with markup applied */}
                                                                            </>
                                                                          );
                                                                        })()}
                                                                      </>
                                                                    )
                                                                  )}


                                                                </div>




                                                                <div className="flight-details" style={{ display: visibleFlightIndex === priceindex ? 'block' : 'none' }}>
                                                                  <Nav justify variant="tabs" className="flight_nav" defaultActiveKey={`Flight_Details${priceindex}`} activeKey={activeTab} onSelect={setActiveTab} style={{ border: 'none' }}>

                                                                  </Nav>
                                                                  {pricepoint['air:AirPricingInfo'] && (
                                                                    Array.isArray(pricepoint['air:AirPricingInfo'])
                                                                      ? (
                                                                        <div>
                                                                          <div id={`Flight_Detail${priceindex}`} className="tabcontent" style={activeTab.includes(`Flight_Detail${priceindex}`) ? { display: 'block' } : { display: 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                                                              pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'] &&
                                                                              pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'] && (
                                                                                Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'])
                                                                                  ? (
                                                                                    <div>
                                                                                      {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'] &&
                                                                                        Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'])
                                                                                        ? (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingInfo['$'] &&
                                                                                                  SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (
                                                                                                      segmentinfo['$'] &&
                                                                                                      segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                    ) {

                                                                                                      return (
                                                                                                        <div key={segmentindex}>

                                                                                                          <div>
                                                                                                            <div className="flight-details-d"><input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                              <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfo)} />
                                                                                                            </div>
                                                                                                            <div className="flight-details-a">
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handleAirline(segmentinfo['$']['Carrier'])
                                                                                                              } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                              &nbsp;

                                                                                                              {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handledatemonth(segmentinfo['$']['DepartureTime'])

                                                                                                              }
                                                                                                              <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>


                                                                                                            </div>

                                                                                                            <div className="clear" />
                                                                                                            <div className="flight-details-l">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-m">
                                                                                                              <div className="flight-details-e">
                                                                                                                {segmentinfo['$']
                                                                                                                  && (() => {
                                                                                                                    const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                    const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                    const minutes = flightTimeInMinutes % 60;
                                                                                                                    const formattedHours = String(hours).padStart(2, '0');
                                                                                                                    const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                    const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                    return formattedFlightTime;
                                                                                                                  })
                                                                                                                    ()}

                                                                                                              </div>
                                                                                                              <div className="flight-details-e">
                                                                                                                <hr />
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-r">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                                }
                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="clear" />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                      );
                                                                                                    }
                                                                                                  })
                                                                                                }


                                                                                              </div>
                                                                                            ))}


                                                                                          </div>
                                                                                        ) : (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                              pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                              SegmentList.map((segmentinfo, segmentindex) => {

                                                                                                if (
                                                                                                  segmentinfo['$'] &&
                                                                                                  segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                                ) {
                                                                                                  const bookingInfoo = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'];

                                                                                                  return (
                                                                                                    <div key={segmentindex}>

                                                                                                      <div>
                                                                                                        <div className="flight-details-d">
                                                                                                          <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                          <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfoo)} />
                                                                                                        </div>
                                                                                                        <div className="flight-details-a">
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handleAirline(segmentinfo['$']['Carrier'])
                                                                                                          } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                          &nbsp;

                                                                                                          {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                          }

                                                                                                          <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>

                                                                                                        </div>

                                                                                                        <div className="clear" />
                                                                                                        <div className="flight-details-l">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-m">
                                                                                                          <div className="flight-details-e">
                                                                                                            {segmentinfo['$']
                                                                                                              && (() => {
                                                                                                                const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                const minutes = flightTimeInMinutes % 60;
                                                                                                                const formattedHours = String(hours).padStart(2, '0');
                                                                                                                const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                return formattedFlightTime;
                                                                                                              })
                                                                                                                ()}

                                                                                                          </div>
                                                                                                          <div className="flight-details-e">
                                                                                                            <hr />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-r">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                            }
                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="clear" />
                                                                                                      </div>
                                                                                                    </div>
                                                                                                  );
                                                                                                }


                                                                                              })
                                                                                            }


                                                                                          </div>
                                                                                        )
                                                                                      }
                                                                                    </div>
                                                                                  ) : (
                                                                                    <div>
                                                                                      {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'] &&
                                                                                        Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'])
                                                                                        ? (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingInfo['$'] &&
                                                                                                  SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (
                                                                                                      segmentinfo['$'] &&
                                                                                                      segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                    ) {

                                                                                                      return (
                                                                                                        <div key={segmentindex}>

                                                                                                          <div>
                                                                                                            <div className="flight-details-d">
                                                                                                              <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                              <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfo)} />
                                                                                                            </div>
                                                                                                            <div className="flight-details-a">
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handleAirline(segmentinfo['$']['Carrier'])
                                                                                                              } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                              &nbsp;

                                                                                                              {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                              }
                                                                                                              <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>


                                                                                                            </div>

                                                                                                            <div className="clear" />
                                                                                                            <div className="flight-details-l">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-m">
                                                                                                              <div className="flight-details-e">
                                                                                                                {segmentinfo['$']
                                                                                                                  && (() => {
                                                                                                                    const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                    const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                    const minutes = flightTimeInMinutes % 60;
                                                                                                                    const formattedHours = String(hours).padStart(2, '0');
                                                                                                                    const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                    const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                    return formattedFlightTime;
                                                                                                                  })
                                                                                                                    ()}

                                                                                                              </div>
                                                                                                              <div className="flight-details-e">
                                                                                                                <hr />
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-r">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                                }
                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="clear" />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                      );
                                                                                                    }
                                                                                                  })
                                                                                                }


                                                                                              </div>
                                                                                            ))}
                                                                                          </div>
                                                                                        ) : (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$'] &&
                                                                                              pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                              SegmentList.map((segmentinfo, segmentindex) => {

                                                                                                if (
                                                                                                  segmentinfo['$'] &&
                                                                                                  segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                                ) {
                                                                                                  const bookingInfoo = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'];

                                                                                                  return (
                                                                                                    <div key={segmentindex}>

                                                                                                      <div>
                                                                                                        <div className="flight-details-d">
                                                                                                          <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                          <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfoo)} />
                                                                                                        </div>
                                                                                                        <div className="flight-details-a">
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handleAirline(segmentinfo['$']['Carrier'])
                                                                                                          } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                          &nbsp;

                                                                                                          {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                          }
                                                                                                          <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>


                                                                                                        </div>

                                                                                                        <div className="clear" />
                                                                                                        <div className="flight-details-l">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-m">
                                                                                                          <div className="flight-details-e">
                                                                                                            {segmentinfo['$']
                                                                                                              && (() => {
                                                                                                                const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                const minutes = flightTimeInMinutes % 60;
                                                                                                                const formattedHours = String(hours).padStart(2, '0');
                                                                                                                const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                return formattedFlightTime;
                                                                                                              })
                                                                                                                ()}

                                                                                                          </div>
                                                                                                          <div className="flight-details-e">
                                                                                                            <hr />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-r">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                            }
                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="clear" />
                                                                                                      </div>
                                                                                                    </div>
                                                                                                  );

                                                                                                }


                                                                                              })
                                                                                            }
                                                                                          </div>
                                                                                        )
                                                                                      }
                                                                                    </div>
                                                                                  )
                                                                              )
                                                                            }
                                                                          </div>
                                                                          <div id={`Fare_Summary${priceindex}`} className="tabcontent" style={{ display: activeTab === `Fare_Summary${priceindex}` ? 'block' : 'none' }}>

                                                                            <div className="flight-details-a">
                                                                              Fare Breakup (For All Passengers)
                                                                            </div>

                                                                            <div className="flight-details-l">
                                                                              <div className="flight-details-b">
                                                                                Total Fare
                                                                              </div>
                                                                              <div className="flight-details-c">
                                                                                Base Price
                                                                              </div>
                                                                              {Array.isArray(pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"])
                                                                                ? pricepoint["air:AirPricingInfo"]["air:TaxInfo"].map((tax, index) => (
                                                                                  <div key={index} className="flight-details-c">
                                                                                    {tax["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {tax["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                ))
                                                                                : pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"] && (
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                )}
                                                                              <div className="flight-details-c">
                                                                                Surcharge
                                                                              </div>
                                                                            </div>
                                                                            <div className="flight-details-r">
                                                                              <div className="flight-details-b">
                                                                                {pricepoint.$.TotalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.TotalPrice.replace('INR', '')}
                                                                              </div>
                                                                              <div className="flight-details-c">
                                                                                {pricepoint.$.BasePrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.BasePrice.replace('INR', '')}
                                                                              </div>
                                                                              {Array.isArray(pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"])
                                                                                ? pricepoint["air:AirPricingInfo"]["air:TaxInfo"].map((tax, index) => (
                                                                                  <div key={index} className="flight-details-c">
                                                                                    {tax["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {tax["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                ))
                                                                                : pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"] && (
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                )}
                                                                              <div className="flight-details-c">
                                                                                {pricepoint.$.Taxes.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.Taxes.replace('INR', '')}
                                                                              </div>
                                                                            </div>
                                                                            <div className="clear" />
                                                                          </div>
                                                                          <div id={`Date_Change${priceindex}`} className="tabcontent" style={{ display: activeTab === `Date_Change${priceindex}` ? 'block' : 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty'] &&
                                                                              <div>

                                                                                <div className="flight-details-a">
                                                                                  || {inputOrigin && inputOrigin.split('(')[0]} to {inputDestination && inputDestination.split('(')[0]} , &nbsp;
                                                                                  {
                                                                                    handledatemonthsplit(request.searchreturnDate.split('/'))

                                                                                  }
                                                                                </div>

                                                                                <div className="flight-details-l">
                                                                                  <div className="flight-details-b">
                                                                                    Time Frame
                                                                                  </div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['$']['PenaltyApplies'] ? (
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['$']['PenaltyApplies']
                                                                                    ) : (
                                                                                      'NA'
                                                                                    )}
                                                                                  </div>
                                                                                </div>
                                                                                <div className="flight-details-r">
                                                                                  <div className="flight-details-b">
                                                                                    Airline Fee+Fare diff.
                                                                                  </div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['air:Amount'] ? (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['air:Amount'].includes('INR') ? 'â‚¹ ' : ''}
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['air:Amount'].replace('INR', '')} Fare diff.
                                                                                      </>
                                                                                    ) : (
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['air:Percentage'] ? (
                                                                                        pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['air:Percentage']
                                                                                      ) : (
                                                                                        'NA'
                                                                                      )
                                                                                    )}
                                                                                  </div>
                                                                                </div>
                                                                                <div className="clear" />
                                                                                <br className="clear" />
                                                                                <div className="flight-details-c">
                                                                                  <mark>
                                                                                    *Please note that the airline
                                                                                    fee provided is indicative.
                                                                                    CoTrav does not guarantee the
                                                                                    exact amount of the fee.
                                                                                  </mark>
                                                                                </div>
                                                                                <div className="clear" />
                                                                              </div>
                                                                            }
                                                                          </div>
                                                                          <div id={`Cancellation${priceindex}`} className="tabcontent" style={{ display: activeTab === `Cancellation${priceindex}` ? 'block' : 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty'] &&
                                                                              <div>

                                                                                <div className="flight-details-a">
                                                                                  || {inputOrigin && inputOrigin.split('(')[0]} to {inputDestination && inputDestination.split('(')[0]} , &nbsp;
                                                                                  {
                                                                                    handledatemonthsplit(request.searchreturnDate.split('/'))
                                                                                  }
                                                                                </div>

                                                                                <div className="flight-details-l">
                                                                                  <div className="flight-details-b">
                                                                                    Time Frame
                                                                                  </div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['$']['PenaltyApplies'] ? (
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['$']['PenaltyApplies']
                                                                                    ) : (
                                                                                      'NA'
                                                                                    )}
                                                                                  </div>
                                                                                </div>
                                                                                <div className="flight-details-r">
                                                                                  <div className="flight-details-b">
                                                                                    Airline Fee+Fare diff.
                                                                                  </div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['air:Amount'] ? (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['air:Amount'].includes('INR') ? 'â‚¹ ' : ''}
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['air:Amount'].replace('INR', '')} Fare diff.
                                                                                      </>
                                                                                    ) : (
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['air:Percentage'] ? (
                                                                                        pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['air:Percentage']
                                                                                      ) : (
                                                                                        'NA'
                                                                                      )
                                                                                    )}
                                                                                  </div>
                                                                                </div>
                                                                                <div className="clear" />
                                                                                <br className="clear" />
                                                                                <div className="flight-details-c">
                                                                                  <mark>
                                                                                    *Please note that the airline
                                                                                    fee provided is indicative.
                                                                                    CoTrav does not guarantee the
                                                                                    exact amount of the fee.
                                                                                  </mark>
                                                                                </div>
                                                                                <div className="clear" />
                                                                              </div>
                                                                            }
                                                                          </div>
                                                                        </div>
                                                                      ) : (
                                                                        <div>
                                                                          <div id={`Flight_Detail${priceindex}`} className="tabcontent" style={activeTab.includes(`Flight_Detail${priceindex}`) ? { display: 'block' } : { display: 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                                                              pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'] &&
                                                                              pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'] && (
                                                                                Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'])
                                                                                  ? (
                                                                                    <div>
                                                                                      {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'] &&
                                                                                        Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'])
                                                                                        ? (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingInfo['$'] &&
                                                                                                  SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (
                                                                                                      segmentinfo['$'] &&
                                                                                                      segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                    ) {

                                                                                                      return (
                                                                                                        <div key={segmentindex}>

                                                                                                          <div>
                                                                                                            <div className="flight-details-d">
                                                                                                              <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                              <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfo)} />
                                                                                                            </div>
                                                                                                            <div className="flight-details-a">
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handleAirline(segmentinfo['$']['Carrier'])
                                                                                                              } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                              &nbsp;

                                                                                                              {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handledatemonth(segmentinfo['$']['DepartureTime'])

                                                                                                              }

                                                                                                              <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>

                                                                                                            </div>

                                                                                                            <div className="clear" />
                                                                                                            <div className="flight-details-l">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-m">
                                                                                                              <div className="flight-details-e">
                                                                                                                {segmentinfo['$']
                                                                                                                  && (() => {
                                                                                                                    const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                    const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                    const minutes = flightTimeInMinutes % 60;
                                                                                                                    const formattedHours = String(hours).padStart(2, '0');
                                                                                                                    const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                    const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                    return formattedFlightTime;
                                                                                                                  })
                                                                                                                    ()}

                                                                                                              </div>
                                                                                                              <div className="flight-details-e">
                                                                                                                <hr />
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-r">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                                }
                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="clear" />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                      );
                                                                                                    }
                                                                                                  })
                                                                                                }


                                                                                              </div>
                                                                                            ))}


                                                                                          </div>
                                                                                        ) : (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                              pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                              SegmentList.map((segmentinfo, segmentindex) => {

                                                                                                if (
                                                                                                  segmentinfo['$'] &&
                                                                                                  segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                                ) {
                                                                                                  const bookingInfoo = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option'][0]['air:BookingInfo'];

                                                                                                  return (
                                                                                                    <div key={segmentindex}>

                                                                                                      <div>
                                                                                                        <div className="flight-details-d">
                                                                                                          <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                          <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfoo)} />
                                                                                                        </div>
                                                                                                        <div className="flight-details-a">
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handleAirline(segmentinfo['$']['Carrier'])
                                                                                                          } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                          &nbsp;

                                                                                                          {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                          }

                                                                                                          <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>

                                                                                                        </div>

                                                                                                        <div className="clear" />
                                                                                                        <div className="flight-details-l">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-m">
                                                                                                          <div className="flight-details-e">
                                                                                                            {segmentinfo['$']
                                                                                                              && (() => {
                                                                                                                const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                const minutes = flightTimeInMinutes % 60;
                                                                                                                const formattedHours = String(hours).padStart(2, '0');
                                                                                                                const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                return formattedFlightTime;
                                                                                                              })
                                                                                                                ()}

                                                                                                          </div>
                                                                                                          <div className="flight-details-e">
                                                                                                            <hr />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-r">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                            }
                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="clear" />
                                                                                                      </div>
                                                                                                    </div>
                                                                                                  );
                                                                                                }


                                                                                              })
                                                                                            }


                                                                                          </div>
                                                                                        )
                                                                                      }
                                                                                    </div>
                                                                                  ) : (
                                                                                    <div>
                                                                                      {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'] &&
                                                                                        Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'])
                                                                                        ? (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingInfo['$'] &&
                                                                                                  SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (
                                                                                                      segmentinfo['$'] &&
                                                                                                      segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                    ) {

                                                                                                      return (
                                                                                                        <div key={segmentindex}>

                                                                                                          <div>
                                                                                                            <div className="flight-details-d">
                                                                                                              <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                              <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfo)} />
                                                                                                            </div>
                                                                                                            <div className="flight-details-a">
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handleAirline(segmentinfo['$']['Carrier'])
                                                                                                              } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                              &nbsp;

                                                                                                              {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                              }
                                                                                                              <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>


                                                                                                            </div>

                                                                                                            <div className="clear" />
                                                                                                            <div className="flight-details-l">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-m">
                                                                                                              <div className="flight-details-e">
                                                                                                                {segmentinfo['$']
                                                                                                                  && (() => {
                                                                                                                    const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                    const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                    const minutes = flightTimeInMinutes % 60;
                                                                                                                    const formattedHours = String(hours).padStart(2, '0');
                                                                                                                    const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                    const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                    return formattedFlightTime;
                                                                                                                  })
                                                                                                                    ()}

                                                                                                              </div>
                                                                                                              <div className="flight-details-e">
                                                                                                                <hr />
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-r">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                                }
                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="clear" />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                      );
                                                                                                    }
                                                                                                  })
                                                                                                }


                                                                                              </div>
                                                                                            ))}
                                                                                          </div>
                                                                                        ) : (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$'] &&
                                                                                              pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                              SegmentList.map((segmentinfo, segmentindex) => {

                                                                                                if (
                                                                                                  segmentinfo['$'] &&
                                                                                                  segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                                ) {
                                                                                                  const bookingInfoo = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'][1]['air:Option']['air:BookingInfo'];

                                                                                                  return (
                                                                                                    <div key={segmentindex}>

                                                                                                      <div>
                                                                                                        <div className="flight-details-d">
                                                                                                          <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                          <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfoo)} />
                                                                                                        </div>
                                                                                                        <div className="flight-details-a">
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handleAirline(segmentinfo['$']['Carrier'])
                                                                                                          } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                          &nbsp;

                                                                                                          {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                          }
                                                                                                          <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>


                                                                                                        </div>

                                                                                                        <div className="clear" />
                                                                                                        <div className="flight-details-l">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-m">
                                                                                                          <div className="flight-details-e">
                                                                                                            {segmentinfo['$']
                                                                                                              && (() => {
                                                                                                                const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                const minutes = flightTimeInMinutes % 60;
                                                                                                                const formattedHours = String(hours).padStart(2, '0');
                                                                                                                const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                return formattedFlightTime;
                                                                                                              })
                                                                                                                ()}

                                                                                                          </div>
                                                                                                          <div className="flight-details-e">
                                                                                                            <hr />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-r">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                            }
                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="clear" />
                                                                                                      </div>
                                                                                                    </div>
                                                                                                  );

                                                                                                }


                                                                                              })
                                                                                            }
                                                                                          </div>
                                                                                        )
                                                                                      }
                                                                                    </div>
                                                                                  )
                                                                              )
                                                                            }
                                                                          </div>
                                                                          <div id={`Fare_Summary${priceindex}`} className="tabcontent" style={{ display: activeTab === `Fare_Summary${priceindex}` ? 'block' : 'none' }}>

                                                                            <div className="flight-details-a">
                                                                              Fare Breakup (For All Passengers)
                                                                            </div>

                                                                            <div className="flight-details-l">
                                                                              <div className="flight-details-b">
                                                                                Total Fare
                                                                              </div>
                                                                              <div className="flight-details-c">
                                                                                Base Price
                                                                              </div>
                                                                              {Array.isArray(pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"])
                                                                                ? pricepoint["air:AirPricingInfo"]["air:TaxInfo"].map((tax, index) => (
                                                                                  <div key={index} className="flight-details-c">
                                                                                    {tax["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {tax["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                ))
                                                                                : pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"] && (
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                )}
                                                                              <div className="flight-details-c">
                                                                                Surcharge
                                                                              </div>
                                                                            </div>
                                                                            <div className="flight-details-r">
                                                                              <div className="flight-details-b">
                                                                                {pricepoint.$.TotalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.TotalPrice.replace('INR', '')}
                                                                              </div>
                                                                              <div className="flight-details-c">
                                                                                {pricepoint.$.BasePrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.BasePrice.replace('INR', '')}
                                                                              </div>
                                                                              {Array.isArray(pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"])
                                                                                ? pricepoint["air:AirPricingInfo"]["air:TaxInfo"].map((tax, index) => (
                                                                                  <div key={index} className="flight-details-c">
                                                                                    {tax["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {tax["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                ))
                                                                                : pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"] && (
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                )}
                                                                              <div className="flight-details-c">
                                                                                {pricepoint.$.Taxes.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.Taxes.replace('INR', '')}
                                                                              </div>
                                                                            </div>
                                                                            <div className="clear" />
                                                                          </div>
                                                                          <div id={`Date_Change${priceindex}`} className="tabcontent" style={{ display: activeTab === `Date_Change${priceindex}` ? 'block' : 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo']['air:ChangePenalty'] &&
                                                                              <div>

                                                                                <div className="flight-details-a">
                                                                                  || {inputOrigin && inputOrigin.split('(')[0]} to {inputDestination && inputDestination.split('(')[0]} , &nbsp;
                                                                                  {
                                                                                    handledatemonthsplit(request.searchreturnDate.split('/'))

                                                                                  }
                                                                                </div>

                                                                                <div className="flight-details-l">
                                                                                  <div className="flight-details-b">
                                                                                    Time Frame
                                                                                  </div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo']['air:ChangePenalty']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo']['air:ChangePenalty']['$']['PenaltyApplies'] ? (
                                                                                      pricepoint['air:AirPricingInfo']['air:ChangePenalty']['$']['PenaltyApplies']
                                                                                    ) : (
                                                                                      'NA'
                                                                                    )}
                                                                                  </div>
                                                                                </div>
                                                                                <div className="flight-details-r">
                                                                                  <div className="flight-details-b">
                                                                                    Airline Fee+Fare diff.
                                                                                  </div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo']['air:ChangePenalty']['air:Amount'] ? (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo']['air:ChangePenalty']['air:Amount'].includes('INR') ? 'â‚¹ ' : ''}
                                                                                        {pricepoint['air:AirPricingInfo']['air:ChangePenalty']['air:Amount'].replace('INR', '')} Fare diff.
                                                                                      </>
                                                                                    ) : (
                                                                                      pricepoint['air:AirPricingInfo']['air:ChangePenalty']['air:Percentage'] ? (
                                                                                        pricepoint['air:AirPricingInfo']['air:ChangePenalty']['air:Percentage']
                                                                                      ) : (
                                                                                        'NA'
                                                                                      )
                                                                                    )}
                                                                                  </div>
                                                                                </div>
                                                                                <div className="clear" />
                                                                                <br className="clear" />
                                                                                <div className="flight-details-c">
                                                                                  <mark>
                                                                                    *Please note that the airline
                                                                                    fee provided is indicative.
                                                                                    CoTrav does not guarantee the
                                                                                    exact amount of the fee.
                                                                                  </mark>
                                                                                </div>
                                                                                <div className="clear" />
                                                                              </div>
                                                                            }
                                                                          </div>
                                                                          <div id={`Cancellation${priceindex}`} className="tabcontent" style={{ display: activeTab === `Cancellation${priceindex}` ? 'block' : 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo']['air:CancelPenalty'] &&
                                                                              <div>

                                                                                <div className="flight-details-a">
                                                                                  || {inputOrigin && inputOrigin.split('(')[0]} to {inputDestination && inputDestination.split('(')[0]} , &nbsp;
                                                                                  {
                                                                                    handledatemonthsplit(request.searchreturnDate.split('/'))
                                                                                  }
                                                                                </div>

                                                                                <div className="flight-details-l">
                                                                                  <div className="flight-details-b">
                                                                                    Time Frame
                                                                                  </div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo']['air:CancelPenalty']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo']['air:CancelPenalty']['$']['PenaltyApplies'] ? (
                                                                                      pricepoint['air:AirPricingInfo']['air:CancelPenalty']['$']['PenaltyApplies']
                                                                                    ) : (
                                                                                      'NA'
                                                                                    )}
                                                                                  </div>
                                                                                </div>
                                                                                <div className="flight-details-r">
                                                                                  <div className="flight-details-b">
                                                                                    Airline Fee+Fare diff.
                                                                                  </div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo']['air:CancelPenalty']['air:Amount'] ? (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo']['air:CancelPenalty']['air:Amount'].includes('INR') ? 'â‚¹ ' : ''}
                                                                                        {pricepoint['air:AirPricingInfo']['air:CancelPenalty']['air:Amount'].replace('INR', '')} Fare diff.
                                                                                      </>
                                                                                    ) : (
                                                                                      pricepoint['air:AirPricingInfo']['air:CancelPenalty']['air:Percentage'] ? (
                                                                                        pricepoint['air:AirPricingInfo']['air:CancelPenalty']['air:Percentage']
                                                                                      ) : (
                                                                                        'NA'
                                                                                      )
                                                                                    )}
                                                                                  </div>
                                                                                </div>
                                                                                <div className="clear" />
                                                                                <br className="clear" />
                                                                                <div className="flight-details-c">
                                                                                  <mark>
                                                                                    *Please note that the airline
                                                                                    fee provided is indicative.
                                                                                    CoTrav does not guarantee the
                                                                                    exact amount of the fee.
                                                                                  </mark>
                                                                                </div>
                                                                                <div className="clear" />
                                                                              </div>
                                                                            }
                                                                          </div>
                                                                        </div>
                                                                      )
                                                                  )

                                                                  }
                                                                </div>



                                                              </div>
                                                            </div>
                                                          </div>
                                                          <br className="clear" />
                                                        </div>
                                                      </div>
                                                      <div className="clear" />
                                                    </div>
                                                    <br className="clear" />
                                                  </div>
                                                  {isDropdownVisible && selectedPriceIndex === priceindex && (
                                                    <div className="row selectcontainer">
                                                      {/* Indigo price loader */}
                                                      {loadingIndex === priceindex ? (
                                                        <div className="loader custom-loader item-center justify-center flex items-center">
                                                          <img className="loader-giff" style={{ width: '5rem', height: '5rem' }} src="/img/cotravloader.gif" alt="Loader" />
                                                          <p className="text-center ml-4 text-gray-600">
                                                          </p>
                                                        </div>
                                                      ) : (
                                                        /* Actual Content */
                                                        priceParse && priceParse.map((priceParseData, priceParseindex) => (
                                                          <div key={priceParseindex} className='col-md-3 optionsflights' style={{ display: "flex" }}>
                                                            <div className='optionsflight' >
                                                              {priceParseData['air:AirPricingInfo'] && (
                                                                Array.isArray(priceParseData['air:AirPricingInfo'])
                                                                  ? (
                                                                    priceParseData['air:AirPricingInfo'][0]['air:FareInfo'] && (
                                                                      Array.isArray(priceParseData['air:AirPricingInfo'][0]['air:FareInfo'])
                                                                        ? (
                                                                          priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['air:Text'] ? (
                                                                            Array.isArray(priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['air:Text'])
                                                                              ? (
                                                                                <div className="modal-data">
                                                                                  <div className="seelctheader">{priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name']}
                                                                                    <button
                                                                                      type="button"
                                                                                      onClick={() => toggleDetails(priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name'])}

                                                                                      style={{
                                                                                        border: "none",
                                                                                        background: "none",
                                                                                        cursor: "pointer",
                                                                                        fontSize: "16px",
                                                                                        color: "#785eff",
                                                                                      }}
                                                                                      aria-label="Toggle Details"
                                                                                    >
                                                                                      <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                    </button></div>
                                                                                  <div className="selectprice">
                                                                                    {(() => {
                                                                                      const totalPrice = priceParseData['air:AirPricingInfo'][0].$.TotalPrice;
                                                                                      const numericTotalPrice = totalPrice.replace('INR', '').trim();

                                                                                      const airline = inputOrigin;
                                                                                      const calculatedPrice = calculateFinalPrice(
                                                                                        numericTotalPrice,
                                                                                        markupdata,
                                                                                        cabinClass,
                                                                                        priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name'],// Pass the fare name (e.g., "ECO VALUE")
                                                                                        airline, flight_type
                                                                                      );

                                                                                      return (
                                                                                        <>
                                                                                          {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                          {calculatedPrice}
                                                                                        </>
                                                                                      );
                                                                                    })()}
                                                                                  </div>
                                                                                  {visibleDetails && visibleDetailsByName === priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name'] && (
                                                                                    priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['air:Text'].map((textinfor, textindex) => {
                                                                                      if (
                                                                                        textinfor['$'] &&
                                                                                        textinfor['$']['Type'] === "MarketingConsumer"
                                                                                      ) {

                                                                                        const infoArray = textinfor['_'].split('\n').filter(item => item.trim() !== '');

                                                                                        return (
                                                                                          <>
                                                                                            <div className="popup-overlay" onClick={() => setVisibleDetails(false)}></div>
                                                                                            <div key={textindex} className="selectdetail">
                                                                                              <button className="selectdetail-close" style={{ marginTop: "-3.5%", marginRight: "-3.5%" }} onClick={() => setVisibleDetails(false)}>&times;</button>
                                                                                              <ul>
                                                                                                {infoArray.map((item, index) => (
                                                                                                  <li key={index}>{item.trim()}</li>
                                                                                                ))}
                                                                                              </ul>
                                                                                            </div>
                                                                                          </>
                                                                                        );
                                                                                      }

                                                                                    })
                                                                                  )}
                                                                                </div>
                                                                              ) : (
                                                                                <>
                                                                                  <div>
                                                                                    <div className="seelctheader">{priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name']}
                                                                                      <button
                                                                                        type="button"
                                                                                        onClick={() => toggleDetails(priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name'])}

                                                                                        style={{
                                                                                          border: "none",
                                                                                          background: "none",
                                                                                          cursor: "pointer",
                                                                                          fontSize: "16px",
                                                                                          color: "#785eff",
                                                                                        }}
                                                                                        aria-label="Toggle Details"
                                                                                      >
                                                                                        <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                      </button></div>
                                                                                    <div className="selectprice">
                                                                                      {(() => {
                                                                                        const totalPrice = priceParseData['air:AirPricingInfo'][0].$.TotalPrice;
                                                                                        const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                        const airline = inputOrigin;
                                                                                        const calculatedPrice = calculateFinalPrice(
                                                                                          numericTotalPrice,
                                                                                          markupdata,
                                                                                          cabinClass,
                                                                                          priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                          , airline, flight_type
                                                                                        );

                                                                                        return (
                                                                                          <>
                                                                                            {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                            {calculatedPrice}
                                                                                          </>
                                                                                        );
                                                                                      })()}
                                                                                    </div>
                                                                                    {visibleDetails && visibleDetailsByName === priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name'] && (
                                                                                      <>
                                                                                        <div className="popup-overlay" onClick={() => setVisibleDetails(false)}></div>
                                                                                        <div className="selectdetail">
                                                                                          <button className="selectdetail-close" style={{ marginTop: "-3.5%", marginRight: "-3.5%" }} onClick={() => setVisibleDetails(false)}>&times;</button>
                                                                                          <ul><li>
                                                                                            {priceParseData['air:AirPricingInfo'][0]['air:FareInfo'] && priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0] &&
                                                                                              priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['common_v52_0:Endorsement'] &&
                                                                                              priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['common_v52_0:Endorsement']['$'] &&
                                                                                              priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['common_v52_0:Endorsement']['$']['Value']}
                                                                                          </li></ul>
                                                                                        </div>
                                                                                      </>
                                                                                    )}
                                                                                  </div>
                                                                                </>
                                                                              )
                                                                          ) : (
                                                                            <>
                                                                              <div>
                                                                                <div className="seelctheader">{priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name']}
                                                                                  <button
                                                                                    type="button"
                                                                                    onClick={() => toggleDetails(priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name'])}

                                                                                    style={{
                                                                                      border: "none",
                                                                                      background: "none",
                                                                                      cursor: "pointer",
                                                                                      fontSize: "16px",
                                                                                      color: "#785eff",
                                                                                    }}
                                                                                    aria-label="Toggle Details"
                                                                                  >
                                                                                    <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                  </button></div>
                                                                                <div className="selectprice">
                                                                                  {(() => {
                                                                                    const totalPrice = priceParseData['air:AirPricingInfo'][0].$.TotalPrice;
                                                                                    const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                    const airline = inputOrigin;
                                                                                    const calculatedPrice = calculateFinalPrice(
                                                                                      numericTotalPrice,
                                                                                      markupdata,
                                                                                      cabinClass,
                                                                                      priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                      , airline, flight_type
                                                                                    );

                                                                                    return (
                                                                                      <>
                                                                                        {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                        {calculatedPrice}
                                                                                      </>
                                                                                    );
                                                                                  })()}
                                                                                </div>
                                                                                {visibleDetails && visibleDetailsByName === priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name'] && (
                                                                                  <>
                                                                                    <div className="popup-overlay" onClick={() => setVisibleDetails(false)}></div>
                                                                                    <div className="selectdetail">
                                                                                      <button className="selectdetail-close" style={{ marginTop: "-3.5%", marginRight: "-3.5%" }} onClick={() => setVisibleDetails(false)}>&times;</button>
                                                                                      <ul><li>
                                                                                        {priceParseData['air:AirPricingInfo'][0]['air:FareInfo'] && priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0] &&
                                                                                          priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['common_v52_0:Endorsement'] &&
                                                                                          priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['common_v52_0:Endorsement']['$'] &&
                                                                                          priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['common_v52_0:Endorsement']['$']['Value']}
                                                                                      </li></ul>
                                                                                    </div>
                                                                                  </>
                                                                                )}
                                                                              </div>
                                                                            </>
                                                                          )

                                                                        ) : (
                                                                          priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['air:Text'] ? (
                                                                            Array.isArray(priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['air:Text'])
                                                                              ? (
                                                                                <div>
                                                                                  <div className="seelctheader">{priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name']}
                                                                                    <button
                                                                                      type="button"
                                                                                      onClick={() => toggleDetails(priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name'])}

                                                                                      style={{
                                                                                        border: "none",
                                                                                        background: "none",
                                                                                        cursor: "pointer",
                                                                                        fontSize: "16px",
                                                                                        color: "#785eff",
                                                                                      }}
                                                                                      aria-label="Toggle Details"
                                                                                    >
                                                                                      <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                    </button></div>
                                                                                  <div className="selectprice">
                                                                                    {(() => {
                                                                                      const totalPrice = priceParseData['air:AirPricingInfo'][0].$.TotalPrice;
                                                                                      const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                      const airline = inputOrigin;
                                                                                      const calculatedPrice = calculateFinalPrice(
                                                                                        numericTotalPrice,
                                                                                        markupdata,
                                                                                        cabinClass,
                                                                                        priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                        , airline, flight_type
                                                                                      );

                                                                                      return (
                                                                                        <>
                                                                                          {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                          {calculatedPrice}
                                                                                        </>
                                                                                      );
                                                                                    })()}
                                                                                  </div>
                                                                                  {visibleDetails && visibleDetailsByName === priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name'] && (
                                                                                    priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['air:Text'].map((textinfor, textindex) => {
                                                                                      if (
                                                                                        textinfor['$'] &&
                                                                                        textinfor['$']['Type'] === "MarketingConsumer"
                                                                                      ) {

                                                                                        const infoArray = textinfor['_'].split('\n').filter(item => item.trim() !== '');

                                                                                        return (
                                                                                          <>
                                                                                            <div className="popup-overlay" onClick={() => setVisibleDetails(false)}></div>
                                                                                            <div key={textindex} className="selectdetail">
                                                                                              <button className="selectdetail-close" style={{ marginTop: "-3.5%", marginRight: "-3.5%" }} onClick={() => setVisibleDetails(false)}>&times;</button>
                                                                                              <ul>
                                                                                                {infoArray.map((item, index) => (
                                                                                                  <li key={index}>{item.trim()}</li>
                                                                                                ))}
                                                                                              </ul>
                                                                                            </div>
                                                                                          </>
                                                                                        );
                                                                                      }

                                                                                    })
                                                                                  )}
                                                                                </div>
                                                                              ) : (
                                                                                <>
                                                                                  <div>
                                                                                    <div className="seelctheader">{priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name']}
                                                                                      <button
                                                                                        type="button"
                                                                                        onClick={() => toggleDetails(priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name'])}

                                                                                        style={{
                                                                                          border: "none",
                                                                                          background: "none",
                                                                                          cursor: "pointer",
                                                                                          fontSize: "16px",
                                                                                          color: "#785eff",
                                                                                        }}
                                                                                        aria-label="Toggle Details"
                                                                                      >
                                                                                        <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                      </button></div>
                                                                                    <div className="selectprice">
                                                                                      {(() => {
                                                                                        const totalPrice = priceParseData['air:AirPricingInfo'][0].$.TotalPrice;
                                                                                        const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                        const airline = inputOrigin;
                                                                                        const calculatedPrice = calculateFinalPrice(
                                                                                          numericTotalPrice,
                                                                                          markupdata,
                                                                                          cabinClass,
                                                                                          priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                          , airline, flight_type
                                                                                        );

                                                                                        return (
                                                                                          <>
                                                                                            {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                            {calculatedPrice}
                                                                                          </>
                                                                                        );
                                                                                      })()}
                                                                                    </div>
                                                                                    {visibleDetails && visibleDetailsByName === priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name'] && (
                                                                                      <>
                                                                                        <div className="popup-overlay" onClick={() => setVisibleDetails(false)}></div>
                                                                                        <div className="selectdetail">
                                                                                          <button className="selectdetail-close" style={{ marginTop: "-3.5%", marginRight: "-3.5%" }} onClick={() => setVisibleDetails(false)}>&times;</button>
                                                                                          <ul><li>
                                                                                            {priceParseData['air:AirPricingInfo'][0]['air:FareInfo'] &&
                                                                                              priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['common_v52_0:Endorsement'] &&
                                                                                              priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['common_v52_0:Endorsement']['$'] &&
                                                                                              priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['common_v52_0:Endorsement']['$']['Value']}
                                                                                          </li></ul>
                                                                                        </div>
                                                                                      </>
                                                                                    )}
                                                                                  </div>
                                                                                </>
                                                                              )
                                                                          ) : (
                                                                            <>
                                                                              <div>
                                                                                <div className="seelctheader">{priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name']}
                                                                                  <button
                                                                                    type="button"
                                                                                    onClick={() => toggleDetails(priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name'])}

                                                                                    style={{
                                                                                      border: "none",
                                                                                      background: "none",
                                                                                      cursor: "pointer",
                                                                                      fontSize: "16px",
                                                                                      color: "#785eff",
                                                                                    }}
                                                                                    aria-label="Toggle Details"
                                                                                  >
                                                                                    <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                  </button></div>
                                                                                <div className="selectprice">
                                                                                  {(() => {
                                                                                    const totalPrice = priceParseData['air:AirPricingInfo'][0].$.TotalPrice;
                                                                                    const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                    const airline = inputOrigin;

                                                                                    const calculatedPrice = calculateFinalPrice(
                                                                                      numericTotalPrice,
                                                                                      markupdata,
                                                                                      cabinClass,
                                                                                      priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                      , airline, flight_type
                                                                                    );

                                                                                    return (
                                                                                      <>
                                                                                        {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                        {calculatedPrice}
                                                                                      </>
                                                                                    );
                                                                                  })()}
                                                                                </div>
                                                                                {visibleDetails && visibleDetailsByName === priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name'] && (
                                                                                  <>
                                                                                    <div className="popup-overlay" onClick={() => setVisibleDetails(false)}></div>
                                                                                    <div className="selectdetail">
                                                                                      <button className="selectdetail-close" style={{ marginTop: "-3.5%", marginRight: "-3.5%" }} onClick={() => setVisibleDetails(false)}>&times;</button>
                                                                                      <ul><li>
                                                                                        {priceParseData['air:AirPricingInfo'][0]['air:FareInfo'] &&
                                                                                          priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['common_v52_0:Endorsement'] &&
                                                                                          priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['common_v52_0:Endorsement']['$'] &&
                                                                                          priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['common_v52_0:Endorsement']['$']['Value']}
                                                                                      </li></ul>
                                                                                    </div>
                                                                                  </>
                                                                                )}
                                                                              </div>
                                                                            </>
                                                                          )
                                                                        )

                                                                    )

                                                                  ) : (
                                                                    priceParseData['air:AirPricingInfo']['air:FareInfo'] && (
                                                                      Array.isArray(priceParseData['air:AirPricingInfo']['air:FareInfo'])
                                                                        ? (
                                                                          priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['air:Text'] ? (
                                                                            Array.isArray(priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['air:Text'])
                                                                              ? (
                                                                                <div>
                                                                                  <div className="seelctheader">{priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name']}
                                                                                    <button
                                                                                      type="button"
                                                                                      onClick={() => toggleDetails(priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name'])}

                                                                                      style={{
                                                                                        border: "none",
                                                                                        background: "none",
                                                                                        cursor: "pointer",
                                                                                        fontSize: "16px",
                                                                                        color: "#785eff",
                                                                                      }}
                                                                                      aria-label="Toggle Details"
                                                                                    >
                                                                                      <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                    </button></div>
                                                                                  <div className="selectprice">
                                                                                    {(() => {
                                                                                      const totalPrice = priceParseData['air:AirPricingInfo'].$.TotalPrice;
                                                                                      const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                      const airline = inputOrigin;
                                                                                      const calculatedPrice = calculateFinalPrice(
                                                                                        numericTotalPrice,
                                                                                        markupdata,
                                                                                        cabinClass,
                                                                                        priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                        , airline, flight_type
                                                                                      );

                                                                                      return (
                                                                                        <>
                                                                                          {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                          {calculatedPrice}
                                                                                        </>
                                                                                      );
                                                                                    })()}
                                                                                  </div>
                                                                                  {visibleDetails && visibleDetailsByName === priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name'] && (
                                                                                    priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['air:Text'].map((textinfor, textindex) => {
                                                                                      if (
                                                                                        textinfor['$'] &&
                                                                                        textinfor['$']['Type'] === "MarketingConsumer"
                                                                                      ) {

                                                                                        const infoArray = textinfor['_'].split('\n').filter(item => item.trim() !== '');

                                                                                        return (
                                                                                          <>
                                                                                            <div className="popup-overlay" onClick={() => setVisibleDetails(false)}></div>
                                                                                            <div key={textindex} className="selectdetail">
                                                                                              <button className="selectdetail-close" style={{ marginTop: "-3.5%", marginRight: "-3.5%" }} onClick={() => setVisibleDetails(false)}>&times;</button>
                                                                                              <ul>
                                                                                                {infoArray.map((item, index) => (
                                                                                                  <li key={index}>{item.trim()}</li>
                                                                                                ))}
                                                                                              </ul>
                                                                                            </div>
                                                                                          </>
                                                                                        );
                                                                                      }

                                                                                    })
                                                                                  )}
                                                                                </div>
                                                                              ) : (
                                                                                <>
                                                                                  <div>
                                                                                    <div className="seelctheader">{priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name']}
                                                                                      <button
                                                                                        type="button"
                                                                                        onClick={() => toggleDetails(priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name'])}

                                                                                        style={{
                                                                                          border: "none",
                                                                                          background: "none",
                                                                                          cursor: "pointer",
                                                                                          fontSize: "16px",
                                                                                          color: "#785eff",
                                                                                        }}
                                                                                        aria-label="Toggle Details"
                                                                                      >
                                                                                        <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                      </button></div>
                                                                                    <div className="selectprice">
                                                                                      {(() => {
                                                                                        const totalPrice = priceParseData['air:AirPricingInfo'].$.TotalPrice;
                                                                                        const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                        const airline = inputOrigin;
                                                                                        const calculatedPrice = calculateFinalPrice(
                                                                                          numericTotalPrice,
                                                                                          markupdata,
                                                                                          cabinClass,
                                                                                          priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                          , airline, flight_type
                                                                                        );

                                                                                        return (
                                                                                          <>
                                                                                            {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                            {calculatedPrice}
                                                                                          </>
                                                                                        );
                                                                                      })()}
                                                                                    </div>
                                                                                    {visibleDetails && visibleDetailsByName === priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name'] && (
                                                                                      <>
                                                                                        <div className="popup-overlay" onClick={() => setVisibleDetails(false)}></div>
                                                                                        <div className="selectdetail">
                                                                                          <button className="selectdetail-close" style={{ marginTop: "-3.5%", marginRight: "-3.5%" }} onClick={() => setVisibleDetails(false)}>&times;</button>
                                                                                          <ul><li>
                                                                                            {priceParseData['air:AirPricingInfo']['air:FareInfo'] && priceParseData['air:AirPricingInfo']['air:FareInfo'][0] &&
                                                                                              priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['common_v52_0:Endorsement'] &&
                                                                                              priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['common_v52_0:Endorsement']['$'] &&
                                                                                              priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['common_v52_0:Endorsement']['$']['Value']}
                                                                                          </li></ul>
                                                                                        </div>
                                                                                      </>
                                                                                    )}
                                                                                  </div>
                                                                                </>
                                                                              )
                                                                          ) : (
                                                                            <>
                                                                              <div>
                                                                                <div className="seelctheader">{priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name']}
                                                                                  <button
                                                                                    type="button"
                                                                                    onClick={() => toggleDetails(priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name'])}

                                                                                    style={{
                                                                                      border: "none",
                                                                                      background: "none",
                                                                                      cursor: "pointer",
                                                                                      fontSize: "16px",
                                                                                      color: "#785eff",
                                                                                    }}
                                                                                    aria-label="Toggle Details"
                                                                                  >
                                                                                    <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                  </button></div>
                                                                                <div className="selectprice">
                                                                                  {(() => {
                                                                                    const totalPrice = priceParseData['air:AirPricingInfo'].$.TotalPrice;
                                                                                    const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                    const airline = inputOrigin;

                                                                                    const calculatedPrice = calculateFinalPrice(
                                                                                      numericTotalPrice,
                                                                                      markupdata,
                                                                                      cabinClass,
                                                                                      priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                      , airline, flight_type
                                                                                    );

                                                                                    return (
                                                                                      <>
                                                                                        {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                        {calculatedPrice}
                                                                                      </>
                                                                                    );
                                                                                  })()}
                                                                                </div>
                                                                                {visibleDetails && visibleDetailsByName === priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name'] && (
                                                                                  <>
                                                                                    <div className="popup-overlay" onClick={() => setVisibleDetails(false)}></div>
                                                                                    <div className="selectdetail">
                                                                                      <button className="selectdetail-close" style={{ marginTop: "-3.5%", marginRight: "-3.5%" }} onClick={() => setVisibleDetails(false)}>&times;</button>
                                                                                      <ul><li>
                                                                                        {priceParseData && priceParseData['air:AirPricingInfo'] && priceParseData['air:AirPricingInfo']['air:FareInfo'] && priceParseData['air:AirPricingInfo']['air:FareInfo'][0] &&
                                                                                          priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['common_v52_0:Endorsement'] &&
                                                                                          priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['common_v52_0:Endorsement']['$'] &&
                                                                                          priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['common_v52_0:Endorsement']['$']['Value']}
                                                                                      </li></ul>
                                                                                    </div>
                                                                                  </>
                                                                                )}
                                                                              </div>
                                                                            </>
                                                                          )

                                                                        ) : (

                                                                          priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['air:Text'] &&
                                                                            priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['air:Text'] ? (
                                                                            Array.isArray(priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['air:Text'])

                                                                              ? (
                                                                                <div>
                                                                                  <div className="seelctheader">{priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name']}
                                                                                    <button
                                                                                      type="button"
                                                                                      onClick={() => toggleDetails(priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name'])}

                                                                                      style={{
                                                                                        border: "none",
                                                                                        background: "none",
                                                                                        cursor: "pointer",
                                                                                        fontSize: "16px",
                                                                                        color: "#785eff",
                                                                                      }}
                                                                                      aria-label="Toggle Details"
                                                                                    >
                                                                                      <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                    </button>
                                                                                  </div>

                                                                                  <div className="selectprice">
                                                                                    {(() => {
                                                                                      const totalPrice = priceParseData['air:AirPricingInfo'].$.TotalPrice;
                                                                                      const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                      const airline = inputOrigin;
                                                                                      const calculatedPrice = calculateFinalPrice(
                                                                                        numericTotalPrice,
                                                                                        markupdata,
                                                                                        cabinClass,
                                                                                        priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                        , airline, flight_type
                                                                                      );

                                                                                      return (
                                                                                        <>
                                                                                          {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                          {calculatedPrice}
                                                                                        </>
                                                                                      );
                                                                                    })()}
                                                                                  </div>

                                                                                  {visibleDetails && visibleDetailsByName === priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name'] && (() => {
                                                                                    const validDetails = priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['air:Text'].filter(
                                                                                      (textinfor) => textinfor['$']?.Type === "MarketingConsumer"
                                                                                    );

                                                                                    const closeButton = (
                                                                                      <button className="selectdetail-close" style={{ marginTop: "-3%", marginRight: "-3%" }} onClick={() => setVisibleDetails(false)} >
                                                                                        &times;
                                                                                      </button>
                                                                                    );

                                                                                    return validDetails.length > 0 ? (
                                                                                      validDetails.map((textinfor, textindex) => {
                                                                                        const infoArray = textinfor['_']
                                                                                          .split('\n')
                                                                                          .filter((item) => item.trim() !== '');

                                                                                        return (
                                                                                          <div key={textindex}>
                                                                                            <div className="popup-overlay" onClick={() => setVisibleDetails(false)}></div>
                                                                                            <div className="selectdetail">
                                                                                              {closeButton}
                                                                                              <ul>
                                                                                                {infoArray.map((item, index) => (
                                                                                                  <li key={index}>{item.trim()}</li>
                                                                                                ))}
                                                                                              </ul>
                                                                                            </div>
                                                                                          </div>
                                                                                        );
                                                                                      })
                                                                                    ) : (
                                                                                      <div>
                                                                                        <div className="popup-overlay" onClick={() => setVisibleDetails(false)}></div>
                                                                                        <div className="selectdetail">
                                                                                          {closeButton}
                                                                                          <p>No details are available at present. Please check back later.</p>
                                                                                        </div>
                                                                                      </div>
                                                                                    );
                                                                                  })()}
                                                                                </div>
                                                                              ) : (
                                                                                <>
                                                                                  <div>
                                                                                    <div className="seelctheader">{priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name']}
                                                                                      <button
                                                                                        type="button"
                                                                                        onClick={() => toggleDetails(priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name'])}

                                                                                        style={{
                                                                                          border: "none",
                                                                                          background: "none",
                                                                                          cursor: "pointer",
                                                                                          fontSize: "16px",
                                                                                          color: "#785eff",
                                                                                        }}
                                                                                        aria-label="Toggle Details"
                                                                                      >
                                                                                        <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                      </button></div>
                                                                                    <div className="selectprice">
                                                                                      {(() => {
                                                                                        const totalPrice = priceParseData['air:AirPricingInfo'].$.TotalPrice;
                                                                                        const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                        const airline = inputOrigin;
                                                                                        const calculatedPrice = calculateFinalPrice(
                                                                                          numericTotalPrice,
                                                                                          markupdata,
                                                                                          cabinClass,
                                                                                          priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                          , airline, flight_type
                                                                                        );

                                                                                        return (
                                                                                          <>
                                                                                            {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                            {calculatedPrice}
                                                                                          </>
                                                                                        );
                                                                                      })()}
                                                                                    </div>
                                                                                    {visibleDetails && visibleDetailsByName === priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name'] && (
                                                                                      <>
                                                                                        <div className="popup-overlay" onClick={() => setVisibleDetails(false)}></div>
                                                                                        <div className="selectdetail">
                                                                                          <button className="selectdetail-close" style={{ marginTop: "-3.5%", marginRight: "-3.5%" }} onClick={() => setVisibleDetails(false)}>&times;</button>
                                                                                          <ul><li>
                                                                                            {priceParseData['air:AirPricingInfo'] && priceParseData['air:AirPricingInfo']['air:FareInfo'] &&
                                                                                              priceParseData['air:AirPricingInfo']['air:FareInfo']['common_v52_0:Endorsement'] &&
                                                                                              priceParseData['air:AirPricingInfo']['air:FareInfo']['common_v52_0:Endorsement']['$'] &&
                                                                                              priceParseData['air:AirPricingInfo']['air:FareInfo']['common_v52_0:Endorsement']['$']['Value']}
                                                                                          </li></ul>
                                                                                        </div>
                                                                                      </>
                                                                                    )}
                                                                                  </div>
                                                                                </>
                                                                              )
                                                                          ) : (
                                                                            <>
                                                                              <div>
                                                                                <div className="seelctheader">{priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name']}
                                                                                  <button
                                                                                    type="button"
                                                                                    onClick={() => toggleDetails(priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name'])}

                                                                                    style={{
                                                                                      border: "none",
                                                                                      background: "none",
                                                                                      cursor: "pointer",
                                                                                      fontSize: "16px",
                                                                                      color: "#785eff",
                                                                                    }}
                                                                                    aria-label="Toggle Details"
                                                                                  >
                                                                                    <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                  </button></div>
                                                                                <div className="selectprice">
                                                                                  {(() => {
                                                                                    const totalPrice = priceParseData['air:AirPricingInfo'].$.TotalPrice;
                                                                                    const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                    const airline = inputOrigin;
                                                                                    const calculatedPrice = calculateFinalPrice(
                                                                                      numericTotalPrice,
                                                                                      markupdata,
                                                                                      cabinClass,
                                                                                      priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                      , airline, flight_type
                                                                                    );

                                                                                    return (
                                                                                      <>
                                                                                        {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                        {calculatedPrice}
                                                                                      </>
                                                                                    );
                                                                                  })()}
                                                                                </div>
                                                                                {visibleDetails && visibleDetailsByName === priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name'] && (
                                                                                  <>
                                                                                    <div className="popup-overlay" onClick={() => setVisibleDetails(false)}></div>
                                                                                    <div className="selectdetail">
                                                                                      <button className="selectdetail-close" style={{ marginTop: "-3.5%", marginRight: "-3.5%" }} onClick={() => setVisibleDetails(false)}>&times;</button>
                                                                                      <ul><li>
                                                                                        {priceParseData['air:AirPricingInfo'] && priceParseData['air:AirPricingInfo']['air:FareInfo'] &&
                                                                                          priceParseData['air:AirPricingInfo']['air:FareInfo']['common_v52_0:Endorsement'] &&
                                                                                          priceParseData['air:AirPricingInfo']['air:FareInfo']['common_v52_0:Endorsement']['$'] &&
                                                                                          priceParseData['air:AirPricingInfo']['air:FareInfo']['common_v52_0:Endorsement']['$']['Value']}
                                                                                      </li></ul>
                                                                                    </div>
                                                                                  </>
                                                                                )}
                                                                              </div>
                                                                            </>
                                                                          )
                                                                        )

                                                                    )
                                                                  )
                                                              )}
                                                            </div>
                                                            {/* {agent_id && ( */}
                                                              <div className='buttonbook'><button type='button' className="continuebutton" style={{ marginTop: "11px", color: "white", backgroundColor: "#785eff", border: "none", padding: "3%", borderRadius: "3px" }} onClick={() => handleselectedContinue(priceParseindex)}>Book Now</button></div>
                                                            {/* )} */}
                                                          </div>
                                                        )
                                                        ))}
                                                    </div>

                                                  )}

                                                </div>
                                                <div className="flt-i-c">
                                                  <div className="flt-i-padding">
                                                    <div className="flt-i-price-i">
                                                      <div className="flt-i-price">
                                                        {pricepoint['air:AirPricingInfo'] && (
                                                          Array.isArray(pricepoint['air:AirPricingInfo']) ? (
                                                            <>
                                                              {(() => {
                                                                const totalPrice =
                                                                  pricepoint['air:AirPricingInfo'][0]['$']['TotalPrice'];
                                                                const seatType = cabinClass; // Set the seat type dynamically as needed
                                                                const fareName = "Base Fare";
                                                                const airline = inputOrigin;
                                                                const finalPrice = calculateFinalPrice(totalPrice, markupdata, seatType, fareName, airline, flight_type);

                                                                return (
                                                                  <>
                                                                    {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                    {Math.floor(finalPrice)} {/* Show final price with markup applied */}
                                                                  </>
                                                                );
                                                              })()}
                                                            </>
                                                          ) : (
                                                            <>
                                                              {(() => {
                                                                const totalPrice =
                                                                  pricepoint['air:AirPricingInfo']['$']['TotalPrice'];
                                                                const seatType = cabinClass; // Set the seat type dynamically as needed
                                                                const fareName = "Base Fare";
                                                                const airline = inputOrigin;
                                                                const finalPrice = calculateFinalPrice(totalPrice, markupdata, seatType, fareName, airline, flight_type);


                                                                return (
                                                                  <>
                                                                    {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                    {Math.floor(finalPrice)} {/* Show final price with markup applied */}
                                                                  </>
                                                                );
                                                              })()}
                                                            </>
                                                          )
                                                        )}

                                                      </div>
                                                    </div>
                                                    {/* <div className="flt-i-price-b">per adult</div>
                                                        <button type="submit" 
                                                                className="srch-btn" variant="primary">
                                                            <span style={{ fontSize: "12px" }}>View Prices</span>
                                                          </button> */}
                                                    <div className="flt-i-c">
                                                      <div className="flt-i-padding">

                                                        <button type="submit"
                                                          className="srch-btn" variant="primary" style={{ borderRadius: '18px' }}>
                                                          <span style={{ fontSize: "12px" }}>View Prices</span>
                                                        </button>
                                                        <div className="flight-line-b">
                                                          <b onClick={() => handleFlightDetails(priceindex)}>
                                                            {visibleFlightIndex === priceindex ? "Hide Flight Details" : "Show Flight Details"}
                                                          </b>
                                                        </div>
                                                        {visibleFlightIndex === priceindex && (
                                                          <div className="flight-details">
                                                            {/* Render your flight details here */}
                                                          </div>
                                                        )}
                                                        <div className="clear" />

                                                      </div>
                                                    </div>


                                                  </div>
                                                </div>
                                                <div className="clear" />
                                              </div>
                                            </div>
                                          ) : (

                                            <div >

                                              <div
                                                // className={`flight-item fly-in ${selectedFlights.includes(pricepoint['air:AirPricingInfo']) ? "selected-flight" : ""}`}
                                                className={`flight-item fly-in ${selectedFlights.some(
                                                  (selectedFlight) =>
                                                    selectedFlight["$"].Key === pricepoint["air:AirPricingInfo"]["$"].Key &&
                                                    selectedFlight.isReturn === pricepoint["air:AirPricingInfo"].isReturn
                                                )
                                                  ? "selected-flight"
                                                  : ""
                                                  }`}
                                                data-price={6521}
                                                data-departure={1}
                                                data-duration={1}
                                                data-category="myCheckAI checkclassEconomy"
                                                id="textAI"
                                                data-category1="stop0"
                                                style={{ display: "block" }}
                                              >

                                                <div className="flt-i-a">
                                                  <div className="flt-i-b">
                                                    <div className="flt-i-bb">
                                                      <div className="flt-l-a">
                                                        <div className="flt-l-b">
                                                          <div className="way-lbl">departure</div>
                                                          <div className="company">
                                                            {pricepoint['air:AirPricingInfo'] && (
                                                              Array.isArray(pricepoint['air:AirPricingInfo'])
                                                                ? (
                                                                  <div style={{ width: '95%' }}>
                                                                    {
                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'] &&
                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'] && (
                                                                        Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'])
                                                                          ? (
                                                                            <div>
                                                                              {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'] &&
                                                                                Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'])
                                                                                ? (
                                                                                  <div>
                                                                                    {(() => {
                                                                                      const uniqueCarriers9 = new Set();
                                                                                      return (
                                                                                        pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                          <div key={bookingindex} >
                                                                                            {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                              if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                uniqueCarriers9.add(segmentinfo['$']['Carrier']);
                                                                                              }
                                                                                            })}
                                                                                          </div>
                                                                                        )),
                                                                                        Array.from(uniqueCarriers9).map((carrier, index) => (
                                                                                          <div key={index} style={{ marginLeft: '10%', marginRight: '5%' }}>
                                                                                            <div className="airline-container">
                                                                                              <img
                                                                                                className={`airlineimg${index}`}
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${carrier}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              />
                                                                                              <span className="flightnumber">{handleAirline(carrier)}</span>
                                                                                            </div><br />
                                                                                            <div>
                                                                                              {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                                <div key={bookingindex}>
                                                                                                  {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef'] && segmentinfo['$']['Carrier'] === carrier) {
                                                                                                      return (
                                                                                                        <span key={segmentindex} className='flightnumber'>
                                                                                                          {bookingindex > 0 && ', '}
                                                                                                          {segmentinfo['$']['Carrier']} {segmentinfo['$']['FlightNumber']}
                                                                                                        </span>
                                                                                                      );
                                                                                                    }
                                                                                                  })}
                                                                                                </div>
                                                                                              ))}
                                                                                            </div>
                                                                                          </div>
                                                                                        ))
                                                                                      );
                                                                                    })()}
                                                                                  </div>
                                                                                ) : (
                                                                                  <div>
                                                                                    {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                      SegmentList.map((segmentinfo, segmentindex) => {

                                                                                        if (
                                                                                          segmentinfo['$'] &&
                                                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                        ) {

                                                                                          return (
                                                                                            <div key={segmentindex} style={{ marginLeft: '10%', marginRight: '5%' }}>
                                                                                              <img
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${segmentinfo['$']['Carrier']}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"

                                                                                              />
                                                                                              <span className='flightnumber1'>
                                                                                                {handleAirline(segmentinfo['$']['Carrier'])}<br />
                                                                                                {segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']}

                                                                                              </span>
                                                                                            </div>
                                                                                          );
                                                                                        }
                                                                                      })
                                                                                    }
                                                                                  </div>
                                                                                )
                                                                              }

                                                                            </div>
                                                                          ) : (
                                                                            <div>
                                                                              {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'] &&
                                                                                Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'])
                                                                                ? (
                                                                                  <div>
                                                                                    {(() => {
                                                                                      const uniqueCarriers10 = new Set();
                                                                                      return (
                                                                                        pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                          <div key={bookingindex}>
                                                                                            {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                              if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                uniqueCarriers10.add(segmentinfo['$']['Carrier']);

                                                                                              }
                                                                                            })}
                                                                                          </div>
                                                                                        )),
                                                                                        Array.from(uniqueCarriers10).map((carrier, index) => (
                                                                                          <div key={index} style={{ marginLeft: '5%', marginRight: '5%' }}>
                                                                                            <div className="airline-container">
                                                                                              <img
                                                                                                className={`airlineimg${index}`}
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${carrier}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              />
                                                                                              <span className="flightnumber">{handleAirline(carrier)}</span>
                                                                                            </div><br />
                                                                                            <div>
                                                                                              {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                                <div key={bookingindex}>
                                                                                                  {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef'] && segmentinfo['$']['Carrier'] === carrier) {
                                                                                                      return (
                                                                                                        <span key={segmentindex} className='flightnumber'>
                                                                                                          {bookingindex > 0 && ', '}
                                                                                                          {segmentinfo['$']['Carrier']} {segmentinfo['$']['FlightNumber']}
                                                                                                        </span>
                                                                                                      );
                                                                                                    }
                                                                                                  })}
                                                                                                </div>
                                                                                              ))}
                                                                                            </div>

                                                                                          </div>
                                                                                        ))
                                                                                      );
                                                                                    })()}
                                                                                  </div>
                                                                                ) : (
                                                                                  <div>
                                                                                    {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                      SegmentList.map((segmentinfo, segmentindex) => {

                                                                                        if (
                                                                                          segmentinfo['$'] &&
                                                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                        ) {

                                                                                          return (
                                                                                            <div key={segmentindex} style={{ marginLeft: '5%', marginRight: '5%' }}>
                                                                                              <img
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${segmentinfo['$']['Carrier']}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"

                                                                                              />
                                                                                              <span className='flightnumber1'>
                                                                                                {handleAirline(segmentinfo['$']['Carrier'])}<br />
                                                                                                {segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']}
                                                                                              </span>
                                                                                            </div>
                                                                                          );

                                                                                        }


                                                                                      })
                                                                                    }
                                                                                  </div>
                                                                                )
                                                                              }
                                                                            </div>
                                                                          )
                                                                      )
                                                                    }

                                                                  </div>
                                                                ) : (
                                                                  <div style={{ width: '95%' }}>
                                                                    {
                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'] &&
                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'] && (
                                                                        Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'])
                                                                          ? (
                                                                            <div>
                                                                              {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'] &&
                                                                                Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'])
                                                                                ? (
                                                                                  <div>
                                                                                    {(() => {
                                                                                      const uniqueCarriers11 = new Set();
                                                                                      return (
                                                                                        pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                          <div key={bookingindex} >
                                                                                            {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                              if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                uniqueCarriers11.add(segmentinfo['$']['Carrier']);

                                                                                              }
                                                                                            })}

                                                                                          </div>
                                                                                        )),
                                                                                        Array.from(uniqueCarriers11).map((carrier, index) => (
                                                                                          <div key={index} style={{ marginLeft: '5%', marginRight: '5%' }}>
                                                                                            <div className="airline-container">
                                                                                              <img
                                                                                                className={`airlineimg${index}`}
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${carrier}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"
                                                                                              />
                                                                                              <span className="flightnumber">{handleAirline(carrier)}</span>
                                                                                            </div><br />
                                                                                            <div>
                                                                                              {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                                <div key={bookingindex}>
                                                                                                  {bookingInfo['$'] && SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef'] && segmentinfo['$']['Carrier'] === carrier) {
                                                                                                      return (
                                                                                                        <span key={segmentindex} className='flightnumber'>
                                                                                                          {bookingindex > 0 && ', '}
                                                                                                          {segmentinfo['$']['Carrier']} {segmentinfo['$']['FlightNumber']}
                                                                                                        </span>
                                                                                                      );
                                                                                                    }
                                                                                                  })}
                                                                                                </div>
                                                                                              ))}
                                                                                            </div>

                                                                                          </div>
                                                                                        ))
                                                                                      );
                                                                                    })()}
                                                                                  </div>
                                                                                ) : (
                                                                                  <div>
                                                                                    {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                      SegmentList.map((segmentinfo, segmentindex) => {

                                                                                        if (
                                                                                          segmentinfo['$'] &&
                                                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                        ) {

                                                                                          return (
                                                                                            <div key={segmentindex} style={{ marginLeft: '5%', marginRight: '5%' }}>
                                                                                              <img
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${segmentinfo['$']['Carrier']}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"

                                                                                              />
                                                                                              <span className='flightnumber1'>
                                                                                                {handleAirline(segmentinfo['$']['Carrier'])}<br />
                                                                                                {segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']}
                                                                                              </span>
                                                                                            </div>
                                                                                          );
                                                                                        }
                                                                                      })
                                                                                    }
                                                                                  </div>
                                                                                )
                                                                              }
                                                                            </div>
                                                                          ) : (
                                                                            <div>
                                                                              {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'] &&
                                                                                Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'])
                                                                                ? (
                                                                                  <div>
                                                                                    {(() => {
                                                                                      const uniqueCarriers12 = new Set();

                                                                                      // Collect all unique carriers from SegmentList
                                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].forEach(
                                                                                        (bookingInfo) => {
                                                                                          if (bookingInfo['$']) {
                                                                                            SegmentList.forEach((segmentinfo) => {
                                                                                              if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                uniqueCarriers12.add(segmentinfo['$']['Carrier']);
                                                                                              }
                                                                                            });
                                                                                          }
                                                                                        }
                                                                                      );

                                                                                      return Array.from(uniqueCarriers12).map((carrier, index) => (
                                                                                        <div key={index} style={{ marginLeft: '5%', marginRight: '5%' }}>
                                                                                          {/* Airline Logo */}
                                                                                          <div className="airline-container">
                                                                                            <img
                                                                                              className={`airlineimg${index}`}
                                                                                              src={`https://devapi.taxivaxi.com/airline_logo_images/${carrier}.png`}
                                                                                              alt="Airline logo"
                                                                                              width="40px"
                                                                                            />
                                                                                            <span className="flightnumber">{handleAirline(carrier)}</span>
                                                                                          </div>
                                                                                          <br />

                                                                                          {/* Flight Numbers */}
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].map(
                                                                                              (bookingInfo, bookingindex) => (
                                                                                                <div key={bookingindex}>
                                                                                                  {bookingInfo['$'] &&
                                                                                                    SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                      if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef'] && segmentinfo['$']['Carrier'] === carrier) {
                                                                                                        return (
                                                                                                          <span key={segmentindex} className="flightnumber">
                                                                                                            {bookingindex > 0 && ', '}
                                                                                                            {segmentinfo['$']['Carrier']} {segmentinfo['$']['FlightNumber']}
                                                                                                          </span>
                                                                                                        );
                                                                                                      }
                                                                                                    })}
                                                                                                </div>
                                                                                              )
                                                                                            )}
                                                                                          </div>
                                                                                        </div>
                                                                                      ));
                                                                                    })()}
                                                                                  </div>

                                                                                ) : (
                                                                                  <div>
                                                                                    {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                      SegmentList.map((segmentinfo, segmentindex) => {

                                                                                        if (
                                                                                          segmentinfo['$'] &&
                                                                                          segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                        ) {

                                                                                          return (
                                                                                            <div key={segmentindex} style={{ marginLeft: '5%', marginRight: '5%' }}>
                                                                                              <img
                                                                                                src={`https://devapi.taxivaxi.com/airline_logo_images/${segmentinfo['$']['Carrier']}.png`}
                                                                                                alt="Airline logo"
                                                                                                width="40px"

                                                                                              />
                                                                                              <span className='flightnumber1'>
                                                                                                {handleAirline(segmentinfo['$']['Carrier'])}<br />
                                                                                                {segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']}
                                                                                              </span>
                                                                                            </div>
                                                                                          );
                                                                                        }
                                                                                      })
                                                                                    }
                                                                                  </div>
                                                                                )
                                                                              }
                                                                            </div>
                                                                          )
                                                                      )
                                                                    }
                                                                  </div>
                                                                )
                                                            )
                                                            }



                                                          </div>
                                                        </div>

                                                        <div className="flt-l-c">
                                                          <div className="flt-l-cb">
                                                            <div className="flt-l-c-padding">
                                                              <div className="flyght-info-head">
                                                                <input type="hidden" name="SearchPriceTotalPrice" value={pricepoint['$']['TotalPrice']} />
                                                                {pricepoint['air:AirPricingInfo'] && (
                                                                  Array.isArray(pricepoint['air:AirPricingInfo'])
                                                                    ? (
                                                                      <div>
                                                                        {
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'] &&
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'] && (
                                                                            Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'])
                                                                              ? (
                                                                                <div>
                                                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'])
                                                                                    ? (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['0'] &&


                                                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['0']['$']['SegmentRef']
                                                                                            ) {
                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  <FlightInfoDepartureDate DepartureDate={handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])} onFlightDepartureDateChange={handleFlightDepartureDateChange} />
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })

                                                                                        }


                                                                                      </div>
                                                                                    ) : (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  <FlightInfoDepartureDate DepartureDate={handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])} onFlightDepartureDateChange={handleFlightDepartureDateChange} />
                                                                                                </div>
                                                                                              );
                                                                                            }


                                                                                          })
                                                                                        }


                                                                                      </div>
                                                                                    )
                                                                                  }
                                                                                </div>
                                                                              ) : (
                                                                                <div>
                                                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'])
                                                                                    ? (
                                                                                      <div>


                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['0'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['0']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  <FlightInfoDepartureDate DepartureDate={handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])} onFlightDepartureDateChange={handleFlightDepartureDateChange} />
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }
                                                                                      </div>
                                                                                    ) : (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  <FlightInfoDepartureDate DepartureDate={handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])} onFlightDepartureDateChange={handleFlightDepartureDateChange} />
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }
                                                                                      </div>
                                                                                    )
                                                                                  }
                                                                                </div>
                                                                              )
                                                                          )
                                                                        }
                                                                      </div>
                                                                    ) : (
                                                                      <div>
                                                                        {
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'] &&
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'] && (
                                                                            Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'])
                                                                              ? (
                                                                                <div>
                                                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'])
                                                                                    ? (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['0'] &&


                                                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['0']['$']['SegmentRef']
                                                                                            ) {
                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  <FlightInfoDepartureDate DepartureDate={handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])} onFlightDepartureDateChange={handleFlightDepartureDateChange} />
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }
                                                                                      </div>
                                                                                    ) : (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  <FlightInfoDepartureDate DepartureDate={handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])} onFlightDepartureDateChange={handleFlightDepartureDateChange} />
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }
                                                                                      </div>
                                                                                    )
                                                                                  }
                                                                                </div>
                                                                              ) : (
                                                                                <div>
                                                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'])
                                                                                    ? (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['0'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {
                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['0']['$']['SegmentRef']
                                                                                            ) {
                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  <FlightInfoDepartureDate DepartureDate={handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])} onFlightDepartureDateChange={handleFlightDepartureDateChange} />
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }
                                                                                      </div>
                                                                                    ) : (
                                                                                      <div>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <div key={segmentindex}>
                                                                                                  {segmentinfo['$'] &&
                                                                                                    handleAirline(segmentinfo['$']['Carrier'])
                                                                                                  } &nbsp;
                                                                                                  <FlightInfoDepartureDate DepartureDate={handleflyghtHeadInfoDate(segmentinfo['$']['DepartureTime'])} onFlightDepartureDateChange={handleFlightDepartureDateChange} />
                                                                                                </div>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }
                                                                                      </div>
                                                                                    )
                                                                                  }
                                                                                </div>
                                                                              )
                                                                          )
                                                                        }

                                                                      </div>

                                                                    )
                                                                )
                                                                }


                                                              </div>
                                                              {/* // */}
                                                              <div className="flight-line">
                                                                {pricepoint['air:AirPricingInfo'] && (
                                                                  Array.isArray(pricepoint['air:AirPricingInfo'])
                                                                    ? (
                                                                      <>
                                                                        {
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'] &&
                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'] && (
                                                                            Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'])
                                                                              ? (
                                                                                <>
                                                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'])
                                                                                    ? (
                                                                                      <>
                                                                                        <span className="lineflightss">
                                                                                          <div className="flight-line-a"
                                                                                            style={{ width: 58 }}>

                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === 0 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                <FlightInfoOrigin
                                                                                                                  origin={handleAirport(segmentinfo['$']['Origin'])}
                                                                                                                  onFlightOriginChange={handleFlightOriginChange}

                                                                                                                /><br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>
                                                                                            ))}
                                                                                          </div>
                                                                                          <span className="lineflights">
                                                                                            <div className="flight-line-d1"></div>
                                                                                            <div
                                                                                              className="flight-line-a" style={{ textAlign: 'center', marginTop: '7%', width: '100px' }}>
                                                                                              <span >
                                                                                                {calculateTravellingTime(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['$']['TravelTime'])}
                                                                                              </span>
                                                                                              <span className="stop-badge-container">
                                                                                                <div className="flight-line-a">
                                                                                                  {(() => {
                                                                                                    let totalIterations = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].length - 1;
                                                                                                    let stopoverCity = "";
                                                                                                    let flightTimeInMinutes = 0;
                                                                                                    if (totalIterations > 0) {
                                                                                                      pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].forEach((bookingInfo) => {
                                                                                                        SegmentList.map((segmentinfo) => {
                                                                                                          if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                            flightTimeInMinutes = flightTimeInMinutes + parseInt(segmentinfo['$']['FlightTime']);
                                                                                                            stopoverCity = handleAirport(segmentinfo['$']['Origin']);
                                                                                                          }
                                                                                                        });
                                                                                                      });
                                                                                                    }
                                                                                                    return (
                                                                                                      <p className="stop-badge" >
                                                                                                        {totalIterations} stop via {stopoverCity}
                                                                                                        <div className="tooltip-content">
                                                                                                          <p style={{ marginBottom: '0px' }}>Plane Change</p>
                                                                                                          {stopoverCity} | {convertMinutesToHours(pricepoint['travelTime'] - flightTimeInMinutes)} Layover
                                                                                                        </div>
                                                                                                      </p>
                                                                                                    );
                                                                                                  })()}
                                                                                                </div>
                                                                                              </span>
                                                                                            </div>

                                                                                            <div className="flight-line-d2"></div>
                                                                                          </span>
                                                                                          <div className="flight-line-a" style={{ width: 62 }}>

                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].length - 1 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                <FlightInfoDestination Destination={handleAirport(segmentinfo['$']['Destination'])} onFlightDestinationChange={handleFlightDestinationChange} /><br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>

                                                                                            ))}
                                                                                          </div>
                                                                                        </span>
                                                                                      </>
                                                                                    ) : (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <span key={segmentindex}>
                                                                                                  <span className="lineflightss">
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 58 }} >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        <FlightInfoOrigin origin={handleAirport(segmentinfo['$']['Origin'])} onFlightOriginChange={handleFlightOriginChange} /><br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                      </span>
                                                                                                    </div>
                                                                                                    <span className="lineflights">
                                                                                                      <div className="flight-line-d1"></div>
                                                                                                      <div className="flight-line-a" style={{ textAlign: 'center', marginTop: '7%', width: '100px' }} >
                                                                                                        <span style={{ marginLeft: '5px', marginRight: '5px' }} >
                                                                                                          {calculateTravellingTime(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['$']['TravelTime'])}
                                                                                                        </span>
                                                                                                        <span className="stop-badge-container">
                                                                                                          <p className="stop-badge">
                                                                                                            Non-Stop
                                                                                                            <div className="tooltip-content">
                                                                                                              This is a direct flight with no stops.
                                                                                                            </div>
                                                                                                          </p>
                                                                                                        </span>
                                                                                                      </div>

                                                                                                      <div className="flight-line-d2"></div>
                                                                                                    </span>
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 62 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}
                                                                                                        <sup></sup>

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        <FlightInfoDestination Destination={handleAirport(segmentinfo['$']['Destination'])} onFlightDestinationChange={handleFlightDestinationChange} /><br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span></span>
                                                                                                    </div>
                                                                                                  </span>
                                                                                                </span>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }
                                                                                      </>
                                                                                    )
                                                                                  }
                                                                                </>
                                                                              ) : (
                                                                                <>
                                                                                  {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'])
                                                                                    ? (
                                                                                      <>
                                                                                        <span className="lineflightss">
                                                                                          <div className="flight-line-a"
                                                                                            style={{ width: 58 }}>

                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === 0 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                <FlightInfoOrigin origin={handleAirport(segmentinfo['$']['Origin'])} onFlightOriginChange={handleFlightOriginChange} /><br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>

                                                                                            ))}


                                                                                          </div>
                                                                                          <span className="lineflights">
                                                                                            <div className="flight-line-d1"></div>
                                                                                            <div
                                                                                              className="flight-line-a"

                                                                                              style={{ textAlign: 'center', marginTop: '7%', width: '100px' }}
                                                                                            >
                                                                                              <span >
                                                                                                {calculateTravellingTime(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['$']['TravelTime'])}
                                                                                              </span>
                                                                                              <span className="stop-badge-container">
                                                                                                <div className="flight-line-a">
                                                                                                  {(() => {
                                                                                                    let totalIterations = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].length - 1;
                                                                                                    let stopoverCity = "";
                                                                                                    let flightTimeInMinutes = 0;
                                                                                                    if (totalIterations > 0) {
                                                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].forEach((bookingInfo) => {
                                                                                                        SegmentList.map((segmentinfo) => {
                                                                                                          if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                            flightTimeInMinutes = flightTimeInMinutes + parseInt(segmentinfo['$']['FlightTime']);
                                                                                                            stopoverCity = handleAirport(segmentinfo['$']['Origin']);
                                                                                                          }
                                                                                                        });
                                                                                                      });
                                                                                                    }
                                                                                                    return (
                                                                                                      <p className="stop-badge" >
                                                                                                        {totalIterations} stop via {stopoverCity}
                                                                                                        <div className="tooltip-content">
                                                                                                          <p style={{ marginBottom: '0px' }}>Plane Change</p>
                                                                                                          {stopoverCity} | {convertMinutesToHours(pricepoint['travelTime'] - flightTimeInMinutes)} Layover
                                                                                                        </div>
                                                                                                      </p>
                                                                                                    );
                                                                                                  })()}
                                                                                                </div>
                                                                                              </span>
                                                                                            </div>

                                                                                            <div className="flight-line-d2"></div>
                                                                                          </span>
                                                                                          <div className="flight-line-a" style={{ width: 62 }}>

                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].length - 1 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                <FlightInfoDestination Destination={handleAirport(segmentinfo['$']['Destination'])} onFlightDestinationChange={handleFlightDestinationChange} /><br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                              
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>

                                                                                            ))}


                                                                                          </div>
                                                                                        </span>

                                                                                      </>
                                                                                    ) : (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <span key={segmentindex}>
                                                                                                  <span className="lineflightss">
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 58 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        <FlightInfoOrigin origin={handleAirport(segmentinfo['$']['Origin'])} onFlightOriginChange={handleFlightOriginChange} /><br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                      </span>
                                                                                                    </div>
                                                                                                    <span className="lineflights">
                                                                                                      <div className="flight-line-d1"></div>
                                                                                                      <div
                                                                                                        className="flight-line-a"

                                                                                                        style={{ textAlign: 'center', marginTop: '7%', width: '100px' }}
                                                                                                      >
                                                                                                        <span style={{ marginLeft: '5px', marginRight: '5px' }} >
                                                                                                          {calculateTravellingTime(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['$']['TravelTime'])}
                                                                                                        </span>
                                                                                                        <span className="stop-badge-container">
                                                                                                          <p className="stop-badge">
                                                                                                            Non-Stop
                                                                                                            <div className="tooltip-content">
                                                                                                              This is a direct flight with no stops.
                                                                                                            </div>
                                                                                                          </p>
                                                                                                        </span>
                                                                                                      </div>

                                                                                                      <div className="flight-line-d2"></div>
                                                                                                    </span>
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 62 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}
                                                                                                        <sup></sup>

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        <FlightInfoDestination Destination={handleAirport(segmentinfo['$']['Destination'])} onFlightDestinationChange={handleFlightDestinationChange} /><br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span></span>
                                                                                                    </div>
                                                                                                  </span>
                                                                                                </span>
                                                                                              );
                                                                                            }
                                                                                          })
                                                                                        }
                                                                                      </>
                                                                                    )
                                                                                  }
                                                                                </>
                                                                              )
                                                                          )
                                                                        }

                                                                      </>
                                                                    ) : (
                                                                      <>
                                                                        {
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'] &&
                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'] && (
                                                                            Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'])
                                                                              ? (
                                                                                <>
                                                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'])
                                                                                    ? (
                                                                                      <>
                                                                                        <span className="lineflightss">
                                                                                          <div className="flight-line-a"
                                                                                            style={{ width: 58 }}>

                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === 0 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                <FlightInfoOrigin origin={handleAirport(segmentinfo['$']['Origin'])} onFlightOriginChange={handleFlightOriginChange} /><br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>

                                                                                            ))}

                                                                                          </div>
                                                                                          <span className="lineflights">
                                                                                            <div className="flight-line-d1"></div>
                                                                                            <div
                                                                                              className="flight-line-a"
                                                                                              style={{ textAlign: 'center', marginTop: '7%', width: '100px' }}
                                                                                            >
                                                                                              <span >
                                                                                                {calculateTravellingTime(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['$']['TravelTime'])}
                                                                                              </span>
                                                                                              <span className="stop-badge-container">
                                                                                                <div className="flight-line-a">
                                                                                                  {(() => {
                                                                                                    let totalIterations = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].length - 1;
                                                                                                    let stopoverCity = "";
                                                                                                    let flightTimeInMinutes = 0;
                                                                                                    if (totalIterations > 0) {
                                                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].forEach((bookingInfo) => {
                                                                                                        SegmentList.map((segmentinfo) => {
                                                                                                          if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                            flightTimeInMinutes = flightTimeInMinutes + parseInt(segmentinfo['$']['FlightTime']);
                                                                                                            stopoverCity = handleAirport(segmentinfo['$']['Origin']);
                                                                                                          }
                                                                                                        });
                                                                                                      });
                                                                                                    }
                                                                                                    return (

                                                                                                      <p className="stop-badge" >
                                                                                                        {totalIterations} stop via {stopoverCity}
                                                                                                        <div className="tooltip-content">
                                                                                                          <p style={{ marginBottom: '0px' }}>Plane Change</p>
                                                                                                          {stopoverCity} | {convertMinutesToHours(pricepoint['travelTime'] - flightTimeInMinutes)} Layover
                                                                                                        </div>
                                                                                                      </p>
                                                                                                    );
                                                                                                  })()}
                                                                                                </div>
                                                                                              </span>
                                                                                            </div>

                                                                                            <div className="flight-line-d2"></div>
                                                                                          </span>
                                                                                          <div className="flight-line-a" style={{ width: 62 }}>

                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].length - 1 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                <FlightInfoDestination Destination={handleAirport(segmentinfo['$']['Destination'])} onFlightDestinationChange={handleFlightDestinationChange} /><br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                                
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>

                                                                                            ))}


                                                                                          </div>
                                                                                        </span>

                                                                                      </>
                                                                                    ) : (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <span key={segmentindex}>
                                                                                                  <span className="lineflightss">
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 58 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        <FlightInfoOrigin origin={handleAirport(segmentinfo['$']['Origin'])} onFlightOriginChange={handleFlightOriginChange} /><br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                      </span>
                                                                                                    </div>
                                                                                                    <span className="lineflights">
                                                                                                      <div className="flight-line-d1"></div>
                                                                                                      <div
                                                                                                        className="flight-line-a"

                                                                                                        style={{ textAlign: 'center', marginTop: '7%', width: '100px' }}
                                                                                                      >
                                                                                                        <span style={{ marginLeft: '5px', marginRight: '5px' }} >
                                                                                                          {calculateTravellingTime(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['$']['TravelTime'])}
                                                                                                        </span>
                                                                                                        <span className="stop-badge-container">
                                                                                                          <p className="stop-badge">
                                                                                                            Non-Stop
                                                                                                            <div className="tooltip-content">
                                                                                                              This is a direct flight with no stops.
                                                                                                            </div>
                                                                                                          </p>
                                                                                                        </span>
                                                                                                      </div>

                                                                                                      <div className="flight-line-d2"></div>
                                                                                                    </span>
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 62 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}
                                                                                                        <sup></sup>

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        <FlightInfoDestination Destination={handleAirport(segmentinfo['$']['Destination'])} onFlightDestinationChange={handleFlightDestinationChange} /><br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                        </span>
                                                                                                        </span>
                                                                                                    </div>
                                                                                                  </span>


                                                                                                </span>
                                                                                              );
                                                                                            }


                                                                                          })
                                                                                        }


                                                                                      </>
                                                                                    )
                                                                                  }
                                                                                </>
                                                                              ) : (
                                                                                <>
                                                                                  {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'] &&
                                                                                    Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'])
                                                                                    ? (
                                                                                      <>
                                                                                        <span className="lineflightss">
                                                                                          <div className="flight-line-a"
                                                                                            style={{ width: 58 }}>

                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === 0 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                <FlightInfoOrigin origin={handleAirport(segmentinfo['$']['Origin'])} onFlightOriginChange={handleFlightOriginChange} /><br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>

                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>
                                                                                            ))}
                                                                                          </div>
                                                                                          <span className="lineflights">
                                                                                            <div className="flight-line-d1"></div>
                                                                                            <div
                                                                                              className="flight-line-a" style={{ textAlign: 'center', marginTop: '7%', width: '100px' }}
                                                                                            >
                                                                                              <span >
                                                                                                {calculateTravellingTime(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['$']['TravelTime'])}
                                                                                              </span>
                                                                                              <span className="stop-badge-container">
                                                                                                <div className="flight-line-a">
                                                                                                  {(() => {
                                                                                                    let totalIterations = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].length - 1;
                                                                                                    let stopoverCity = "";
                                                                                                    let flightTimeInMinutes = 0;
                                                                                                    {/* let layover = pricepoint['travelTime'] - flightTimeInMinutes; */ }
                                                                                                    if (totalIterations > 0) {
                                                                                                      pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].forEach((bookingInfo) => {
                                                                                                        SegmentList.map((segmentinfo) => {

                                                                                                          if (segmentinfo['$'] && segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']) {
                                                                                                            flightTimeInMinutes = flightTimeInMinutes + parseInt(segmentinfo['$']['FlightTime']);

                                                                                                            stopoverCity = handleAirport(segmentinfo['$']['Origin']);
                                                                                                          }
                                                                                                        });
                                                                                                      });
                                                                                                    }

                                                                                                    return (
                                                                                                      <p className="stop-badge" >
                                                                                                        {totalIterations} stop via {stopoverCity}
                                                                                                        <div className="tooltip-content">
                                                                                                          <p style={{ marginBottom: '0px' }}>Plane Change</p>
                                                                                                          {stopoverCity} | {convertMinutesToHours(pricepoint['travelTime'] - flightTimeInMinutes)} Layover
                                                                                                        </div>
                                                                                                      </p>
                                                                                                    );
                                                                                                  })()}
                                                                                                </div>
                                                                                              </span>
                                                                                            </div>
                                                                                            <div className="flight-line-d2"></div>
                                                                                          </span>
                                                                                          <div className="flight-line-a" style={{ width: 62 }}>

                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingindex === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].length - 1 &&
                                                                                                  <>
                                                                                                    {bookingInfo['$'] &&
                                                                                                      SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                        if (
                                                                                                          segmentinfo['$'] &&
                                                                                                          segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                        ) {

                                                                                                          return (
                                                                                                            <span key={segmentindex}>
                                                                                                              <b>
                                                                                                                {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                  hour: 'numeric',
                                                                                                                  minute: 'numeric',
                                                                                                                  hour12: false,
                                                                                                                })}
                                                                                                              </b>
                                                                                                              <span
                                                                                                                style={{
                                                                                                                  display: "inline-block",
                                                                                                                  width: 55,
                                                                                                                  whiteSpace: "nowrap",
                                                                                                                  textOverflow: "ellipsis"
                                                                                                                }}
                                                                                                              >
                                                                                                                <FlightInfoDestination Destination={handleAirport(segmentinfo['$']['Destination'])} onFlightDestinationChange={handleFlightDestinationChange} /><br />
                                                                                                                <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <>
                                                                                                                          {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                                </span>
                                                                                                                
                                                                                                              </span>
                                                                                                            </span>
                                                                                                          );
                                                                                                        }
                                                                                                      })
                                                                                                    }
                                                                                                  </>
                                                                                                }
                                                                                              </div>

                                                                                            ))}


                                                                                          </div>
                                                                                        </span>

                                                                                      </>
                                                                                    ) : (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$'] &&
                                                                                          pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                          SegmentList.map((segmentinfo, segmentindex) => {

                                                                                            if (
                                                                                              segmentinfo['$'] &&
                                                                                              segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                            ) {

                                                                                              return (
                                                                                                <span key={segmentindex}>
                                                                                                  <span className="lineflightss">
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 58 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        <FlightInfoOrigin origin={handleAirport(segmentinfo['$']['Origin'])} onFlightOriginChange={handleFlightOriginChange} /><br />
                                                                                                        <span className="apiairportresult">{handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                        {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                            flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                              if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                return (
                                                                                                                  <>
                                                                                                                    {flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                  </>
                                                                                                                );
                                                                                                              }
                                                                                                            })
                                                                                                          }
                                                                                                        </span>
                                                                                                      </span>
                                                                                                    </div>
                                                                                                    <span className="lineflights">
                                                                                                      <div className="flight-line-d1"></div>
                                                                                                      <div
                                                                                                        className="flight-line-a"

                                                                                                        style={{ textAlign: 'center', marginTop: '7%', width: '100px' }}
                                                                                                      >
                                                                                                        <span style={{ marginLeft: '5px', marginRight: '5px' }} >
                                                                                                          {calculateTravellingTime(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['$']['TravelTime'])}
                                                                                                        </span>
                                                                                                        <span className="stop-badge-container">
                                                                                                          <p className="stop-badge">
                                                                                                            Non-Stop
                                                                                                            <div className="tooltip-content">
                                                                                                              This is a direct flight with no stops.
                                                                                                            </div>
                                                                                                          </p>
                                                                                                        </span>
                                                                                                      </div>
                                                                                                      <div className="flight-line-d2"></div>
                                                                                                    </span>
                                                                                                    <div
                                                                                                      className="flight-line-a"
                                                                                                      style={{ width: 62 }}
                                                                                                    >
                                                                                                      <b>
                                                                                                        {new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                          hour: 'numeric',
                                                                                                          minute: 'numeric',
                                                                                                          hour12: false,
                                                                                                        })}
                                                                                                        <sup></sup>

                                                                                                      </b>
                                                                                                      <span
                                                                                                        style={{
                                                                                                          display: "inline-block",
                                                                                                          width: 55,
                                                                                                          whiteSpace: "nowrap",
                                                                                                          textOverflow: "ellipsis"
                                                                                                        }}
                                                                                                      >
                                                                                                        <FlightInfoDestination Destination={handleAirport(segmentinfo['$']['Destination'])} onFlightDestinationChange={handleFlightDestinationChange} /> <br />
                                                                                                        <span className="apiairportresult">
                                                                                                          {handleApiAirport(segmentinfo['$']['Destination'])}

                                                                                                          {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                            flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                              if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                return (
                                                                                                                  <>
                                                                                                                    {flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                  </>
                                                                                                                );
                                                                                                              }
                                                                                                            })
                                                                                                          }
                                                                                                        </span>
                                                                                                      </span>
                                                                                                    </div>
                                                                                                  </span>
                                                                                                </span>
                                                                                              );

                                                                                            }


                                                                                          })
                                                                                        }
                                                                                      </>
                                                                                    )
                                                                                  }
                                                                                </>
                                                                              )
                                                                          )
                                                                        }

                                                                      </>
                                                                    )
                                                                )
                                                                }

                                                                <div className="flt-i-price">
                                                                  {pricepoint['air:AirPricingInfo'] && (
                                                                    Array.isArray(pricepoint['air:AirPricingInfo']) ? (
                                                                      <>
                                                                        {(() => {
                                                                          const totalPrice =
                                                                            pricepoint['air:AirPricingInfo'][0]['$']['TotalPrice'];
                                                                          const seatType = cabinClass; // Set the seat type dynamically as needed
                                                                          const fareName = "Base Fare";
                                                                          const airline = inputOrigin;
                                                                          const finalPrice = calculateFinalPrice(totalPrice, markupdata, seatType, fareName, airline, flight_type);

                                                                          return (
                                                                            <>
                                                                              {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                              {Math.floor(finalPrice)} {/* Show final price with markup applied */}
                                                                            </>
                                                                          );
                                                                        })()}
                                                                      </>
                                                                    ) : (
                                                                      <>
                                                                        {(() => {
                                                                          const totalPrice =
                                                                            pricepoint['air:AirPricingInfo']['$']['TotalPrice'];
                                                                          const seatType = cabinClass; // Set the seat type dynamically as needed
                                                                          const fareName = "Base Fare";
                                                                          const airline = inputOrigin;
                                                                          const finalPrice = calculateFinalPrice(totalPrice, markupdata, seatType, fareName, airline, flight_type);

                                                                          return (
                                                                            <>
                                                                              {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                              {Math.floor(finalPrice)} {/* Show final price with markup applied */}
                                                                            </>
                                                                          );
                                                                        })()}
                                                                      </>
                                                                    )
                                                                  )}


                                                                </div>



                                                                <div className="clear" />
                                                                {/* // flight details // */}
                                                                <div className="flight-details" style={{ display: visibleFlightIndex === priceindex ? 'block' : 'none' }}>
                                                                  <Nav justify variant="tabs" className="flight_nav" defaultActiveKey={`Flight_Details${priceindex}`} activeKey={activeTab} onSelect={setActiveTab}>
                                                                    <Nav.Item>
                                                                      <Nav.Link eventKey={`Flight_Detail${priceindex}`} className={activeTab.includes(`Flight_Detail${priceindex}`) ? 'active' : ''}>Flight Detail</Nav.Link>
                                                                    </Nav.Item>
                                                                    <Nav.Item>
                                                                      <Nav.Link eventKey={`Fare_Summary${priceindex}`}>Fare Summary</Nav.Link>
                                                                    </Nav.Item>
                                                                    <Nav.Item>
                                                                      <Nav.Link eventKey={`Date_Change${priceindex}`}>Date Change</Nav.Link>
                                                                    </Nav.Item>
                                                                    <Nav.Item>
                                                                      <Nav.Link eventKey={`Cancellation${priceindex}`}>Cancellation</Nav.Link>
                                                                    </Nav.Item>
                                                                  </Nav>
                                                                  {pricepoint['air:AirPricingInfo'] && (
                                                                    Array.isArray(pricepoint['air:AirPricingInfo'])
                                                                      ? (
                                                                        <div>
                                                                          <div id={`Flight_Detail${priceindex}`} className="tabcontent" style={activeTab.includes(`Flight_Detail${priceindex}`) ? { display: 'block' } : { display: 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList'] &&
                                                                              pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption'] &&
                                                                              pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'] && (
                                                                                Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'])
                                                                                  ? (
                                                                                    <div>
                                                                                      {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'] &&
                                                                                        Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'])
                                                                                        ? (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingInfo['$'] &&
                                                                                                  SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (
                                                                                                      segmentinfo['$'] &&
                                                                                                      segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                    ) {

                                                                                                      return (
                                                                                                        <div key={segmentindex}>

                                                                                                          <div>
                                                                                                            <div className="flight-details-d">
                                                                                                              <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                              <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfo)} />
                                                                                                            </div>
                                                                                                            <div className="flight-details-a">
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handleAirline(segmentinfo['$']['Carrier'])
                                                                                                              } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                              &nbsp;

                                                                                                              {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handledatemonth(segmentinfo['$']['DepartureTime'])

                                                                                                              }

                                                                                                              <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>

                                                                                                            </div>

                                                                                                            <div className="clear" />
                                                                                                            <div className="flight-details-l">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-m">
                                                                                                              <div className="flight-details-e">
                                                                                                                {segmentinfo['$']
                                                                                                                  && (() => {
                                                                                                                    const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                    const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                    const minutes = flightTimeInMinutes % 60;
                                                                                                                    const formattedHours = String(hours).padStart(2, '0');
                                                                                                                    const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                    const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                    return formattedFlightTime;
                                                                                                                  })
                                                                                                                    ()}

                                                                                                              </div>
                                                                                                              <div className="flight-details-e">
                                                                                                                <hr />
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-r">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                                }
                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="clear" />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                      );
                                                                                                    }
                                                                                                  })
                                                                                                }
                                                                                              </div>
                                                                                            ))}
                                                                                          </div>
                                                                                        ) : (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                              pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                              SegmentList.map((segmentinfo, segmentindex) => {

                                                                                                if (
                                                                                                  segmentinfo['$'] &&
                                                                                                  segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                                ) {
                                                                                                  const bookingInfoo = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'];

                                                                                                  return (
                                                                                                    <div key={segmentindex}>

                                                                                                      <div>
                                                                                                        <div className="flight-details-d">
                                                                                                          <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                          <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfoo)} />
                                                                                                        </div>
                                                                                                        <div className="flight-details-a">
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handleAirline(segmentinfo['$']['Carrier'])
                                                                                                          } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                          &nbsp;

                                                                                                          {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                          }

                                                                                                          <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>

                                                                                                        </div>

                                                                                                        <div className="clear" />
                                                                                                        <div className="flight-details-l">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-m">
                                                                                                          <div className="flight-details-e">
                                                                                                            {segmentinfo['$']
                                                                                                              && (() => {
                                                                                                                const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                const minutes = flightTimeInMinutes % 60;
                                                                                                                const formattedHours = String(hours).padStart(2, '0');
                                                                                                                const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                return formattedFlightTime;
                                                                                                              })
                                                                                                                ()}
                                                                                                          </div>
                                                                                                          <div className="flight-details-e">
                                                                                                            <hr />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-r">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                            }
                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="clear" />
                                                                                                      </div>
                                                                                                    </div>
                                                                                                  );
                                                                                                }
                                                                                              })
                                                                                            }
                                                                                          </div>
                                                                                        )
                                                                                      }
                                                                                    </div>
                                                                                  ) : (
                                                                                    <div>
                                                                                      {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'] &&
                                                                                        Array.isArray(pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'])
                                                                                        ? (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingInfo['$'] &&
                                                                                                  SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (
                                                                                                      segmentinfo['$'] &&
                                                                                                      segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                    ) {

                                                                                                      return (
                                                                                                        <div key={segmentindex}>

                                                                                                          <div>
                                                                                                            <div className="flight-details-d">
                                                                                                              <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                              <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfo)} />
                                                                                                            </div>
                                                                                                            <div className="flight-details-a">
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handleAirline(segmentinfo['$']['Carrier'])
                                                                                                              } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                              &nbsp;

                                                                                                              {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                              }
                                                                                                              <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>


                                                                                                            </div>

                                                                                                            <div className="clear" />
                                                                                                            <div className="flight-details-l">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-m">
                                                                                                              <div className="flight-details-e">
                                                                                                                {segmentinfo['$']
                                                                                                                  && (() => {
                                                                                                                    const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                    const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                    const minutes = flightTimeInMinutes % 60;
                                                                                                                    const formattedHours = String(hours).padStart(2, '0');
                                                                                                                    const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                    const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                    return formattedFlightTime;
                                                                                                                  })
                                                                                                                    ()}

                                                                                                              </div>
                                                                                                              <div className="flight-details-e">
                                                                                                                <hr />
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-r">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                                }
                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="clear" />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                      );
                                                                                                    }
                                                                                                  })
                                                                                                }
                                                                                              </div>
                                                                                            ))}
                                                                                          </div>
                                                                                        ) : (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$'] &&
                                                                                              pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                              SegmentList.map((segmentinfo, segmentindex) => {

                                                                                                if (
                                                                                                  segmentinfo['$'] &&
                                                                                                  segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                                ) {
                                                                                                  const bookingInfoo = pricepoint['air:AirPricingInfo'][0]['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'];

                                                                                                  return (
                                                                                                    <div key={segmentindex}>

                                                                                                      <div>
                                                                                                        <div className="flight-details-d">
                                                                                                          <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                          <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfoo)} />
                                                                                                        </div>
                                                                                                        <div className="flight-details-a">
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handleAirline(segmentinfo['$']['Carrier'])
                                                                                                          } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                          &nbsp;

                                                                                                          {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                          }
                                                                                                          <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>


                                                                                                        </div>

                                                                                                        <div className="clear" />
                                                                                                        <div className="flight-details-l">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-m">
                                                                                                          <div className="flight-details-e">
                                                                                                            {segmentinfo['$']
                                                                                                              && (() => {
                                                                                                                const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                const minutes = flightTimeInMinutes % 60;
                                                                                                                const formattedHours = String(hours).padStart(2, '0');
                                                                                                                const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                return formattedFlightTime;
                                                                                                              })
                                                                                                                ()}

                                                                                                          </div>
                                                                                                          <div className="flight-details-e">
                                                                                                            <hr />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-r">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                            }
                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="clear" />
                                                                                                      </div>
                                                                                                    </div>
                                                                                                  );
                                                                                                }
                                                                                              })
                                                                                            }
                                                                                          </div>
                                                                                        )
                                                                                      }
                                                                                    </div>
                                                                                  )
                                                                              )
                                                                            }
                                                                          </div>
                                                                          <div id={`Fare_Summary${priceindex}`} className="tabcontent" style={{ display: activeTab === `Fare_Summary${priceindex}` ? 'block' : 'none' }}>

                                                                            <div className="flight-details-a">
                                                                              Fare Breakup (For All Passengers)
                                                                            </div>

                                                                            <div className="flight-details-l">
                                                                              <div className="flight-details-b">
                                                                                Total Fare
                                                                              </div>
                                                                              <div className="flight-details-c">
                                                                                Base Price
                                                                              </div>
                                                                              {Array.isArray(pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"])
                                                                                ? pricepoint["air:AirPricingInfo"]["air:TaxInfo"].map((tax, index) => (
                                                                                  <div key={index} className="flight-details-c">
                                                                                    {tax["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {tax["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                ))
                                                                                : pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"] && (
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                )}
                                                                              <div className="flight-details-c">
                                                                                Surcharge
                                                                              </div>
                                                                            </div>
                                                                            <div className="flight-details-r">
                                                                              <div className="flight-details-b">
                                                                                {pricepoint.$.TotalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.TotalPrice.replace('INR', '')}
                                                                              </div>
                                                                              <div className="flight-details-c">
                                                                                {pricepoint.$.BasePrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.BasePrice.replace('INR', '')}
                                                                              </div>
                                                                              {Array.isArray(pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"])
                                                                                ? pricepoint["air:AirPricingInfo"]["air:TaxInfo"].map((tax, index) => (
                                                                                  <div key={index} className="flight-details-c">
                                                                                    {tax["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {tax["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                ))
                                                                                : pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"] && (
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                )}
                                                                              <div className="flight-details-c">
                                                                                {pricepoint.$.Taxes.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.Taxes.replace('INR', '')}
                                                                              </div>
                                                                            </div>
                                                                            <div className="clear" />
                                                                          </div>
                                                                          <div id={`Date_Change${priceindex}`} className="tabcontent" style={{ display: activeTab === `Date_Change${priceindex}` ? 'block' : 'none' }}>
                                                                            {pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty'] ? (
                                                                              <div>
                                                                                <div className="flight-details-a">
                                                                                  {flightorigins} to {flightdestinations} || &nbsp;
                                                                                  {flightDepartureDates}
                                                                                </div>

                                                                                <div className="flight-details-l">
                                                                                  <div className="flight-details-b">Time Frame</div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['$'] &&
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['$']['PenaltyApplies']
                                                                                      ? pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['$']['PenaltyApplies']
                                                                                      : 'NA'}
                                                                                  </div>
                                                                                </div>

                                                                                <div className="flight-details-r">
                                                                                  <div className="flight-details-b">Airline Fee</div>
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['air:Amount'] ? (
                                                                                      <>
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['air:Amount'].includes('INR') ? 'â‚¹ ' : ''}
                                                                                        {pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['air:Amount'].replace('INR', '').trim()}
                                                                                      </>
                                                                                    ) : pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['air:Percentage'] ? (
                                                                                      pricepoint['air:AirPricingInfo'][0]['air:ChangePenalty']['air:Percentage']
                                                                                    ) : (
                                                                                      'NA'
                                                                                    )}
                                                                                  </div>
                                                                                </div>

                                                                                <div className="clear" />
                                                                                <br className="clear" />
                                                                                <div className="flight-details-c">
                                                                                  <mark>
                                                                                    *Please note that the airline fee provided is indicative. CoTrav does not guarantee the exact amount of the
                                                                                    fee.
                                                                                  </mark>
                                                                                </div>
                                                                                <div className="clear" />
                                                                              </div>
                                                                            ) : (
                                                                              // Fallback Data Source
                                                                              <div>
                                                                                <div className="flight-details-a">
                                                                                  {flightorigins} to {flightdestinations} || &nbsp;
                                                                                  {flightDepartureDates}
                                                                                </div>

                                                                                <div className="flight-details-l">
                                                                                  <div className="flight-details-b">Date Change Fee</div>
                                                                                  <div className="flight-details-c">
                                                                                    {/* Call the function and display the result */}
                                                                                    {cancellationPolicy?.Date_Change?.find((policy) => policy.fare_name === "demo")?.fee || "N/A"}
                                                                                    {/* {cancellationPolicy?.Cancellation?.find((policy) => policy.fare_name === fareFamily)?.fee || "N/A"} */}

                                                                                  </div>
                                                                                </div>

                                                                                {/* <div className="flight-details-r">
                                                                                    <div className="flight-details-b">Airline Fee</div>
                                                                                    <div className="flight-details-c">
                                                                                      {cancellationPolicy?.Date_Change?.find((policy) => policy.fare_name === "demo")?.fee || "N/A"}
                                                                                      
                                                                                    </div>
                                                                                  </div> */}

                                                                                <div className="clear" />
                                                                                <br className="clear" />
                                                                                <div className="flight-details-c">
                                                                                  <mark>
                                                                                    *Please note that the airline fee provided is indicative. CoTrav does not guarantee the exact amount of the
                                                                                    fee.
                                                                                  </mark>
                                                                                </div>
                                                                                <div className="clear" />
                                                                              </div>
                                                                            )}
                                                                          </div>
                                                                          <div id={`Cancellation${priceindex}`} className="tabcontent" style={{ display: activeTab === `Cancellation${priceindex}` ? 'block' : 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty'] ? (
                                                                                <div>

                                                                                  <div className="flight-details-a">
                                                                                    {flightorigins} to {flightdestinations} ||  &nbsp;
                                                                                    {flightDepartureDates}
                                                                                  </div>

                                                                                  <div className="flight-details-l">
                                                                                    <div className="flight-details-b">
                                                                                      Time Frame
                                                                                    </div>
                                                                                    <div className="flight-details-c">
                                                                                      {pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['$'] &&
                                                                                        pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['$']['PenaltyApplies'] ? (
                                                                                        pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['$']['PenaltyApplies']
                                                                                      ) : (
                                                                                        'NA'
                                                                                      )}
                                                                                    </div>
                                                                                  </div>
                                                                                  <div className="flight-details-r">
                                                                                    <div className="flight-details-b">
                                                                                      Airline Fee
                                                                                    </div>
                                                                                    <div className="flight-details-c">
                                                                                      {pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['air:Amount'] ? (
                                                                                        <>
                                                                                          {pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['air:Amount'].includes('INR') ? 'â‚¹ ' : ''}
                                                                                          {pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['air:Amount'].replace('INR', '').trim()}

                                                                                        </>
                                                                                      ) : (
                                                                                        pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['air:Percentage'] ? (
                                                                                          pricepoint['air:AirPricingInfo'][0]['air:CancelPenalty']['air:Percentage']
                                                                                        ) : (
                                                                                          'NA'
                                                                                        )
                                                                                      )}
                                                                                    </div>
                                                                                  </div>
                                                                                  <div className="clear" />
                                                                                  <br className="clear" />
                                                                                  <div className="flight-details-c">
                                                                                    <mark>
                                                                                      *Please note that the airline fee provided is indicative. CoTrav does not guarantee the exact amount of the fee.
                                                                                    </mark>
                                                                                  </div>
                                                                                  <div className="clear" />
                                                                                </div>
                                                                              ) : (
                                                                                <div>

                                                                                  <div className="flight-details-a">
                                                                                    {flightorigins} to {flightdestinations} ||  &nbsp;
                                                                                    {flightDepartureDates}
                                                                                  </div>

                                                                                  <div className="flight-details-l">
                                                                                    <div className="flight-details-b">Cancellation Charges</div>
                                                                                    <div className="flight-details-c">
                                                                                      {/* Call the function and display the result */}
                                                                                      {cancellationPolicy?.Cancellation?.find((policy) => policy.fare_name === "demo")?.fee || "N/A"}
                                                                                      {/* {cancellationPolicy?.Cancellation?.find((policy) => policy.fare_name === fareFamily)?.fee || "N/A"} */}

                                                                                    </div>
                                                                                  </div>

                                                                                  {/* <div className="flight-details-r">
                                                                                    <div className="flight-details-b">Airline Fee</div>
                                                                                    <div className="flight-details-c">
                                                                                      {cancellationPolicy?.Cancellation?.find((policy) => policy.fare_name === "demo")?.fee || "N/A"}
                                                                                      
                                                                                    </div>
                                                                                  </div> */}
                                                                                  <div className="clear" />
                                                                                  <br className="clear" />
                                                                                  <div className="flight-details-c">
                                                                                    <mark>
                                                                                      *Please note that the airline fee provided is indicative. CoTrav does not guarantee the exact amount of the fee.
                                                                                    </mark>
                                                                                  </div>
                                                                                  <div className="clear" />
                                                                                </div>
                                                                              )
                                                                            }
                                                                          </div>
                                                                        </div>
                                                                      ) : (
                                                                        <div>
                                                                          <div id={`Flight_Detail${priceindex}`} className="tabcontent" style={activeTab.includes(`Flight_Detail${priceindex}`) ? { display: 'block' } : { display: 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo']['air:FlightOptionsList'] &&
                                                                              pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption'] &&
                                                                              pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'] && (
                                                                                Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'])
                                                                                  ? (
                                                                                    <div>
                                                                                      {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'] &&
                                                                                        Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'])
                                                                                        ? (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingInfo['$'] &&
                                                                                                  SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (
                                                                                                      segmentinfo['$'] &&
                                                                                                      segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                    ) {
                                                                                                      return (
                                                                                                        <div key={segmentindex}>

                                                                                                          <div>
                                                                                                            <div className="flight-details-d">
                                                                                                              <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                              <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfo)} />
                                                                                                            </div>
                                                                                                            <div className="flight-details-a">
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handleAirline(segmentinfo['$']['Carrier'])
                                                                                                              } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                              &nbsp;

                                                                                                              {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                              }
                                                                                                              <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>
                                                                                                            </div>

                                                                                                            <div className="clear" />
                                                                                                            <div className="flight-details-l">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo?.['$'] && handleApiAirport(segmentinfo['$']['Origin'])}

                                                                                                                {segmentinfo?.['air:FlightDetailsRef']?.['$']?.['Key'] &&
                                                                                                                  flightDetails?.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (flightdetailinfo?.['$']?.['Key'] &&
                                                                                                                      segmentinfo['air:FlightDetailsRef']?.['$']?.['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>
                                                                                                                          {flightdetailinfo?.['$']?.['OriginTerminal'] && ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                        </span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                    return null; // Prevent React warning for missing return
                                                                                                                  })}
                                                                                                              </div>

                                                                                                            </div>
                                                                                                            <div className="flight-details-m">
                                                                                                              <div className="flight-details-e">
                                                                                                                {segmentinfo['$']
                                                                                                                  && (() => {
                                                                                                                    const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                    const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                    const minutes = flightTimeInMinutes % 60;
                                                                                                                    const formattedHours = String(hours).padStart(2, '0');
                                                                                                                    const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                    const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                    return formattedFlightTime;
                                                                                                                  })
                                                                                                                    ()}

                                                                                                              </div>
                                                                                                              <div className="flight-details-e">
                                                                                                                <hr />
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-r">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                                }
                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo?.['$']?.['Destination'] && handleApiAirport(segmentinfo['$']['Destination'])}

                                                                                                                {segmentinfo?.['air:FlightDetailsRef']?.['$']?.['Key'] &&
                                                                                                                  flightDetails?.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (flightdetailinfo?.['$']?.['Key'] &&
                                                                                                                      segmentinfo?.['air:FlightDetailsRef']?.['$']?.['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>
                                                                                                                          {flightdetailinfo?.['$']?.['DestinationTerminal'] &&
                                                                                                                            ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                        </span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                    return null; // Prevent React warning for missing return
                                                                                                                  })}
                                                                                                              </div>

                                                                                                            </div>
                                                                                                            <div className="clear" />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                      );
                                                                                                    }
                                                                                                  })
                                                                                                }


                                                                                              </div>
                                                                                            ))}


                                                                                          </div>
                                                                                        ) : (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$'] &&
                                                                                              pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                              SegmentList.map((segmentinfo, segmentindex) => {

                                                                                                if (
                                                                                                  segmentinfo['$'] &&
                                                                                                  segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo']['$']['SegmentRef']
                                                                                                ) {
                                                                                                  const bookingInfoo = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option'][0]['air:BookingInfo'];

                                                                                                  return (
                                                                                                    <div key={segmentindex}>

                                                                                                      <div>
                                                                                                        <div className="flight-details-d">
                                                                                                          <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                          <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfoo)} />
                                                                                                        </div>
                                                                                                        <div className="flight-details-a">
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handleAirline(segmentinfo['$']['Carrier'])
                                                                                                          } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                          &nbsp;

                                                                                                          {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                          }
                                                                                                          <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>


                                                                                                        </div>

                                                                                                        <div className="clear" />
                                                                                                        <div className="flight-details-l">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {/* Check if segmentinfo.$ exists before accessing Origin */}
                                                                                                            {segmentinfo?.['$']?.['Origin'] && handleApiAirport(segmentinfo['$']['Origin'])}

                                                                                                            {/* Ensure segmentinfo.air:FlightDetailsRef and its properties exist before accessing */}
                                                                                                            {segmentinfo?.['air:FlightDetailsRef']?.['$']?.['Key'] &&
                                                                                                              flightDetails?.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (
                                                                                                                  flightdetailinfo?.['$']?.['Key'] &&
                                                                                                                  segmentinfo?.['air:FlightDetailsRef']?.['$']?.['Key'] === flightdetailinfo['$']['Key']
                                                                                                                ) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>
                                                                                                                      {flightdetailinfo?.['$']?.['OriginTerminal'] &&
                                                                                                                        ` T-${flightdetailinfo['$']['OriginTerminal']}`}
                                                                                                                    </span>
                                                                                                                  );
                                                                                                                }
                                                                                                                return null; // Prevent React warning for missing return
                                                                                                              })}
                                                                                                          </div>

                                                                                                        </div>
                                                                                                        <div className="flight-details-m">
                                                                                                          <div className="flight-details-e">
                                                                                                            {segmentinfo['$']
                                                                                                              && (() => {
                                                                                                                const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                const minutes = flightTimeInMinutes % 60;
                                                                                                                const formattedHours = String(hours).padStart(2, '0');
                                                                                                                const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                return formattedFlightTime;
                                                                                                              })
                                                                                                                ()}

                                                                                                          </div>
                                                                                                          <div className="flight-details-e">
                                                                                                            <hr />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-r">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                            }
                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {/* Ensure segmentinfo.$ exists before accessing Destination */}
                                                                                                            {segmentinfo?.['$']?.['Destination'] && handleApiAirport(segmentinfo['$']['Destination'])}

                                                                                                            {/* Ensure segmentinfo.air:FlightDetailsRef and its properties exist before accessing */}
                                                                                                            {segmentinfo?.['air:FlightDetailsRef']?.['$']?.['Key'] &&
                                                                                                              flightDetails?.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (
                                                                                                                  flightdetailinfo?.['$']?.['Key'] &&
                                                                                                                  segmentinfo?.['air:FlightDetailsRef']?.['$']?.['Key'] === flightdetailinfo['$']['Key']
                                                                                                                ) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>
                                                                                                                      {flightdetailinfo?.['$']?.['DestinationTerminal'] &&
                                                                                                                        ` T-${flightdetailinfo['$']['DestinationTerminal']}`}
                                                                                                                    </span>
                                                                                                                  );
                                                                                                                }
                                                                                                                return null; // Prevent React warnings for missing return
                                                                                                              })}
                                                                                                          </div>

                                                                                                        </div>
                                                                                                        <div className="clear" />
                                                                                                      </div>
                                                                                                    </div>
                                                                                                  );
                                                                                                }
                                                                                              })
                                                                                            }
                                                                                          </div>
                                                                                        )
                                                                                      }
                                                                                    </div>
                                                                                  ) : (
                                                                                    <div>
                                                                                      {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'] &&
                                                                                        Array.isArray(pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'])
                                                                                        ? (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'].map((bookingInfo, bookingindex) => (
                                                                                              <div key={bookingindex}>
                                                                                                {bookingInfo['$'] &&
                                                                                                  SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                    if (
                                                                                                      segmentinfo['$'] &&
                                                                                                      segmentinfo['$']['Key'] === bookingInfo['$']['SegmentRef']
                                                                                                    ) {

                                                                                                      return (
                                                                                                        <div key={segmentindex}>

                                                                                                          <div>
                                                                                                            <div className="flight-details-d">
                                                                                                              <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                              <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfo)} />
                                                                                                            </div>
                                                                                                            <div className="flight-details-a">
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handleAirline(segmentinfo['$']['Carrier'])
                                                                                                              } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                              &nbsp;

                                                                                                              {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                              {segmentinfo['$'] &&
                                                                                                                handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                              }
                                                                                                              <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>


                                                                                                            </div>

                                                                                                            <div className="clear" />
                                                                                                            <div className="flight-details-l">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-m">
                                                                                                              <div className="flight-details-e">
                                                                                                                {segmentinfo['$']
                                                                                                                  && (() => {
                                                                                                                    const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                    const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                    const minutes = flightTimeInMinutes % 60;
                                                                                                                    const formattedHours = String(hours).padStart(2, '0');
                                                                                                                    const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                    const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                    return formattedFlightTime;
                                                                                                                  })
                                                                                                                    ()}

                                                                                                              </div>
                                                                                                              <div className="flight-details-e">
                                                                                                                <hr />
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="flight-details-r">
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                              </div>
                                                                                                              <div className="flight-details-b">
                                                                                                                {segmentinfo['$'] &&
                                                                                                                  handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                                }
                                                                                                              </div>
                                                                                                              <div className="flight-details-c">
                                                                                                                {
                                                                                                                  segmentinfo['$'] &&
                                                                                                                  new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                    hour: 'numeric',
                                                                                                                    minute: 'numeric',
                                                                                                                    hour12: false,
                                                                                                                  })
                                                                                                                }

                                                                                                              </div>
                                                                                                              <div className="flight-details-c1">
                                                                                                                {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                                {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                                  flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                    if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                      return (
                                                                                                                        <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                          ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                      );
                                                                                                                    }
                                                                                                                  })
                                                                                                                }
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div className="clear" />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                      );
                                                                                                    }
                                                                                                  })
                                                                                                }
                                                                                              </div>
                                                                                            ))}
                                                                                          </div>
                                                                                        ) : (
                                                                                          <div>
                                                                                            {pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$'] &&
                                                                                              pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef'] &&
                                                                                              SegmentList.map((segmentinfo, segmentindex) => {
                                                                                                if (
                                                                                                  segmentinfo['$'] &&
                                                                                                  segmentinfo['$']['Key'] === pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo']['$']['SegmentRef']
                                                                                                ) {

                                                                                                  const bookingInfoo = pricepoint['air:AirPricingInfo']['air:FlightOptionsList']['air:FlightOption']['air:Option']['air:BookingInfo'];

                                                                                                  return (
                                                                                                    <div key={segmentindex}>

                                                                                                      <div>
                                                                                                        <div className="flight-details-d">
                                                                                                          <input type="hidden" name="Segmentarray[]" value={JSON.stringify(segmentinfo)} />
                                                                                                          <input type="hidden" name="BookingInfoData[]" value={JSON.stringify(bookingInfoo)} />
                                                                                                        </div>
                                                                                                        <div className="flight-details-a">
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handleAirline(segmentinfo['$']['Carrier'])
                                                                                                          } . &nbsp;{segmentinfo['$']['Carrier']}{segmentinfo['$']['FlightNumber']} &nbsp;||
                                                                                                          &nbsp;

                                                                                                          {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])} to {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])} , &nbsp;
                                                                                                          {segmentinfo['$'] &&
                                                                                                            handledatemonth(segmentinfo['$']['DepartureTime'])
                                                                                                          }

                                                                                                          <span className="equipmentno">{segmentinfo['$']['Equipment']}</span>

                                                                                                        </div>

                                                                                                        <div className="clear" />
                                                                                                        <div className="flight-details-l">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Origin'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['DepartureTime'])
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['DepartureTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Origin'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['OriginTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['OriginTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-m">
                                                                                                          <div className="flight-details-e">
                                                                                                            {segmentinfo['$']
                                                                                                              && (() => {
                                                                                                                const flightTimeInMinutes = parseInt(segmentinfo['$']['FlightTime']);
                                                                                                                const hours = Math.floor(flightTimeInMinutes / 60);
                                                                                                                const minutes = flightTimeInMinutes % 60;
                                                                                                                const formattedHours = String(hours).padStart(2, '0');
                                                                                                                const formattedMinutes = String(minutes).padStart(2, '0');
                                                                                                                const formattedFlightTime = `${formattedHours}h ${formattedMinutes}m`;
                                                                                                                return formattedFlightTime;
                                                                                                              })
                                                                                                                ()}

                                                                                                          </div>
                                                                                                          <div className="flight-details-e">
                                                                                                            <hr />
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="flight-details-r">
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] && handleAirport(segmentinfo['$']['Destination'])}

                                                                                                          </div>
                                                                                                          <div className="flight-details-b">
                                                                                                            {segmentinfo['$'] &&
                                                                                                              handleweekdatemonthyear(segmentinfo['$']['ArrivalTime'])
                                                                                                            }
                                                                                                          </div>
                                                                                                          <div className="flight-details-c">
                                                                                                            {
                                                                                                              segmentinfo['$'] &&
                                                                                                              new Date(segmentinfo['$']['ArrivalTime']).toLocaleTimeString('en-US', {
                                                                                                                hour: 'numeric',
                                                                                                                minute: 'numeric',
                                                                                                                hour12: false,
                                                                                                              })
                                                                                                            }

                                                                                                          </div>
                                                                                                          <div className="flight-details-c1">
                                                                                                            {segmentinfo['$'] && handleApiAirport(segmentinfo['$']['Destination'])}
                                                                                                            {segmentinfo['air:FlightDetailsRef']['$'] && segmentinfo['air:FlightDetailsRef']['$']['Key'] &&
                                                                                                              flightDetails && flightDetails.map((flightdetailinfo, flightdetailindex) => {
                                                                                                                if (segmentinfo['air:FlightDetailsRef']['$']['Key'] === flightdetailinfo['$']['Key']) {
                                                                                                                  return (
                                                                                                                    <span key={flightdetailindex}>{flightdetailinfo['$'] && flightdetailinfo['$']['DestinationTerminal'] &&
                                                                                                                      ` T-${flightdetailinfo['$']['DestinationTerminal']}`}</span>
                                                                                                                  );
                                                                                                                }
                                                                                                              })
                                                                                                            }
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div className="clear" />
                                                                                                      </div>
                                                                                                    </div>
                                                                                                  );
                                                                                                }
                                                                                              })
                                                                                            }
                                                                                          </div>
                                                                                        )
                                                                                      }
                                                                                    </div>
                                                                                  )
                                                                              )
                                                                            }
                                                                          </div>
                                                                          <div id={`Fare_Summary${priceindex}`} className="tabcontent" style={{ display: activeTab === `Fare_Summary${priceindex}` ? 'block' : 'none' }}>

                                                                            <div className="flight-details-a">
                                                                              Fare Breakup (For All Passengers)
                                                                            </div>

                                                                            <div className="flight-details-l">
                                                                              <div className="flight-details-b">
                                                                                Total Fare
                                                                              </div>
                                                                              <div className="flight-details-c">
                                                                                Base Price
                                                                              </div>
                                                                              {Array.isArray(pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"])
                                                                                ? pricepoint["air:AirPricingInfo"]["air:TaxInfo"].map((tax, index) => (
                                                                                  <div key={index} className="flight-details-c">
                                                                                    {tax["$"]["Category"]}
                                                                                  </div>
                                                                                ))
                                                                                : pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"] && (
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Category"]}
                                                                                  </div>
                                                                                )}

                                                                              <div className="flight-details-c">
                                                                                Surcharge
                                                                              </div>
                                                                            </div>
                                                                            <div className="flight-details-r">
                                                                              <div className="flight-details-b">
                                                                                {pricepoint.$.TotalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.TotalPrice.replace('INR', '')}
                                                                              </div>
                                                                              <div className="flight-details-c">
                                                                                {pricepoint.$.BasePrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.BasePrice.replace('INR', '')}
                                                                              </div>
                                                                              {Array.isArray(pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"])
                                                                                ? pricepoint["air:AirPricingInfo"]["air:TaxInfo"].map((tax, index) => (
                                                                                  <div key={index} className="flight-details-c">
                                                                                    {tax["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {tax["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                ))
                                                                                : pricepoint["air:AirPricingInfo"]?.["air:TaxInfo"] && (
                                                                                  <div className="flight-details-c">
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].includes("INR") ? "â‚¹ " : ""}
                                                                                    {pricepoint["air:AirPricingInfo"]["air:TaxInfo"]["$"]["Amount"].replace("INR", "")}
                                                                                  </div>
                                                                                )}
                                                                              <div className="flight-details-c">
                                                                                {pricepoint.$.Taxes.includes('INR') ? 'â‚¹ ' : ''}
                                                                                {pricepoint.$.Taxes.replace('INR', '')}
                                                                              </div>
                                                                            </div>
                                                                            <div className="clear" />
                                                                          </div>
                                                                          <div id={`Date_Change${priceindex}`} className="tabcontent" style={{ display: activeTab === `Date_Change${priceindex}` ? 'block' : 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo']['air:ChangePenalty'] ? (
                                                                                <div>

                                                                                  <div className="flight-details-a">
                                                                                    {flightorigins} to {flightdestinations} ||  &nbsp;
                                                                                    {flightDepartureDates}
                                                                                  </div>

                                                                                  <div className="flight-details-l">
                                                                                    <div className="flight-details-b">
                                                                                      Time Frame
                                                                                    </div>
                                                                                    <div className="flight-details-c">
                                                                                      {pricepoint['air:AirPricingInfo']['air:ChangePenalty']['$'] &&
                                                                                        pricepoint['air:AirPricingInfo']['air:ChangePenalty']['$']['PenaltyApplies'] ? (
                                                                                        pricepoint['air:AirPricingInfo']['air:ChangePenalty']['$']['PenaltyApplies']
                                                                                      ) : (
                                                                                        'NA'
                                                                                      )
                                                                                      }
                                                                                    </div>
                                                                                  </div>
                                                                                  <div className="flight-details-r">
                                                                                    <div className="flight-details-b">
                                                                                      Airline Fee
                                                                                    </div>
                                                                                    <div className="flight-details-c">
                                                                                      {pricepoint['air:AirPricingInfo']['air:ChangePenalty']['air:Amount'] ? (
                                                                                        <>
                                                                                          {pricepoint['air:AirPricingInfo']['air:ChangePenalty']['air:Amount'].includes('INR') ? 'â‚¹ ' : ''}
                                                                                          {pricepoint['air:AirPricingInfo']['air:ChangePenalty']['air:Amount'].replace('INR', '').trim()}
                                                                                        </>
                                                                                      ) : (
                                                                                        pricepoint['air:AirPricingInfo']['air:ChangePenalty']['air:Percentage'] ? (
                                                                                          pricepoint['air:AirPricingInfo']['air:ChangePenalty']['air:Percentage']
                                                                                        ) : (
                                                                                          'NA'
                                                                                        )
                                                                                      )}
                                                                                    </div>
                                                                                  </div>
                                                                                  <div className="clear" />
                                                                                  <br className="clear" />
                                                                                  <div className="flight-details-c">
                                                                                    <mark>
                                                                                      *Please note that the airline fee provided is indicative. CoTrav does not guarantee the exact amount of the fee.
                                                                                    </mark>
                                                                                  </div>
                                                                                  <div className="clear" />
                                                                                </div>
                                                                              ) : (
                                                                                <div>
                                                                                  <div className="flight-details-a">
                                                                                    {flightorigins} to {flightdestinations} || &nbsp;
                                                                                    {flightDepartureDates}
                                                                                  </div>

                                                                                  <div className="flight-details-l">
                                                                                    <div className="flight-details-b">Date Change Fee</div>
                                                                                    <div className="flight-details-c">
                                                                                      {/* Call the function and display the result */}
                                                                                      {cancellationPolicy?.Date_Change?.find((policy) => policy.fare_name === "demo")?.fee || "N/A"}
                                                                                      {/* {cancellationPolicy?.Cancellation?.find((policy) => policy.fare_name === fareFamily)?.fee || "N/A"} */}

                                                                                    </div>
                                                                                  </div>

                                                                                  {/* <div className="flight-details-r">
                                                                                    <div className="flight-details-b">Airline Fee</div>
                                                                                    <div className="flight-details-c">
                                                                                      {cancellationPolicy?.Date_Change?.find((policy) => policy.fare_name === "demo")?.fee || "N/A"}
                                                                                      
                                                                                    </div>
                                                                                  </div> */}

                                                                                  <div className="clear" />
                                                                                  <br className="clear" />
                                                                                  <div className="flight-details-c">
                                                                                    <mark>
                                                                                      *Please note that the airline fee provided is indicative. CoTrav does not guarantee the exact amount of the
                                                                                      fee.
                                                                                    </mark>
                                                                                  </div>
                                                                                  <div className="clear" />
                                                                                </div>
                                                                              )
                                                                            }
                                                                          </div>
                                                                          <div id={`Cancellation${priceindex}`} className="tabcontent" style={{ display: activeTab === `Cancellation${priceindex}` ? 'block' : 'none' }}>
                                                                            {
                                                                              pricepoint['air:AirPricingInfo']['air:CancelPenalty'] ? (
                                                                                <div>

                                                                                  <div className="flight-details-a">
                                                                                    {flightorigins} to {flightdestinations} ||  &nbsp;
                                                                                    {flightDepartureDates}
                                                                                  </div>

                                                                                  <div className="flight-details-l">
                                                                                    <div className="flight-details-b">
                                                                                      Time Frame
                                                                                    </div>
                                                                                    <div className="flight-details-c">
                                                                                      {pricepoint['air:AirPricingInfo']['air:CancelPenalty']['$'] &&
                                                                                        pricepoint['air:AirPricingInfo']['air:CancelPenalty']['$']['PenaltyApplies'] ? (
                                                                                        pricepoint['air:AirPricingInfo']['air:CancelPenalty']['$']['PenaltyApplies']
                                                                                      ) : (
                                                                                        'NA'
                                                                                      )}
                                                                                    </div>
                                                                                  </div>
                                                                                  <div className="flight-details-r">
                                                                                    <div className="flight-details-b">
                                                                                      Airline Fee.
                                                                                    </div>
                                                                                    <div className="flight-details-c">
                                                                                      {pricepoint['air:AirPricingInfo']['air:CancelPenalty']['air:Amount'] ? (
                                                                                        <>
                                                                                          {pricepoint['air:AirPricingInfo']['air:CancelPenalty']['air:Amount'].includes('INR') ? 'â‚¹ ' : ''}
                                                                                          {pricepoint['air:AirPricingInfo']['air:CancelPenalty']['air:Amount'].replace('INR', '').trim()}

                                                                                        </>
                                                                                      ) : (
                                                                                        pricepoint['air:AirPricingInfo']['air:CancelPenalty']['air:Percentage'] ? (
                                                                                          pricepoint['air:AirPricingInfo']['air:CancelPenalty']['air:Percentage']
                                                                                        ) : (
                                                                                          'NA'
                                                                                        )
                                                                                      )}
                                                                                    </div>
                                                                                  </div>
                                                                                  <div className="clear" />
                                                                                  <br className="clear" />
                                                                                  <div className="flight-details-c">
                                                                                    <mark>
                                                                                      *Please note that the airline fee provided is indicative. CoTrav does not guarantee the exact amount of the fee.
                                                                                    </mark>
                                                                                  </div>
                                                                                  <div className="clear" />
                                                                                </div>
                                                                              ) : (
                                                                                <div>

                                                                                  <div className="flight-details-a">
                                                                                    {flightorigins} to {flightdestinations} ||  &nbsp;
                                                                                    {flightDepartureDates}
                                                                                  </div>

                                                                                  <div className="flight-details-l">
                                                                                    <div className="flight-details-b">Cancellation Charges</div>
                                                                                    <div className="flight-details-c">
                                                                                      {/* Call the function and display the result */}
                                                                                      {cancellationPolicy?.Cancellation?.find((policy) => policy.fare_name === "demo")?.fee || "N/A"}
                                                                                      {/* {cancellationPolicy?.Cancellation?.find((policy) => policy.fare_name === fareFamily)?.fee || "N/A"} */}

                                                                                    </div>
                                                                                  </div>

                                                                                  {/* <div className="flight-details-r">
                                                                                    <div className="flight-details-b">Airline Fee</div>
                                                                                    <div className="flight-details-c">
                                                                                      {cancellationPolicy?.Cancellation?.find((policy) => policy.fare_name === "demo")?.fee || "N/A"}
                                                                                      
                                                                                    </div>
                                                                                  </div> */}
                                                                                  <div className="clear" />
                                                                                  <br className="clear" />
                                                                                  <div className="flight-details-c">
                                                                                    <mark>
                                                                                      *Please note that the airline fee provided is indicative. CoTrav does not guarantee the exact amount of the fee.
                                                                                    </mark>
                                                                                  </div>
                                                                                  <div className="clear" />
                                                                                </div>
                                                                              )
                                                                            }
                                                                          </div>
                                                                        </div>
                                                                      )
                                                                  )
                                                                  }
                                                                </div>
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <br className="clear" />
                                                        </div>
                                                      </div>
                                                      <div className="clear" />
                                                    </div>
                                                    <br className="clear" />
                                                  </div>
                                                  {visibleDetails && (
                                                    <div>
                                                      <div className="popup-overlay" onClick={() => setVisibleDetails(false)}></div>
                                                      <div className="selectdetail">
                                                        <button className="selectdetail-close" style={{ marginTop: "-2%", marginRight: "-1%" }} onClick={() => setVisibleDetails(false)}>
                                                          &times;
                                                        </button>
                                                        {fareInfoDetails ? (
                                                          <pre style={{ fontSize: '13px' }}>{fareInfoDetails}</pre>
                                                        ) : (
                                                          <p>No details are available at present. Please check back later.</p>
                                                        )}
                                                      </div>
                                                    </div>
                                                  )}



                                                  {isDropdownVisible && selectedPriceIndex === priceindex && (
                                                    <div className="row selectcontainer">
                                                      {loading ? (
                                                        <div className="loader custom-loader item-center justify-center flex flex-col items-center">
                                                          <img className="loader-giff" style={{ width: '5rem', height: '5rem' }} src="/img/cotravloader.gif" alt="Loader" />
                                                          {isbookingpage ? (
                                                            <p className="text-center ml-4 text-gray-600 " style={{ marginTop: '65px' }}>
                                                              {/* Redirecting to Booking Page. Please wait. */}
                                                            </p>
                                                          ) : (
                                                            <p className="text-center ml-4 text-gray-600" style={{ marginTop: '65px' }}>
                                                              {/* Retrieving Price details. Please wait a moment. */}
                                                            </p>
                                                          )}
                                                        </div>
                                                      ) : (
                                                        (fareInfoRefsState && fareInfoRefsState.length > 0 ? (
                                                          fareInfoRefsState.map((fareInfoRefKey, fareInfoIndex) => {
                                                            const extractedFareInfoRef = fareInfoRefKey['FareInfoRef'];
                                                            const extractedtaxinfo = fareInfoRefKey['TaxInfoRef'];

                                                            const matchingTaxInfo = TaxList.find(
                                                              (taxinfo) => taxinfo['Key'] === extractedtaxinfo
                                                            );
                                                            {/* console.log('matchingTaxInfo', matchingTaxInfo); */ }
                                                            const matchingFareInfo = FareList.find(
                                                              (fareInfo) => fareInfo['$'] && fareInfo['$']['Key'] === extractedFareInfoRef
                                                            );
                                                            if (matchingFareInfo) {
                                                              return (
                                                                <div
                                                                  key={fareInfoIndex}
                                                                  className="col-md-3 optionsflights"
                                                                  style={{ display: "flex" }}
                                                                >
                                                                  <div className="optionsflight">
                                                                    <div className="modal-data">
                                                                      {/* Display FareFamily as the Header */}
                                                                      <div className="seelctheader">
                                                                        {matchingFareInfo['$']['FareFamily']}
                                                                        <button
                                                                          type="button"
                                                                          onClick={() => getFareDetails(matchingFareInfo['$']['FareFamily'])}
                                                                          style={{
                                                                            border: "none",
                                                                            background: "none",
                                                                            cursor: "pointer",
                                                                            fontSize: "16px",
                                                                            color: "#785eff",
                                                                          }}
                                                                          aria-label="Toggle Details"
                                                                        >
                                                                          <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                        </button>
                                                                      </div>
                                                                      <div className="selectprice">
                                                                        {(() => {
                                                                          // Use Amount from matchingFareInfo for price
                                                                          const totalAmount = matchingFareInfo['$']['Amount'];
                                                                          const totalTax = matchingTaxInfo['Amount'];
                                                                          {/* console.log('totalamounttttttt', totalAmount.replace("INR", "").trim() + taxesRef.current); */ }
                                                                          {/* console.log('totalamounttttttt', parseFloat(totalAmount.replace("INR", "").trim()) + (taxesRef.current)); */ }

                                                                          const numericTotalPrice = parseFloat(totalAmount.replace("INR", "").trim()) + parseFloat(totalTax.replace("INR", "").trim());

                                                                          const airline = inputOrigin;
                                                                          const calculatedPrice = calculateFinalPrice(
                                                                            numericTotalPrice,
                                                                            markupdata,
                                                                            cabinClass,
                                                                            matchingFareInfo['$']['FareFamily'] // Pass the fare family name
                                                                            , airline, flight_type
                                                                          );

                                                                          return (
                                                                            <>
                                                                              {totalAmount.includes("INR") ? "â‚¹ " : ""}
                                                                              {calculatedPrice}
                                                                            </>
                                                                          );
                                                                        })()}
                                                                      </div>
                                                                    </div>
                                                                  </div>
                                                                  {/* {agent_id  && (  */}

                                                                  <div className='buttonbook' >

                                                                    <button type='button' className="continuebutton"

                                                                      style={{ marginTop: "5px", color: "white", backgroundColor: "#785eff", border: "none", padding: "4px 10px", fontSize: '14px', marginLeft: '7px', marginRight: '5px', borderRadius: "3px" }}
                                                                      onClick={() => handleach(fareInfoRefKey, pricepoint)}
                                                                      >
                                                                      Book Now
                                                                    </button>
                                                                  </div>
                                                                  {/* )}   */}

                                                                  
                                                                </div>
                                                              );
                                                            }
                                                            return null; // Skip if no matching FareInfo
                                                          })
                                                        ) : (
                                                          priceParse && priceParse.map((priceParseData, priceParseindex) => (

                                                            <div key={priceParseindex} className='col-md-3 optionsflights' style={{ display: "flex" }}>
                                                              <div className='optionsflight' >
                                                                {priceParseData['air:AirPricingInfo'] && (
                                                                  Array.isArray(priceParseData['air:AirPricingInfo'])
                                                                    ? (
                                                                      priceParseData['air:AirPricingInfo'][0]['air:FareInfo'] && (
                                                                        Array.isArray(priceParseData['air:AirPricingInfo'][0]['air:FareInfo'])
                                                                          ? (
                                                                            priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['air:Text'] ? (
                                                                              Array.isArray(priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['air:Text'])
                                                                                ? (
                                                                                  <div className="modal-data">
                                                                                    <div className="seelctheader">{priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name']}
                                                                                      <button
                                                                                        type="button"
                                                                                        onClick={() => handleFareInfoClick(priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:FareRuleKey'])}

                                                                                        style={{
                                                                                          border: "none",
                                                                                          background: "none",
                                                                                          cursor: "pointer",
                                                                                          fontSize: "16px",
                                                                                          color: "#785eff",
                                                                                        }}
                                                                                        aria-label="Toggle Details"
                                                                                      >
                                                                                        <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                      </button></div>
                                                                                    <div className="selectprice">
                                                                                      {(() => {
                                                                                        const totalPrice = priceParseData['air:AirPricingInfo'][0].$.TotalPrice;
                                                                                        const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                        const airline = inputOrigin;
                                                                                        const calculatedPrice = calculateFinalPrice(
                                                                                          numericTotalPrice,
                                                                                          markupdata,
                                                                                          cabinClass,
                                                                                          priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                          , airline, flight_type
                                                                                        );

                                                                                        return (
                                                                                          <>
                                                                                            {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                            {calculatedPrice}
                                                                                          </>
                                                                                        );
                                                                                      })()}
                                                                                    </div>

                                                                                  </div>
                                                                                ) : (
                                                                                  <>
                                                                                    <div>
                                                                                      <div className="seelctheader">{priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name']}
                                                                                        <button
                                                                                          type="button"
                                                                                          onClick={() => handleFareInfoClick(priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:FareRuleKey'])}
                                                                                          // onClick={() => toggleDetails(priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name'])}

                                                                                          style={{
                                                                                            border: "none",
                                                                                            background: "none",
                                                                                            cursor: "pointer",
                                                                                            fontSize: "16px",
                                                                                            color: "#785eff",
                                                                                          }}
                                                                                          aria-label="Toggle Details"
                                                                                        >
                                                                                          <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                        </button></div>
                                                                                      <div className="selectprice">
                                                                                        {(() => {
                                                                                          const totalPrice = priceParseData['air:AirPricingInfo'][0].$.TotalPrice;
                                                                                          const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                          const airline = inputOrigin;
                                                                                          const calculatedPrice = calculateFinalPrice(
                                                                                            numericTotalPrice,
                                                                                            markupdata,
                                                                                            cabinClass,
                                                                                            priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                            , airline, flight_type
                                                                                          );

                                                                                          return (
                                                                                            <>
                                                                                              {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                              {calculatedPrice}
                                                                                            </>
                                                                                          );
                                                                                        })()}
                                                                                      </div>

                                                                                    </div>
                                                                                  </>
                                                                                )
                                                                            ) : (
                                                                              <>
                                                                                <div>
                                                                                  <div className="seelctheader">{priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name']}
                                                                                    <button
                                                                                      type="button"
                                                                                      onClick={() => handleFareInfoClick(priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:FareRuleKey'])}
                                                                                      // onClick={() => toggleDetails(priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name'])}

                                                                                      style={{
                                                                                        border: "none",
                                                                                        background: "none",
                                                                                        cursor: "pointer",
                                                                                        fontSize: "16px",
                                                                                        color: "#785eff",
                                                                                      }}
                                                                                      aria-label="Toggle Details"
                                                                                    >
                                                                                      <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                    </button></div>

                                                                                  <div className="selectprice">
                                                                                    {(() => {
                                                                                      const totalPrice = priceParseData['air:AirPricingInfo'][0].$.TotalPrice;
                                                                                      const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                      const airline = inputOrigin;
                                                                                      const calculatedPrice = calculateFinalPrice(
                                                                                        numericTotalPrice,
                                                                                        markupdata,
                                                                                        cabinClass,
                                                                                        priceParseData['air:AirPricingInfo'][0]['air:FareInfo'][0]['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                        , airline, flight_type
                                                                                      );

                                                                                      return (
                                                                                        <>
                                                                                          {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                          {calculatedPrice}
                                                                                        </>
                                                                                      );
                                                                                    })()}
                                                                                  </div>

                                                                                </div>
                                                                              </>
                                                                            )

                                                                          ) : (
                                                                            priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['air:Text'] ? (
                                                                              Array.isArray(priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['air:Text'])
                                                                                ? (
                                                                                  <div>
                                                                                    <div className="seelctheader">{priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name']}
                                                                                      <button
                                                                                        type="button"
                                                                                        onClick={() => handleFareInfoClick(priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:FareRuleKey'])}
                                                                                        // onClick={() => toggleDetails(priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name'])}

                                                                                        style={{
                                                                                          border: "none",
                                                                                          background: "none",
                                                                                          cursor: "pointer",
                                                                                          fontSize: "16px",
                                                                                          color: "#785eff",
                                                                                        }}
                                                                                        aria-label="Toggle Details"
                                                                                      >
                                                                                        <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                      </button></div>

                                                                                    <div className="selectprice">
                                                                                      {(() => {
                                                                                        const totalPrice = priceParseData['air:AirPricingInfo'][0].$.TotalPrice;
                                                                                        const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                        const airline = inputOrigin;
                                                                                        const calculatedPrice = calculateFinalPrice(
                                                                                          numericTotalPrice,
                                                                                          markupdata,
                                                                                          cabinClass,
                                                                                          priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                          , airline, flight_type
                                                                                        );

                                                                                        return (
                                                                                          <>
                                                                                            {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                            {calculatedPrice}
                                                                                          </>
                                                                                        );
                                                                                      })()}
                                                                                    </div>

                                                                                  </div>
                                                                                ) : (
                                                                                  <>
                                                                                    <div>
                                                                                      <div className="seelctheader">{priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name']}
                                                                                        <button
                                                                                          type="button"
                                                                                          onClick={() => handleFareInfoClick(priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:FareRuleKey'])}
                                                                                          // onClick={() => toggleDetails(priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name'])}

                                                                                          style={{
                                                                                            border: "none",
                                                                                            background: "none",
                                                                                            cursor: "pointer",
                                                                                            fontSize: "16px",
                                                                                            color: "#785eff",
                                                                                          }}
                                                                                          aria-label="Toggle Details"
                                                                                        >
                                                                                          <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                        </button></div>

                                                                                      <div className="selectprice">
                                                                                        {(() => {
                                                                                          const totalPrice = priceParseData['air:AirPricingInfo'][0].$.TotalPrice;
                                                                                          const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                          const airline = inputOrigin;
                                                                                          const calculatedPrice = calculateFinalPrice(
                                                                                            numericTotalPrice,
                                                                                            markupdata,
                                                                                            cabinClass,
                                                                                            priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                            , airline, flight_type
                                                                                          );

                                                                                          return (
                                                                                            <>
                                                                                              {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                              {calculatedPrice}
                                                                                            </>
                                                                                          );
                                                                                        })()}
                                                                                      </div>

                                                                                    </div>
                                                                                  </>
                                                                                )
                                                                            ) : (
                                                                              <>
                                                                                <div>
                                                                                  <div className="seelctheader">{priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name']}
                                                                                    <button
                                                                                      type="button"
                                                                                      onClick={() => handleFareInfoClick(priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:FareRuleKey'])}
                                                                                      // onClick={() => toggleDetails(priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name'])}

                                                                                      style={{
                                                                                        border: "none",
                                                                                        background: "none",
                                                                                        cursor: "pointer",
                                                                                        fontSize: "16px",
                                                                                        color: "#785eff",
                                                                                      }}
                                                                                      aria-label="Toggle Details"
                                                                                    >
                                                                                      <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                    </button></div>

                                                                                  <div className="selectprice">
                                                                                    {(() => {
                                                                                      const totalPrice = priceParseData['air:AirPricingInfo'][0].$.TotalPrice;
                                                                                      const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                      const airline = inputOrigin;
                                                                                      const calculatedPrice = calculateFinalPrice(
                                                                                        numericTotalPrice,
                                                                                        markupdata,
                                                                                        cabinClass,
                                                                                        priceParseData['air:AirPricingInfo'][0]['air:FareInfo']['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                        , airline, flight_type
                                                                                      );

                                                                                      return (
                                                                                        <>
                                                                                          {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                          {calculatedPrice}
                                                                                        </>
                                                                                      );
                                                                                    })()}
                                                                                  </div>

                                                                                </div>
                                                                              </>
                                                                            )
                                                                          )

                                                                      )

                                                                    ) : (
                                                                      priceParseData['air:AirPricingInfo']['air:FareInfo'] && (
                                                                        Array.isArray(priceParseData['air:AirPricingInfo']['air:FareInfo'])
                                                                          ? (
                                                                            priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['air:Text'] ? (
                                                                              Array.isArray(priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['air:Text'])
                                                                                ? (
                                                                                  <div>
                                                                                    <div className="seelctheader">{priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name']}
                                                                                      <button
                                                                                        type="button"
                                                                                        onClick={() => handleFareInfoClick(priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:FareRuleKey'])}
                                                                                        // onClick={() => toggleDetails(priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name'])}

                                                                                        style={{
                                                                                          border: "none",
                                                                                          background: "none",
                                                                                          cursor: "pointer",
                                                                                          fontSize: "16px",
                                                                                          color: "#785eff",
                                                                                        }}
                                                                                        aria-label="Toggle Details"
                                                                                      >
                                                                                        <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                      </button></div>
                                                                                    <div className="selectprice">
                                                                                      {(() => {
                                                                                        const totalPrice = priceParseData['air:AirPricingInfo'].$.TotalPrice;
                                                                                        const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                        const airline = inputOrigin;
                                                                                        const calculatedPrice = calculateFinalPrice(
                                                                                          numericTotalPrice,
                                                                                          markupdata,
                                                                                          cabinClass,
                                                                                          priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                          , airline, flight_type
                                                                                        );

                                                                                        return (
                                                                                          <>
                                                                                            {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                            {calculatedPrice}
                                                                                          </>
                                                                                        );
                                                                                      })()}
                                                                                    </div>

                                                                                  </div>
                                                                                ) : (
                                                                                  <>
                                                                                    <div>
                                                                                      <div className="seelctheader">{priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name']}
                                                                                        <button
                                                                                          type="button"
                                                                                          onClick={() => handleFareInfoClick(priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:FareRuleKey'])}
                                                                                          // onClick={() => toggleDetails(priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name'])}

                                                                                          style={{
                                                                                            border: "none",
                                                                                            background: "none",
                                                                                            cursor: "pointer",
                                                                                            fontSize: "16px",
                                                                                            color: "#785eff",
                                                                                          }}
                                                                                          aria-label="Toggle Details"
                                                                                        >
                                                                                          <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                        </button></div>
                                                                                      <div className="selectprice">
                                                                                        {(() => {
                                                                                          const totalPrice = priceParseData['air:AirPricingInfo'].$.TotalPrice;
                                                                                          const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                          const airline = inputOrigin;
                                                                                          const calculatedPrice = calculateFinalPrice(
                                                                                            numericTotalPrice,
                                                                                            markupdata,
                                                                                            cabinClass,
                                                                                            priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                            , airline, flight_type
                                                                                          );

                                                                                          return (
                                                                                            <>
                                                                                              {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                              {calculatedPrice}
                                                                                            </>
                                                                                          );
                                                                                        })()}
                                                                                      </div>

                                                                                    </div>
                                                                                  </>
                                                                                )
                                                                            ) : (
                                                                              <>
                                                                                <div>
                                                                                  <div className="seelctheader">{priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name']}
                                                                                    <button
                                                                                      type="button"
                                                                                      onClick={() => handleFareInfoClick(priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:FareRuleKey'])}
                                                                                      // onClick={() => toggleDetails(priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name'])}

                                                                                      style={{
                                                                                        border: "none",
                                                                                        background: "none",
                                                                                        cursor: "pointer",
                                                                                        fontSize: "16px",
                                                                                        color: "#785eff",
                                                                                      }}
                                                                                      aria-label="Toggle Details"
                                                                                    >
                                                                                      <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                    </button></div>
                                                                                  <div className="selectprice">
                                                                                    {(() => {
                                                                                      const totalPrice = priceParseData['air:AirPricingInfo'].$.TotalPrice;
                                                                                      const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                      const airline = inputOrigin;
                                                                                      const calculatedPrice = calculateFinalPrice(
                                                                                        numericTotalPrice,
                                                                                        markupdata,
                                                                                        cabinClass,
                                                                                        priceParseData['air:AirPricingInfo']['air:FareInfo'][0]['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                        , airline, flight_type
                                                                                      );

                                                                                      return (
                                                                                        <>
                                                                                          {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                          {calculatedPrice}
                                                                                        </>
                                                                                      );
                                                                                    })()}
                                                                                  </div>

                                                                                </div>
                                                                              </>
                                                                            )

                                                                          ) : (

                                                                            priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['air:Text'] &&
                                                                              priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['air:Text'] ? (
                                                                              Array.isArray(priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['air:Text'])

                                                                                ? (
                                                                                  <div>
                                                                                    <div className="seelctheader">{priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name']}
                                                                                      <button
                                                                                        type="button"
                                                                                        onClick={() => handleFareInfoClick(priceParseData['air:AirPricingInfo']['air:FareInfo']['air:FareRuleKey'])}
                                                                                        // onClick={() => toggleDetails(priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name'])}

                                                                                        style={{
                                                                                          border: "none",
                                                                                          background: "none",
                                                                                          cursor: "pointer",
                                                                                          fontSize: "16px",
                                                                                          color: "#785eff",
                                                                                        }}
                                                                                        aria-label="Toggle Details"
                                                                                      >
                                                                                        <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>

                                                                                      </button>
                                                                                    </div>
                                                                                    <div className="selectprice">
                                                                                      {(() => {
                                                                                        const totalPrice = priceParseData['air:AirPricingInfo'].$.TotalPrice;
                                                                                        const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                        const airline = inputOrigin;
                                                                                        const calculatedPrice = calculateFinalPrice(
                                                                                          numericTotalPrice,
                                                                                          markupdata,
                                                                                          cabinClass,
                                                                                          priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                          , airline, flight_type
                                                                                        );

                                                                                        return (
                                                                                          <>
                                                                                            {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                            {calculatedPrice}
                                                                                          </>
                                                                                        );
                                                                                      })()}
                                                                                    </div>



                                                                                  </div>
                                                                                ) : (
                                                                                  <>
                                                                                    <div>
                                                                                      <div className="seelctheader">{priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name']}
                                                                                        <button
                                                                                          type="button"
                                                                                          onClick={() => handleFareInfoClick(priceParseData['air:AirPricingInfo']['air:FareInfo']['air:FareRuleKey'])}
                                                                                          // onClick={() => toggleDetails(priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name'])}

                                                                                          style={{
                                                                                            border: "none",
                                                                                            background: "none",
                                                                                            cursor: "pointer",
                                                                                            fontSize: "16px",
                                                                                            color: "#785eff",
                                                                                          }}
                                                                                          aria-label="Toggle Details"
                                                                                        >
                                                                                          <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                        </button></div>

                                                                                      <div className="selectprice">
                                                                                        {(() => {
                                                                                          const totalPrice = priceParseData['air:AirPricingInfo'].$.TotalPrice;
                                                                                          const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                          const airline = inputOrigin;
                                                                                          const calculatedPrice = calculateFinalPrice(
                                                                                            numericTotalPrice,
                                                                                            markupdata,
                                                                                            cabinClass,
                                                                                            priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                            , airline, flight_type
                                                                                          );

                                                                                          return (
                                                                                            <>
                                                                                              {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                              {calculatedPrice}
                                                                                            </>
                                                                                          );
                                                                                        })()}
                                                                                      </div>

                                                                                    </div>
                                                                                  </>
                                                                                )
                                                                            ) : (
                                                                              <>
                                                                                <div>
                                                                                  <div className="seelctheader">{priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name']}
                                                                                    <button
                                                                                      type="button"
                                                                                      onClick={() => handleFareInfoClick(priceParseData['air:AirPricingInfo']['air:FareInfo']['air:FareRuleKey'])}
                                                                                      // onClick={() => toggleDetails(priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name'])}

                                                                                      style={{
                                                                                        border: "none",
                                                                                        background: "none",
                                                                                        cursor: "pointer",
                                                                                        fontSize: "16px",
                                                                                        color: "#785eff",
                                                                                      }}
                                                                                      aria-label="Toggle Details"
                                                                                    >
                                                                                      <i className="fas fa-info-circle" style={{ color: '#785eff', marginLeft: '5px', fontSize: '12px', cursor: 'pointer' }}></i>
                                                                                    </button></div>
                                                                                  <div className="selectprice">
                                                                                    {(() => {
                                                                                      const totalPrice = priceParseData['air:AirPricingInfo'].$.TotalPrice;
                                                                                      const numericTotalPrice = totalPrice.replace('INR', '').trim(); // Extract numeric part of price
                                                                                      const airline = inputOrigin;
                                                                                      const calculatedPrice = calculateFinalPrice(
                                                                                        numericTotalPrice,
                                                                                        markupdata,
                                                                                        cabinClass,
                                                                                        priceParseData['air:AirPricingInfo']['air:FareInfo']['air:Brand']['$']['Name'] // Pass the fare name (e.g., "ECO VALUE")
                                                                                        , airline, flight_type
                                                                                      );

                                                                                      return (
                                                                                        <>
                                                                                          {totalPrice.includes('INR') ? 'â‚¹ ' : ''}
                                                                                          {calculatedPrice}
                                                                                        </>
                                                                                      );
                                                                                    })()}
                                                                                  </div>

                                                                                </div>
                                                                              </>
                                                                            )
                                                                          )

                                                                      )
                                                                    )
                                                                )}
                                                              </div>

                                                              {/* {agent_id && ( */}
                                                              <div className='buttonbook'>
                                                                <button type='button' className="continuebutton"
                                                                  style={{ marginTop: "5px", color: "white", backgroundColor: "#785eff", border: "none", padding: "4px 10px", fontSize: '14px', marginLeft: '7px', marginRight: '5px', borderRadius: "3px" }}
                                                                  onClick={() => handleselectedContinue(priceParseindex)}>
                                                                  Book Now
                                                                </button>
                                                              </div>
                                                              {/* )} */}
                                                              
                                                              
                                                            </div>

                                                          ))
                                                        ))
                                                      )}
                                                    </div>
                                                  )}
                                                </div>
                                                <div className="flt-i-c">
                                                  <div className="flt-i-padding">

                                                    <button type="submit"
                                                      className="srch-btn" variant="primary" style={{ borderRadius: '18px' }}>
                                                      <span style={{ fontSize: "12px" }}>View Prices</span>
                                                    </button>
                                                    <div className="flight-line-b">
                                                      <b onClick={() => handleFlightDetails(priceindex)}>
                                                        {visibleFlightIndex === priceindex ? "Hide Flight Details" : "Show Flight Details"}
                                                      </b>
                                                    </div>
                                                    {visibleFlightIndex === priceindex && (
                                                      <div className="flight-details">
                                                        {/* Render your flight details here */}
                                                      </div>
                                                    )}
                                                    <div className="clear" />

                                                  </div>
                                                </div>

                                                <div className="clear" />
                                              </div>
                                            </div>
                                          )}

                                        </div>

                                      </form>
                                    </React.Fragment>
                                  )
                                }

                              }

                            })
                          }


                          {!flightsMatched && (
                            <div key="not-found">

                              <div style={{ textAlign: 'center', background: 'white', padding: '10px' }}>
                                <p style={{ fontWeight: '600' }} className='datanotfound'>
                                  No Data is found for applied filter.
                                </p>
                                <p>We couldn't find any flights with all the filters youâ€™ve selected. Try removing some filters</p>
                                <a href="/" className="back-home-btn" style={{ fontWeight: '600', lineHeight: '3.5', backgroundColor: '#785eff', padding: '15px 35px', color: '#fff', textDecoration: 'none', width: '100%', textTransform: 'uppercase', fontFamily: 'raleway', fontSize: '14px' }}>
                                  Back to Home
                                </a>
                              </div>

                            </div>
                          )}

                        </>
                      ) : (
                        <>
                          <div style={{ textAlign: 'center', background: 'white', padding: '10px' }}>
                            {/* <img src="img/taxivaxi/result_not_found/result not found 1 taxivaxi.png" style={{ width: '100%', paddingBottom: '50px' }} /> */}
                            <p style={{ fontWeight: '600' }} className='datanotfound'>This search flights are not available. Please modify your search..</p>
                            <a href="/" className="back-home-btn" style={{ fontWeight: '600', lineHeight: '3.5', backgroundColor: '#785eff', padding: '15px 35px', color: '#fff', textDecoration: 'none', width: '100%', textTransform: 'uppercase', fontFamily: 'raleway', fontSize: '14px' }}>Back to Home</a>
                          </div>
                        </>
                      )}

                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div className="clear" />
          </div>
        </div>
      </div>
      
    </div >

  );
}

export default SearchFlight;                                